<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>simplezhaoçš„åšå®¢</title>
  
  <subtitle>slow is smooth and smooth is fast</subtitle>
  <link href="https://blog.smart-lifestyle.cn/atom.xml" rel="self"/>
  
  <link href="https://blog.smart-lifestyle.cn/"/>
  <updated>2022-05-05T14:53:03.075Z</updated>
  <id>https://blog.smart-lifestyle.cn/</id>
  
  <author>
    <name>simple</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mac m1ä¸‹å®‰è£…kafka for python</title>
    <link href="https://blog.smart-lifestyle.cn/posts/48c4/"/>
    <id>https://blog.smart-lifestyle.cn/posts/48c4/</id>
    <published>2022-05-05T22:44:25.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>å®‰è£…<code>librdkafka</code></p><p>å®‰è£…ä½ç½®åœ¨<code>/opt/homebrew/Cellar/librdkafka/1.8.2/</code>ï¼Œæœ€åçš„æ•°å­—å› ç‰ˆæœ¬è€Œå¼‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install librdkafka</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…<code>confluent_kafka</code></p><p><strong>1.8.2</strong> æ ¹æ®å®é™…ç‰ˆæœ¬è°ƒæ•´ä½ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C_INCLUDE_PATH=/opt/homebrew/Cellar/librdkafka/1.8.2/include LIBRARY_PATH=/opt/homebrew/Cellar/librdkafka/1.8.2/lib pip install confluent_kafka</span><br></pre></td></tr></table></figure></li></ol><p>å‚è€ƒï¼š</p><p>[1] <a href="https://segmentfault.com/a/1190000040867082">mac m1 arm å®‰è£… confluent-kafka æŠ¥é”™è§£å†³æ–¹æ¡ˆ - SegmentFault æ€å¦</a></p><p>[2] <a href="https://github.com/confluentinc/confluent-kafka-python/issues/1025">Install failed in Apple Silicon Â· Issue #1025 Â· confluentinc/confluent-kafka-python (github.com)</a></p>]]></content>
    
    
    <summary type="html">åœ¨Mac m1ç”µè„‘ä¸Šå¦‚ä½•æ­£ç¡®å®‰è£…kafka client for python</summary>
    
    
    
    <category term="kafka" scheme="https://blog.smart-lifestyle.cn/categories/kafka/"/>
    
    
    <category term="kafka" scheme="https://blog.smart-lifestyle.cn/tags/kafka/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨code serverä¸­ä½¿ç”¨docker</title>
    <link href="https://blog.smart-lifestyle.cn/posts/e029/"/>
    <id>https://blog.smart-lifestyle.cn/posts/e029/</id>
    <published>2022-04-27T15:07:42.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä¸Šä¸€ç¯‡éƒ¨ç½²äº†code serverï¼Œ<a href="https://blog.smart-lifestyle.cn/posts/a6e3/">æäº†ä¸€ä¸ªæµè§ˆå™¨ç‰ˆVS Code Server - simplezhaoçš„åšå®¢ (smart-lifestyle.cn)</a></p><p>åœ¨code serveréƒ¨ç½²å®Œä¹‹åï¼Œå®‰è£…dockeræ’ä»¶ï¼Œå´æ— æ³•è¿æ¥dockerï¼Œæ”¹æ€ä¹ˆè§£å†³å‘¢</p></blockquote><p>dockeré»˜è®¤æ˜¯ä»¥rootç”¨æˆ·è¿è¡Œçš„ï¼Œå¦‚æœä½ ä¹Ÿæ˜¯é€šè¿‡rootèº«ä»½ç™»å½•çš„ä¸»æœºï¼Œåº”è¯¥ä¸ä¼šæœ‰è¯¥é—®é¢˜ï¼Œä¸‹é¢ä»‹ç»çš„érootç”¨æˆ·å¦‚ä½•è§£å†³</p><p><strong>ä»¥ä¸‹æ“ä½œå‘½ä»¤éƒ½æ˜¯åœ¨Ubuntuç³»ç»Ÿä¸‹æ‰§è¡Œ</strong></p><h2 id="å®‰è£…dockeræ’ä»¶"><a href="#å®‰è£…dockeræ’ä»¶" class="headerlink" title="å®‰è£…dockeræ’ä»¶"></a>å®‰è£…dockeræ’ä»¶</h2><blockquote><p>ç¬¬ä¸€æ­¥æ˜¯å…ˆå®‰è£…dockerï¼Œ(*ï¿£ï¸¶ï¿£)</p></blockquote><p>é¦–å…ˆä½ å¾—åœ¨code serverä¸­å®‰è£…dockeræ’ä»¶ï¼Œç›´æ¥åœ¨æ’ä»¶ä¸­æœç´¢å³å¯</p><p><img src="https://oss.smart-lifestyle.cn/file/okqw8.png" alt="image-20220427153653431"></p><p>ç‚¹å‡»dockerå›¾æ ‡ï¼Œå„ç§æç¤ºFailed to connect</p><p><img src="https://oss.smart-lifestyle.cn/file/bckgw.png" alt="access failed"></p><h2 id="ä»¥rootlessæ¨¡å¼è¿è¡Œdocker"><a href="#ä»¥rootlessæ¨¡å¼è¿è¡Œdocker" class="headerlink" title="ä»¥rootlessæ¨¡å¼è¿è¡Œdocker"></a>ä»¥rootlessæ¨¡å¼è¿è¡Œdocker</h2><p>åœ¨dockeræ’ä»¶ä¸Šä¹Ÿä»‹ç»äº†ï¼Œå¦‚ä½•åœ¨vscodeä¸­ä½¿ç”¨docker</p><p><img src="https://oss.smart-lifestyle.cn/file/vb0bh.png" alt="image-20220427154201414"></p><p>æ‰“å¼€<a href="https://docs.docker.com/engine/security/rootless/">é“¾æ¥</a>æŒ‰ç…§æ­¥éª¤æ‰§è¡Œ</p><ol><li><p>å®‰è£…<code>uidmap</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install uidmap</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…<code>dbus-user-session</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y dbus-user-session</span><br></pre></td></tr></table></figure></li><li><p>å°†ä¹‹å‰dockeråœæ­¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">disable</span> --now docker.service docker.socket</span><br><span class="line"></span><br><span class="line">sudo rm /var/run/docker.sock</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨å½“å‰non-rootç”¨æˆ·å®‰è£…docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dockerd-rootless-setuptool.sh install</span><br><span class="line"></span><br><span class="line">systemctl --user start docker</span><br></pre></td></tr></table></figure></li><li><p>å¼€æœºå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo loginctl enable-linger $(whoami)</span><br></pre></td></tr></table></figure></li><li><p>å°†docker hoståŠ å…¥åˆ°ç¯å¢ƒå˜é‡ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰ç”¨æˆ·XDG_RUNTIME_DIR</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$XDG_RUNTIME_DIR</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ä¸‹é¢ä¸¤è¡ŒåŠ å…¥åˆ°.bashrcæˆ–è€….zshrcä¸­ï¼Œå…·ä½“çœ‹ç”¨çš„å“ªç§shell</span></span><br><span class="line"><span class="comment"># run/user/1000 ä¸ºecho $XDG_RUNTIME_DIRçš„ç»“æœ</span></span><br><span class="line"><span class="built_in">export</span> PATH=/usr/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> DOCKER_HOST=unix:///run/user/1000/docker.sock</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line"><span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure></li><li><p>è¿è¡Œdocker å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤æ—¶å°±å¯ä»¥è¿è¡Œdocker å‘½ä»¤</span></span><br><span class="line">docker run -d -p 6379:6379 redis:latest</span><br><span class="line"></span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line">CONTAINER ID   IMAGE          COMMAND                  CREATED       STATUS       PORTS                                       NAMES</span><br><span class="line">5e416fb0fa5d   redis:latest   <span class="string">&quot;docker-entrypoint.sâ€¦&quot;</span>   7 hours ago   Up 7 hours   0.0.0.0:6379-&gt;6379/tcp, :::6379-&gt;6379/tcp   gifted_diffie</span><br></pre></td></tr></table></figure></li></ol><h2 id="åœ¨code-serverä¸­ç”Ÿæ•ˆdockeræ“ä½œ"><a href="#åœ¨code-serverä¸­ç”Ÿæ•ˆdockeræ“ä½œ" class="headerlink" title="åœ¨code serverä¸­ç”Ÿæ•ˆdockeræ“ä½œ"></a>åœ¨code serverä¸­ç”Ÿæ•ˆdockeræ“ä½œ</h2><p>å‰é¢ä¸€è·¯å¾ˆé¡ºåˆ©ï¼Œä½†æ˜¯å‘ç°åœ¨code serverä¸­è¿˜æ˜¯ä¸èƒ½ç”¨ğŸ˜“</p><p><img src="https://oss.smart-lifestyle.cn/file/etact.png" alt="image-20220427213459661"></p><p>è€Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„ç¯å¢ƒå˜é‡ä¸­å·²ç»é…ç½®äº†DOCKER_HOST = <code>export DOCKER_HOST=unix:///run/user/1000/docker.sock</code></p><p>ç»è¿‡æµ‹è¯•å‘ç°ï¼Œåœ¨vscode terminalå’Œ è‡ªå·±ç”µè„‘ä¸Šä½¿ç”¨itermé€šè¿‡sshè¿æ¥æœåŠ¡å™¨ä¹‹åçš„ç»“æœç«Ÿç„¶ä¸ä¸€æ ·</p><ul><li>echo  $XDG_RUNTIME_DIR</li></ul><p>â€‹    åœ¨itermä¸Š</p><p><img src="https://oss.smart-lifestyle.cn/file/7h9xk.png" alt="image-20220427213948405"></p><p>â€‹    </p><p>â€‹    åœ¨vscode terminalä¸Š</p><p><img src="https://oss.smart-lifestyle.cn/file/eyur9.png" alt="image-20220427214104155"></p><p><strong>åœ¨vscode terminal <code> $XDG_RUNTIME_DIR</code>ä¸ºç©º</strong>ï¼Œè¿™é‡Œæ²¡æœ‰å†æ·±å…¥å»çœ‹ä»€ä¹ˆåŸå› ï¼Œè€Œæˆ‘å·²åœ¨ä¹‹å‰çš„è®¾ç½®ä¸­å°†<code>$XDG_RUNTIME_DIR</code>æ›¿æ¢ä¸ºå®é™…çš„ç»“æœ<code>run/user/1000</code></p><ul><li>DOCKER_HOSTæ²¡æœ‰ç”Ÿæ•ˆ</li></ul><p>åœ¨vscode dockerçš„ä¸Šä¸‹æ–‡é…ç½®ä¸­ï¼Œæœ‰ä¸¤ä¸ªcontextsï¼Œä¸€ä¸ªdefaultï¼ˆä½¿ç”¨å½“å‰DOCKER_HOSTï¼‰ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯rootless</p><p><img src="https://oss.smart-lifestyle.cn/file/q3thf.png" alt="image-20220427214524692"></p><p>åœ¨code serverä¸­<code>$DOCKER_HOST</code>ä¹Ÿæ˜¯è¿”å›ä¸ºç©º</p><p><img src="https://oss.smart-lifestyle.cn/file/3ehj3.png" alt="image-20220427214721962"></p><p>å› ä¸ºæ²¡æœ‰è¿æ¥åˆ°æ­£ç¡®çš„docker.sockä¸Šï¼Œæ‰€ä»¥ä¸€ç›´å‡ºé”™</p><h3 id="åœ¨code-serverä¸Šåˆ‡æ¢contextsä¸ºrootless"><a href="#åœ¨code-serverä¸Šåˆ‡æ¢contextsä¸ºrootless" class="headerlink" title="åœ¨code serverä¸Šåˆ‡æ¢contextsä¸ºrootless"></a>åœ¨code serverä¸Šåˆ‡æ¢contextsä¸ºrootless</h3><p>åœ¨command paletteä¸­æ‰¾åˆ°<code>Docker Contexts: Use</code></p><p><img src="https://oss.smart-lifestyle.cn/file/4gjvw.png" alt="image-20220427215039799"></p><p>å°†å…¶è°ƒæ•´ä¸ºrootless</p><p><img src="https://oss.smart-lifestyle.cn/file/6hfz0.png" alt="image-20220426220112259"></p><p>ç„¶åå°±å¯ä»¥åœ¨code serverä¸­ä½¿ç”¨docker äº†</p><p><img src="https://oss.smart-lifestyle.cn/file/uqlgn.png" alt="image-20220427215239438"></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>é™¤äº†ä¸Šé¢æåˆ°çš„é—®é¢˜</p><p>$DOCKER_HOSTã€$XDG_RUNTIME_DIRåœ¨ code server terminalä¸­ä¸ºç©º</p><p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼š</p><p>åœ¨code server terminalä¸­ä¸ºç©ºæ— æ³•ä½¿ç”¨<code>systemctl --user restart|start|status  docker.service</code>å‘½ä»¤</p><p><img src="https://oss.smart-lifestyle.cn/file/fz5dv.png" alt="image-20220427215515635"></p><p>è¿™ä¸ªé—®é¢˜åœ¨<a href="https://docs.docker.com/engine/security/rootless/#troubleshooting">troubleshooting</a>ä¸­ä¹Ÿæåˆ°äº†ï¼Œä½†æˆ‘æ²¡å»è§£å†³ï¼Œå¦‚æœé‡å¯å°±åœ¨itermä¸­æ“ä½œ</p><p><img src="https://oss.smart-lifestyle.cn/file/8gpp2.png" alt="image-20220427215701871"></p><p>è¿™ä¸¤ä¸ªé—®é¢˜ç­‰åé¢æœ‰æ—¶é—´å†å»è§£å†³å§</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://docs.docker.com/engine/install/linux-postinstall/">Post-installation steps for Linux | Docker Documentation</a></p><p>[2] <a href="https://github.com/microsoft/vscode-docker/wiki/Troubleshooting">Troubleshooting Â· microsoft/vscode-docker Wiki (github.com)</a></p><p>[3] <a href="https://docs.docker.com/engine/security/rootless/#troubleshooting">Run the Docker daemon as a non-root user (Rootless mode) | Docker Documentation</a></p>]]></content>
    
    
    <summary type="html">é…ç½®dockerè¿è¡Œæ¨¡å¼ä¸ºrootlessï¼Œè¿™æ ·non-rootç”¨æˆ·ä¹Ÿå¯ä»¥è®¿é—®</summary>
    
    
    
    <category term="docker" scheme="https://blog.smart-lifestyle.cn/categories/docker/"/>
    
    
    <category term="docker" scheme="https://blog.smart-lifestyle.cn/tags/docker/"/>
    
    <category term="code server" scheme="https://blog.smart-lifestyle.cn/tags/code-server/"/>
    
  </entry>
  
  <entry>
    <title>æäº†ä¸€ä¸ªæµè§ˆå™¨ç‰ˆVS Code Server</title>
    <link href="https://blog.smart-lifestyle.cn/posts/a6e3/"/>
    <id>https://blog.smart-lifestyle.cn/posts/a6e3/</id>
    <published>2022-04-22T14:54:12.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å·¥ä½œç”¨çš„Macç”µè„‘æ˜¯ARMèŠ¯ç‰‡çš„ï¼Œè€Œç›®å‰éƒ¨ç½²çš„æœåŠ¡å¤§éƒ¨åˆ†è¿˜éƒ½æ˜¯amd64æ¶æ„çš„ï¼Œæ‰‹å¤´ä¸Šæ–°è´­äº†å‡ å°è½»é‡æœåŠ¡å™¨ï¼Œå› æ­¤æäº†ä¸€ä¸ªåœ¨çº¿ç‰ˆçš„vscodeæ¥æ–¹ä¾¿å¼€å‘ï¼Œå®é™…ç”¨è¿‡ä¹‹åç¡®å®æŒºé¦™(*ï¿£ï¸¶ï¿£)</p></blockquote><p><strong>æœ¬æ–¹æ¡ˆæ‰€æœ‰å®ç°éƒ½æ˜¯åœ¨è…¾è®¯äº‘ä¸Šï¼Œå¦‚æœæ˜¯å…¶ä»–äº‘å‚å•†ï¼Œè¯·å‚è€ƒå¯¹æ ‡æœåŠ¡</strong></p><p>ä¸‹é¢ä»‹ç»å¦‚ä½•åœ¨è½»é‡æœåŠ¡å™¨ä¸Šæ­å»ºä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„<a href="https://coder.com/docs/code-server/latest/guide">VS Code Server</a>ï¼Œå…¶å®åªæ˜¯æ•´ç†äº†å®˜æ–¹æ–‡æ¡£</p><h2 id="æ•´ä½“ä»‹ç»"><a href="#æ•´ä½“ä»‹ç»" class="headerlink" title="æ•´ä½“ä»‹ç»"></a>æ•´ä½“ä»‹ç»</h2><p>æœ¬ç€èƒ½çœå°±çœåŒæ—¶å…¼é¡¾å®‰å…¨çš„è§’åº¦ï¼Œéƒ¨ç½²ä½¿ç”¨äº†å¦‚ä¸‹èµ„æºï¼š</p><ul><li><p>è…¾è®¯äº‘æœåŠ¡</p><ul><li><a href="https://cloud.tencent.com/product/lighthouse">è½»é‡åº”ç”¨æœåŠ¡å™¨(Ubuntu 20.04)</a></li><li><a href="https://cloud.tencent.com/document/product/877/18675">å†…ç½‘äº’è”</a></li><li><a href="https://cloud.tencent.com/document/product/1154/39271">å‡½æ•°æœåŠ¡</a></li><li><a href="https://cloud.tencent.com/document/product/628">APIç½‘å…³</a></li><li><a href="https://cloud.tencent.com/document/product/1141/50310">å®¹å™¨é•œåƒæœåŠ¡ï¼ˆä¸ªäººç‰ˆï¼‰</a></li></ul></li><li><p>è½¯ä»¶éƒ¨ç½²</p><ul><li><a href="https://freessl.cn/">httpsè¯ä¹¦</a>ï¼Œæä¾›httpsè®¿é—®</li><li><a href="https://nginx.org/en/">Nginx</a>ï¼Œå¯¹Code Serverè¿›è¡Œåå‘ä»£ç†</li><li><a href="https://github.com/coder/code-server">Code Server</a>ï¼Œ åœ¨çº¿ç‰ˆVS Code</li><li><a href="https://oauth2-proxy.github.io/oauth2-proxy/">OAuth Proxy</a>ï¼Œæä¾›github OAuthè®¤è¯</li></ul></li></ul><p>æ•´ä½“æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤º</p><ol><li>å°†code serveréƒ¨ç½²åœ¨è½»é‡æœåŠ¡å™¨ä¸­ï¼Œä½¿ç”¨nginxåšåå‘ä»£ç†ï¼Œå¹¶å¯ç”¨httpsåŠ å¯†è®¿é—®</li><li>åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²OAuth Proxyï¼Œå¹¶é€šè¿‡APIç½‘å…³å¯¹å†…ç½‘å¼€æ”¾authorizationæ¥å£</li><li>è½»é‡æœåŠ¡å™¨å’Œäº‘å‡½æ•°åœ¨ä¸åŒçš„VPCå†…ï¼Œä¸ºäº†å®ç°å†…ç½‘è®¿é—®ï¼Œé€šè¿‡äº‘è”ç½‘æ‰“é€šä¸¤ä¸ªVPC</li><li>æœ€ç»ˆç”¨æˆ·åœ¨æµè§ˆå™¨é‡Œè¾“å…¥urlï¼Œç„¶åé€šè¿‡githubè®¤è¯ç™»å½•åˆ°Code Serverä¸Š</li></ol><p><img src="https://oss.smart-lifestyle.cn/file/4uyym.png" alt="codeserveræ¶æ„"></p><p>æœ€ç»ˆæ•ˆæœï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®ï¼Œè·Ÿæœ¬åœ°VS Codeå‡ ä¹æ²¡æœ‰ä»»ä½•åŒºåˆ«</p><p><img src="https://oss.smart-lifestyle.cn/file/18nzr.png" alt="image-20220422214335880"></p><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><p>ä¸‹é¢åˆ†æ­¥éª¤ä»‹ç»å®Œæ•´çš„éƒ¨ç½²è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ä¸‹é¢çš„æ­¥éª¤</p><ol><li>åœ¨è½»é‡æœåŠ¡å™¨ä¸­éƒ¨ç½²Code Serverå’ŒNginx</li><li>åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²OAuth2 Proxyï¼Œå¹¶åœ¨APIç½‘å…³ä¸­é…ç½®è§¦å‘å™¨</li><li>é…ç½®äº‘è”ç½‘ï¼Œæ‰“é€šVPC</li><li>è°ƒè¯•</li></ol><h3 id="åœ¨è½»é‡æœåŠ¡å™¨ä¸­éƒ¨ç½²Code-Serverå’ŒNginx"><a href="#åœ¨è½»é‡æœåŠ¡å™¨ä¸­éƒ¨ç½²Code-Serverå’ŒNginx" class="headerlink" title="åœ¨è½»é‡æœåŠ¡å™¨ä¸­éƒ¨ç½²Code Serverå’ŒNginx"></a>åœ¨è½»é‡æœåŠ¡å™¨ä¸­éƒ¨ç½²Code Serverå’ŒNginx</h3><h4 id="éƒ¨ç½²Code-Server"><a href="#éƒ¨ç½²Code-Server" class="headerlink" title="éƒ¨ç½²Code Server"></a>éƒ¨ç½²Code Server</h4><p>å‚è€ƒå®˜æ–¹é€šè¿‡å‘½ä»¤è„šæœ¬çš„å®‰è£…æ–¹å¼ï¼Œ<a href="https://coder.com/docs/code-server/latest/install#installsh">Install - code-server v4.3.0 docs (coder.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://code-server.dev/install.sh | sh</span><br></pre></td></tr></table></figure><blockquote><h3 id="Detection-reference"><a href="#Detection-reference" class="headerlink" title="Detection reference"></a>Detection reference</h3><ul><li>For Debian and Ubuntu, code-server will install the latest deb package.(å¦‚æœæ˜¯Ubuntuç³»ç»Ÿï¼Œcode serverä¼šä½¿ç”¨æœ€æ–°çš„debåŒ…å®‰è£…)</li><li>For Fedora, CentOS, RHEL and openSUSE, code-server will install the latest RPM package.</li></ul></blockquote><p>å®‰è£…å®Œæˆåï¼Œcode serverçš„é…ç½®æ–‡ä»¶åœ¨<code>$HOME/.config/code-server/config.yaml</code>ï¼Œè€Œæ’ä»¶ç­‰éƒ½ä¼šå®‰è£…åˆ°<code>$HOME/.local/share/code-server</code>ä¸­</p><p>å› ä¸ºåé¢ä½¿ç”¨OAuth2 Proxyæ¥åšè®¤è¯ï¼Œæ‰€ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­å°†authæ”¹ä¸ºNoneï¼Œå¹¶ä¸”ä¿®æ”¹code serveré»˜è®¤ç«¯å£ï¼Œä¸”åªèƒ½æœ¬æœºè®¿é—®ï¼ˆåé¢ä¼šä½¿ç”¨nginxä»£ç†è½¬å‘ï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bind-addr:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:32000</span></span><br><span class="line"><span class="attr">auth:</span> <span class="string">none</span></span><br><span class="line"><span class="attr">cert:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨code serverï¼Œå¹¶è®¾ä¸ºå¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> --now code-server@<span class="variable">$USER</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="éƒ¨ç½²Nginx"><a href="#éƒ¨ç½²Nginx" class="headerlink" title="éƒ¨ç½²Nginx"></a>éƒ¨ç½²Nginx</h4><p>ä½¿ç”¨apt-getç›´æ¥å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nginx</span><br></pre></td></tr></table></figure><h5 id="å¢åŠ httpsé…ç½®æ–‡ä»¶"><a href="#å¢åŠ httpsé…ç½®æ–‡ä»¶" class="headerlink" title="å¢åŠ httpsé…ç½®æ–‡ä»¶"></a>å¢åŠ httpsé…ç½®æ–‡ä»¶</h5><p>æ­¤å¤„å‚è€ƒï¼š<a href="https://coder.com/docs/code-server/latest/guide#using-lets-encrypt-with-nginx">Usage - code-server v4.3.0 docs (coder.com)</a></p><p>æ–°å¢<code> /etc/nginx/sites-available/code-server.https.conf</code>æ–‡ä»¶</p><p>ä½¿ç”¨nginxåå‘ä»£ç†code serverï¼Œæ­¤å¤„ä¸æ˜¯æœ€ç»ˆå®Œæ•´é…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl http2 default_server;</span><br><span class="line">    listen [::]:443;</span><br><span class="line">    server_name code.smart-lifestyle.cn;</span><br><span class="line">    ssl_certificate /etc/nginx/ssl/full_chain.pem;</span><br><span class="line">    ssl_certificate_key /etc/nginx/ssl/private.key;</span><br><span class="line">    ssl_session_cache shared:SSL:1m;</span><br><span class="line">    ssl_session_timeout 10m;</span><br><span class="line">    ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:32000/;</span><br><span class="line">      proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">      proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">      proxy_set_header Connection upgrade;</span><br><span class="line">      proxy_set_header Accept-Encoding gzip;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ</p><ul><li><p>ssl_certificate /etc/nginx/ssl/full_chain.pem;</p></li><li><p>ssl_certificate_key /etc/nginx/ssl/private.key;</p></li></ul><p>åˆ†åˆ«ä¸ºç½‘ç«™çš„å…¬é’¥å’Œç§é’¥ï¼Œå¯ä»¥åœ¨<a href="https://freessl.cn/">FreeSSLé¦–é¡µ - FreeSSL.cnä¸€ä¸ªæä¾›å…è´¹HTTPSè¯ä¹¦ç”³è¯·çš„ç½‘ç«™</a>ç”³è¯·</p><p>ç„¶åæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤å¤„æ‰æ˜¯åŠ code-serveré…ç½®åŠ å…¥åˆ°nginxé…ç½®ä¸­</span></span><br><span class="line">sudo ln -s /etc/nginx/sites-available/code-server.https.conf /etc/nginx/sites-enabled/code-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo nginx -s reload</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥é€šè¿‡https://ä½ çš„åŸŸåï¼Œæ¥è®¿é—®code serverï¼Œä½†æ˜¯å› ä¸ºæ˜¯ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸­ï¼Œéœ€è¦å¢åŠ è®¤è¯æ‰‹æ®µï¼Œæ¥é¿å…å…¶ä»–äººå¯ä»¥ç›´æ¥è®¿é—®</p><h3 id="åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²OAuth2-Proxyï¼Œå¹¶åœ¨APIç½‘å…³ä¸­é…ç½®è§¦å‘å™¨"><a href="#åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²OAuth2-Proxyï¼Œå¹¶åœ¨APIç½‘å…³ä¸­é…ç½®è§¦å‘å™¨" class="headerlink" title="åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²OAuth2 Proxyï¼Œå¹¶åœ¨APIç½‘å…³ä¸­é…ç½®è§¦å‘å™¨"></a>åœ¨äº‘å‡½æ•°ä¸­éƒ¨ç½²OAuth2 Proxyï¼Œå¹¶åœ¨APIç½‘å…³ä¸­é…ç½®è§¦å‘å™¨</h3><h4 id="éƒ¨ç½²OAuth2-Proxy"><a href="#éƒ¨ç½²OAuth2-Proxy" class="headerlink" title="éƒ¨ç½²OAuth2 Proxy"></a>éƒ¨ç½²OAuth2 Proxy</h4><p>OAuth2 Proxyæä¾›äº†å¤šç§OAuth2æºï¼Œè¿™é‡Œæˆ‘é€‰æ‹©äº†GitHubï¼ŒOAuth2 Proxyä½¿ç”¨go è¯­è¨€å¼€å‘ï¼Œè™½ç„¶äº‘å‡½æ•°æä¾›äº†goè¯­è¨€çš„æ”¯æŒï¼Œå°†OAuth2 Proxyæœ€ç»ˆéƒ¨ç½²åº”è¯¥è¿˜æ˜¯éœ€è¦ä¸€ç‚¹ç‚¹é€‚é…å·¥ä½œ</p><p><img src="https://oss.smart-lifestyle.cn/file/kaawc.png" alt="image-20220423142804041"></p><p>äº‘å‡½æ•°æ”¯æŒä»¥å®¹å™¨é•œåƒçš„å½¢å¼éƒ¨ç½²æœåŠ¡ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ‹‰å»OAuth2 Proxyçš„é•œåƒæ¥éƒ¨ç½²ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œäº‘å‡½æ•°é»˜è®¤ç›‘å¬ç«¯å£ä¸º9000ï¼Œä¸”ä¸èƒ½ä¿®æ”¹ï¼Œå› æ­¤éœ€è¦å°†OAuth2 Proxyçš„ç›‘å¬ç«¯å£ä¹Ÿè°ƒæ•´ä¸º9000</p><p><img src="https://oss.smart-lifestyle.cn/file/hkzvv.png" alt="image-20220423145027200"></p><h5 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h5><p>å¦‚æœä½¿ç”¨å®¹å™¨é•œåƒéƒ¨ç½²äº‘å‡½æ•°ï¼Œé•œåƒæ¥æºåªèƒ½é€‰æ‹©è…¾è®¯äº‘ä¸ªäººç‰ˆæˆ–è€…ä¼ä¸šç‰ˆçš„é•œåƒæœåŠ¡ï¼Œå› æ­¤éœ€è¦å°†OAuth2 Proxyçš„é•œåƒå…ˆæ‹‰åˆ°æœ¬åœ°ï¼Œç„¶åæ¨é€åˆ°è…¾è®¯äº‘çš„é•œåƒæœåŠ¡ä¸­ï¼ˆä¸ªäººç‰ˆå…è´¹ï¼‰</p><ol><li><p>ä»OAuth2 Proxy<a href="https://quay.io/repository/oauth2-proxy/oauth2-proxy?tab=tags&tag=latest">å®˜æ–¹é•œåƒä»“åº“</a>æ‹‰å»é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull quay.io/oauth2-proxy/oauth2-proxy:latest</span><br></pre></td></tr></table></figure></li><li><p>åœ¨æœ¬åœ°æ‰“ä¸Štagï¼Œtagåä¸ºåœ¨è…¾è®¯äº‘é•œåƒæœåŠ¡åˆ›å»ºçš„é•œåƒçš„é•œåƒåœ°å€ï¼Œç„¶åä¸Šä¼ é•œåƒï¼Œå…·ä½“å¦‚ä½•ä½¿ç”¨è…¾è®¯äº‘é•œåƒæœåŠ¡ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://cloud.tencent.com/document/product/1141/50310">å®¹å™¨é•œåƒæœåŠ¡ ä¸ªäººç‰ˆæ“ä½œæŒ‡å— - æ“ä½œæŒ‡å— - æ–‡æ¡£ä¸­å¿ƒ - è…¾è®¯äº‘ (tencent.com)</a></p></li><li><p>åœ¨githubä¸Šåˆ›å»ºä¸€ä¸ªapplication</p><p>åœ¨github Developer settingsä¸­æ–°å»ºä¸€ä¸ªOAuth APP</p><p><img src="https://oss.smart-lifestyle.cn/file/wme6e.png" alt="image-20220423204710201"></p><p>å›è°ƒåœ°å€ä¿®æ”¹ä¸ºä½ å®é™…çš„å›è°ƒåœ°å€ï¼š<a href="https://your-code-server-domain/oauth2/callback">https://your-code-server-domain/oauth2/callback</a></p><p>/oauth2/callback éœ€è¦åœ¨ä¹‹å‰çš„nginxé…ç½®ä¸­å¢åŠ ä¸€æ¡ä»£ç†è®°å½•ï¼Œåé¢ä¼šä»‹ç»</p><p><img src="https://oss.smart-lifestyle.cn/file/mwadc.png" alt="image-20220423204935842"></p><p>åˆ›å»ºå®Œåº”ç”¨åï¼Œè®°å½•ä½ çš„Client IDã€Client Secretåé¢ä¼šä½¿ç”¨</p></li><li><p>äº‘å‡½æ•°åˆ›å»ºä¸€ä¸ªå‡½æ•°æœåŠ¡</p><ul><li>é€‰æ‹©ä½¿ç”¨å®¹å™¨é•œåƒ</li><li>åŸºç¡€é…ç½®é€‰æ‹©Webå‡½æ•°</li><li>å‡½æ•°ä»£ç é€‰æ‹©ä¸Šä¸€æ­¥é€‰æ‹©çš„é•œåƒ</li></ul><p><img src="https://oss.smart-lifestyle.cn/file/swtfp.png" alt="image-20220423202037576"></p><p>åœ¨é«˜çº§é…ç½®ä¸­ï¼Œå¢åŠ ç¯å¢ƒå˜é‡ï¼Œæ¥é…ç½®github è®¤è¯ï¼Œéœ€è¦é…ç½®çš„å­—æ®µæœ‰ï¼š</p><ul><li><p>OAUTH2_PROXY_CLIENT_ID=<Your github app client id></p></li><li><p>OAUTH2_PROXY_CLIENT_SECRET=<Your github app client secret></p></li><li><p>OAUTH2_PROXY_COOKIE_SECRET=&lt;éšæœºç”Ÿæˆ&gt;</p></li><li><p>OAUTH2_PROXY_EMAIL_DOMAINS=*</p></li><li><p>OAUTH2_PROXY_GITHUB_USERS=<your github name> ä¿è¯è®¤è¯ååªæœ‰ä½ å¯ä»¥è®¿é—®</p></li><li><p>OAUTH2_PROXY_HTTP_ADDRESS=0.0.0.0:9000 # è¿™é‡Œæ˜¯ä¿®æ”¹OAuth2 Proxyç›‘å¬åœ°å€ï¼Œéœ€è¦æ”¹ä¸º9000</p></li><li><p>OAUTH2_PROXY_PROVIDER=github</p></li><li><p>OAUTH2_PROXY_REDIRECT_URL=<your redirect url in app settings></p></li></ul><p>è¯¦ç»†é…ç½®è¯·å‚è€ƒå®˜æ–¹ï¼š<a href="https://oauth2-proxy.github.io/oauth2-proxy/docs/configuration/oauth_provider#github-auth-provider">OAuth Provider Configuration | OAuth2 Proxy (oauth2-proxy.github.io)</a></p><p>ä¸‹æ–‡ä»‹ç»ï¼Œåœ¨ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®OAuth2 Proxyæ—¶ï¼Œåœ¨æ–‡æ¡£çš„é…ç½®å­—æ®µå‰åŠ ä¸ŠOAUTH2_PROXYï¼ŒåŒæ—¶è¿å­—ç¬¦(-)æ”¹ä¸ºä¸‹åˆ’çº¿ï¼ˆ_)</p><p><img src="https://oss.smart-lifestyle.cn/file/ldqul.png" alt="image-20220423210548845"></p><p><img src="https://oss.smart-lifestyle.cn/file/ywaip.png" alt="image-20220423205906590"></p><p>è§¦å‘å™¨å…ˆé€‰æ‹©é»˜è®¤ï¼Œåé¢éœ€è¦åˆ é™¤é‡æ–°å»ºï¼Œé»˜è®¤ç”Ÿæˆçš„APIç½‘å…³è§¦å‘é…ç½®ï¼Œæ”¯æŒå…¬ç½‘è®¿é—®ï¼Œè€Œæˆ‘åªæƒ³è®©è¿™ä¸ªæœåŠ¡åªèƒ½å†…ç½‘è®¿é—®ï¼Œæ—¢ä¿è¯å®‰å…¨ï¼Œ<strong>æœ‰é¿å…å…¬ç½‘èµ„æºçš„æµªè´¹</strong></p><p>ç†Ÿæ‚‰è…¾è®¯äº‘APIç½‘å…³çš„è¯ï¼Œå¯ä»¥å…ˆåœ¨APIç½‘å…³åˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œç„¶åå†æ­¤å¤„é€‰æ‹©è‡ªå®šä¹‰è§¦å‘å™¨</p><p><img src="https://oss.smart-lifestyle.cn/file/cjgr1.png" alt="image-20220423202303118"></p><p><img src="https://oss.smart-lifestyle.cn/file/y49cb.png" alt="image-20220423203119102"></p></li></ol><h4 id="éƒ¨ç½²å†…ç½‘APIæœåŠ¡"><a href="#éƒ¨ç½²å†…ç½‘APIæœåŠ¡" class="headerlink" title="éƒ¨ç½²å†…ç½‘APIæœåŠ¡"></a>éƒ¨ç½²å†…ç½‘APIæœåŠ¡</h4><ol><li>ä¸ºäº‘å‡½æ•°åˆ›å»ºä¸€ä¸ªå†…ç½‘è®¿é—®çš„APIç½‘å…³è§¦å‘å™¨</li></ol><p>åœ¨APIç½‘å…³ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªAPIç½‘å…³æœåŠ¡</p><p><img src="https://oss.smart-lifestyle.cn/file/2x3rd.png" alt="image-20220423203527650"></p><ul><li>è®¿é—®æ–¹å¼é€‰æ‹©å†…ç½‘VPC</li><li>æ‰€å±VPCé€‰æ‹©è·ŸOAuth2 ProxyæœåŠ¡åŒä¸€ä¸ªVPC</li></ul><p><img src="https://oss.smart-lifestyle.cn/file/i84hp.png" alt="image-20220423203658410"></p><ol start="2"><li><p>åœ¨äº‘å‡½æ•°ä¸­ï¼Œé‡æ–°é…ç½®è§¦å‘å™¨</p><p>åˆ é™¤ä¹‹å‰çš„è§¦å‘å™¨ï¼Œæ–°å»ºè§¦å‘å™¨</p><p><img src="https://oss.smart-lifestyle.cn/file/399ju.png" alt="image-20220322230121860"></p><p>é€‰æ‹©è‡ªå®šä¹‰è§¦å‘å™¨ï¼Œå¹¶é€‰æ‹©ä¹‹å‰åˆ›å»ºçš„APIç½‘å…³æœåŠ¡</p><p><img src="https://oss.smart-lifestyle.cn/file/t0m13.png" alt="image-20220322230157775"></p><p>é…ç½®å®Œä¹‹åï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å†…ç½‘è®¿é—®è·¯å¾„ï¼Œåœ¨æ²¡æœ‰é…ç½®äº‘è”ç½‘ä¹‹å‰ï¼Œè½»é‡æœåŠ¡å™¨æ˜¯æ— æ³•è®¿é—®åˆ°è¿™ä¸ªäº‘å‡½æ•°æœåŠ¡</p><p><img src="https://oss.smart-lifestyle.cn/file/opgzl.png" alt="image-20220423213305703"></p></li></ol><h3 id="é…ç½®äº‘è”ç½‘æ‰“é€šVPC"><a href="#é…ç½®äº‘è”ç½‘æ‰“é€šVPC" class="headerlink" title="é…ç½®äº‘è”ç½‘æ‰“é€šVPC"></a>é…ç½®äº‘è”ç½‘æ‰“é€šVPC</h3><p>åœ¨è½»é‡æœåŠ¡å™¨çš„ç®¡ç†ç•Œé¢â€“å†…ç½‘äº’è”ä¸­ï¼Œé€‰æ‹©æœåŠ¡å™¨æ‰€åœ¨çš„åŒºåŸŸï¼Œæ–°å»ºä¸ªå†…ç½‘äº’è”</p><p><img src="https://oss.smart-lifestyle.cn/file/2h5s8.png" alt="image-20220423212226912"></p><p>åœ¨å†…ç½‘äº’è”é…ç½®ä¸­ï¼Œå°†è½»é‡æœåŠ¡å™¨VPCå’Œäº‘å‡½æ•°æ‰€åœ¨VPCå…³è”è¿›å»</p><p><img src="https://oss.smart-lifestyle.cn/file/04jmq.png" alt="image-20220423212342714"></p><p>ç”±äºæˆ‘çš„è½»é‡æœåŠ¡å™¨å’Œäº‘å‡½æ•°éƒ½åœ¨åŒ—äº¬åŒºåŸŸï¼Œå› æ­¤ä¸¤ä¸ªVPCä¹‹é—´æ˜¯å†…ç½‘è®¿é—®ï¼Œå› æ­¤äº’ç›¸è®¿é—®æ˜¯å…è´¹çš„</p><p><img src="https://oss.smart-lifestyle.cn/file/8awk2.png" alt="image-20220423213011059"></p><p>ç™»å½•è½»é‡æœåŠ¡å™¨ï¼Œè®¿é—®OAuth2 Proxy urlï¼Œå¦‚æœèƒ½è¿”å›htmlé¡µé¢è¡¨æ˜ï¼ŒæœåŠ¡æˆåŠŸè¿è¡Œï¼Œä¸”å¯ä»¥å†…ç½‘è®¿é—®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://service-oll9qkj1-1258647687-in.bj.apigw.tencentcs.com:9003/release/</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/2xoco.png" alt="image-20220423213458827"></p><h3 id="é…ç½®nginxï¼Œå¢åŠ authè®¤è¯"><a href="#é…ç½®nginxï¼Œå¢åŠ authè®¤è¯" class="headerlink" title="é…ç½®nginxï¼Œå¢åŠ authè®¤è¯"></a>é…ç½®nginxï¼Œå¢åŠ authè®¤è¯</h3><p>æœ€åæˆ‘ä»¬åœ¨é‡æ–°ä¿®æ”¹code-server.https.confï¼Œæ–°å¢authéƒ¨åˆ†åŠŸèƒ½ï¼Œå®˜æ–¹å‚è€ƒï¼š<a href="https://oauth2-proxy.github.io/oauth2-proxy/docs/configuration/overview/#configuring-for-use-with-the-nginx-auth_request-directive">Configuring for use with the Nginx <code>auth_request</code> directive</a></p><p>å®Œæ•´code-server.https.confæ–‡ä»¶ä»£ç å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl http2 default_server;</span><br><span class="line">    listen [::]:443;</span><br><span class="line">    server_name _;</span><br><span class="line">    ssl_certificate /etc/nginx/ssl/full_chain.pem;</span><br><span class="line">    ssl_certificate_key /etc/nginx/ssl/private.key;</span><br><span class="line">    ssl_session_cache shared:SSL:1m;</span><br><span class="line">    ssl_session_timeout 10m;</span><br><span class="line">    ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line"></span><br><span class="line">    location /oauth2/ &#123;</span><br><span class="line">      proxy_pass       http://service-oll9qkj1-1258647687-in.bj.apigw.tencentcs.com:8003;</span><br><span class="line">      proxy_set_header Host                    <span class="variable">$proxy_host</span>;</span><br><span class="line">      proxy_set_header X-Real-IP               <span class="variable">$remote_addr</span>;</span><br><span class="line">      proxy_set_header X-Scheme                <span class="variable">$scheme</span>;</span><br><span class="line">      proxy_set_header X-Auth-Request-Redirect <span class="variable">$request_uri</span>;</span><br><span class="line">      <span class="comment"># or, if you are handling multiple domains:</span></span><br><span class="line">      <span class="comment"># proxy_set_header X-Auth-Request-Redirect $scheme://$host$request_uri;</span></span><br><span class="line">    &#125;</span><br><span class="line">    location = /oauth2/auth &#123;</span><br><span class="line">      proxy_pass       http://service-oll9qkj1-1258647687-in.bj.apigw.tencentcs.com:8003;</span><br><span class="line">      proxy_set_header Host             <span class="variable">$proxy_host</span>;</span><br><span class="line">      proxy_set_header X-Real-IP        <span class="variable">$remote_addr</span>;</span><br><span class="line">      proxy_set_header X-Scheme         <span class="variable">$scheme</span>;</span><br><span class="line">      <span class="comment"># nginx auth_request includes headers but not body</span></span><br><span class="line">      proxy_set_header Content-Length   <span class="string">&quot;&quot;</span>;</span><br><span class="line">     proxy_pass_request_body           off;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">     auth_request /oauth2/auth;</span><br><span class="line">    error_page 401 = /oauth2/sign_in;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass information via X-User and X-Email headers to backend,</span></span><br><span class="line">    <span class="comment"># requires running with --set-xauthrequest flag</span></span><br><span class="line">    auth_request_set <span class="variable">$user</span>   <span class="variable">$upstream_http_x_auth_request_user</span>;</span><br><span class="line">    auth_request_set <span class="variable">$email</span>  <span class="variable">$upstream_http_x_auth_request_email</span>;</span><br><span class="line">    proxy_set_header X-User  <span class="variable">$user</span>;</span><br><span class="line">    proxy_set_header X-Email <span class="variable">$email</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># if you enabled --pass-access-token, this will pass the token to the backend</span></span><br><span class="line">    auth_request_set <span class="variable">$token</span>  <span class="variable">$upstream_http_x_auth_request_access_token</span>;</span><br><span class="line">    proxy_set_header X-Access-Token <span class="variable">$token</span>;</span><br><span class="line">      <span class="comment"># if you enabled --cookie-refresh, this is needed for it to work with auth_request</span></span><br><span class="line">    auth_request_set <span class="variable">$auth_cookie</span> <span class="variable">$upstream_http_set_cookie</span>;</span><br><span class="line">    add_header Set-Cookie <span class="variable">$auth_cookie</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># When using the --set-authorization-header flag, some provider&#x27;s cookies can exceed the 4kb</span></span><br><span class="line">    <span class="comment"># limit and so the OAuth2 Proxy splits these into multiple parts.</span></span><br><span class="line">    <span class="comment"># Nginx normally only copies the first `Set-Cookie` header from the auth_request to the response,</span></span><br><span class="line">    <span class="comment"># so if your cookies are larger than 4kb, you will need to extract additional cookies manually.</span></span><br><span class="line">    auth_request_set <span class="variable">$auth_cookie_name_upstream_1</span> <span class="variable">$upstream_cookie_auth_cookie_name_1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Extract the Cookie attributes from the first Set-Cookie header and append them</span></span><br><span class="line">    <span class="comment"># to the second part ($upstream_cookie_* variables only contain the raw cookie content)</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$auth_cookie</span> ~* <span class="string">&quot;(; .*)&quot;</span>) &#123;</span><br><span class="line">            <span class="built_in">set</span> <span class="variable">$auth_cookie_name_0</span> <span class="variable">$auth_cookie</span>;</span><br><span class="line">            <span class="built_in">set</span> <span class="variable">$auth_cookie_name_1</span> <span class="string">&quot;auth_cookie_name_1=$auth_cookie_name_upstream_1<span class="variable">$1</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Send both Set-Cookie headers now if there was a second part</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$auth_cookie_name_upstream_1</span>) &#123;</span><br><span class="line">        add_header Set-Cookie <span class="variable">$auth_cookie_name_0</span>;</span><br><span class="line">        add_header Set-Cookie <span class="variable">$auth_cookie_name_1</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://127.0.0.1:32000/;</span><br><span class="line">      proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">      proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">      proxy_set_header Connection upgrade;</span><br><span class="line">      proxy_set_header Accept-Encoding gzip;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆä¹‹åï¼Œé‡å¯nginx</p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://oss.smart-lifestyle.cn/file/uv1hl.png" alt="image-20220423215409071"></p><p><img src="https://oss.smart-lifestyle.cn/file/utszp.png" alt="image-20220423215456692"></p><p><img src="https://oss.smart-lifestyle.cn/file/a6nh5.png" alt="image-20220423215521287"></p><p><img src="https://oss.smart-lifestyle.cn/file/der2y.png" alt="image-20220423215614112"></p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>éšç€è‡ªå·±é€æ¸å‘äº‘åŸç”Ÿæ–¹å‘å‘å±•ï¼Œè…¾è®¯äº‘åœ¨è¿™æ–¹é¢åšçš„è¿˜æ˜¯ä¸é”™ç›®å‰æ­£åœ¨å……åˆ†çš„æ’¸å‚å•†çš„å„ç§å…è´¹äº‘äº§å“ï¼Œè€Œä¸æ˜¯åƒä»¥å‰åªæ’¸è™šæœºï¼Œç„¶åæ­å»ºå„ç§æœåŠ¡</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://docs.github.com/cn/developers/apps/managing-oauth-apps/troubleshooting-authorization-request-errors">æ’æŸ¥æˆæƒè¯·æ±‚é”™è¯¯ - GitHub Docs</a></p><p>[2] <a href="https://oauth2-proxy.github.io/oauth2-proxy/docs/configuration/overview/#environment-variables">Overview | OAuth2 Proxy (oauth2-proxy.github.io)</a></p><p>[3] <a href="https://coder.com/docs/code-server/latest/guide">Usage - code-server v4.3.0 docs (coder.com)</a></p><p>[4] <a href="https://oauth2-proxy.github.io/oauth2-proxy/docs/configuration/overview/#configuring-for-use-with-the-nginx-auth_request-directive">Overview | OAuth2 Proxy (oauth2-proxy.github.io)</a></p>]]></content>
    
    
    <summary type="html">åœ¨è…¾è®¯è½»é‡æœåŠ¡å™¨ä¸Šæ­å»ºvscodeåœ¨çº¿ç‰ˆcode serverï¼Œå¹¶ä½¿ç”¨githubè´¦å·æˆæƒè®¿é—®</summary>
    
    
    
    <category term="å·¥å…·" scheme="https://blog.smart-lifestyle.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="code server" scheme="https://blog.smart-lifestyle.cn/tags/code-server/"/>
    
    <category term="oauth" scheme="https://blog.smart-lifestyle.cn/tags/oauth/"/>
    
  </entry>
  
  <entry>
    <title>linuxä¸‹é…ç½®v2rayå®¢æˆ·ç«¯</title>
    <link href="https://blog.smart-lifestyle.cn/posts/73e5/"/>
    <id>https://blog.smart-lifestyle.cn/posts/73e5/</id>
    <published>2022-04-19T09:37:48.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è…¾è®¯äº‘æœåŠ¡å™¨è®¿é—®githubå‡ºå¥‡çš„æ…¢ï¼Œå› æ­¤æ­ä¸ªæ¢¯å­æ¥åŠ é€Ÿè®¿é—®github</p></blockquote><p><strong>æœ¬ç¯‡æ˜¯å®¢æˆ·ç«¯æ•™ç¨‹ï¼Œä¸æ˜¯æœåŠ¡ç«¯æ•™ç¨‹</strong></p><p><strong>æœåŠ¡å™¨ç³»ç»Ÿï¼šUbuntu 20.4</strong></p><p>è®¿é—®<a href="https://github.com/v2fly/v2ray-core/releases">å®˜ç½‘ä¸‹è½½é¡µé¢</a>ï¼Œé€‰æ‹©é€‚é…ç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼Œæˆ‘çš„ç³»ç»Ÿæ˜¯linux 64ä¸ºç³»ç»Ÿï¼Œé€‰æ‹©äº†v2ray-linux-64.zip</p><p><img src="https://oss.smart-lifestyle.cn/file/115zq.png" alt="image-20220419094326600"></p><ul><li>ä¸‹è½½å®‰è£…åŒ…</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/v2fly/v2ray-core/releases/download/v4.44.0/v2ray-linux-64.zip</span><br></pre></td></tr></table></figure><p>æœåŠ¡å•†æœ¬èº«è®¿é—®githubæœ‰é—®é¢˜ï¼Œå¯ä»¥å…ˆä¸‹è½½åˆ°æœ¬åœ°ï¼Œç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Š</p><ul><li>è§£å‹ç›®å½•</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uzip v2ray-linux-64.zip -d v2ray-linux</span><br></pre></td></tr></table></figure><ul><li>è·å–é…ç½®æ–‡ä»¶</li></ul><p>å¯ä»¥ä½¿ç”¨ä½ å·²ç»æœ‰çš„config.json å°†å…¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œä¸‹é¢çš„å‘½ä»¤å¯ä»¥æµ‹è¯•æ–‡ä»¶æ˜¯å¦æ­£ç¡®</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./v2ray -test config.json</span><br></pre></td></tr></table></figure><p>æˆ‘è¿™è¾¹åœ¨etcç›®å½•ä¸‹åˆ›å»ºäº†ä¸€ä¸ªv2ray-linuxæ–‡ä»¶å¤¹ï¼Œå¹¶å°†æ‰€æœ‰ç›¸å…³æ–‡ä»¶éƒ½æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œ</p><p><img src="https://oss.smart-lifestyle.cn/file/g05rn.png" alt="image-20220419095826482"></p><ul><li>é…ç½®serviceæ–‡ä»¶</li></ul><p>åˆ›å»ºv2ray.serviceæ–‡ä»¶ï¼Œæ”¾åˆ°/usr/lib/systemd/system/v2ray.service</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=V2Ray Service</span><br><span class="line">Documentation=https://www.v2fly.org/</span><br><span class="line">After=network.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStart=/etc/v2ray-linux/v2ray -config /etc/v2ray-linux/config.json</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartPreventExitStatus=23</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨service</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service v2ray start</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹çŠ¶æ€</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">service v2ray status</span><br><span class="line">â— v2ray.service - V2Ray Service</span><br><span class="line">     Loaded: loaded (/lib/systemd/system/v2ray.service; disabled; vendor preset: enabled)</span><br><span class="line">     Active: active (running) since Mon 2022-04-18 21:49:55 CST; 12h ago</span><br><span class="line">       Docs: https://www.v2fly.org/</span><br><span class="line">   Main PID: 3047292 (v2ray)</span><br><span class="line">      Tasks: 10 (<span class="built_in">limit</span>: 8819)</span><br><span class="line">     Memory: 6.2M</span><br><span class="line">     CGroup: /system.slice/v2ray.service</span><br><span class="line">             â””â”€3047292 /etc/v2ray-linux/v2ray -config /etc/v2ray-linux/config.json</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ç»ˆç«¯å¯ç”¨ä»£ç†</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:1087;<span class="built_in">export</span> https_proxy=http://127.0.0.1:1087;<span class="built_in">export</span> ALL_PROXY=socks5://127.0.0.1:1080</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>[1] <a href="https://www.jianshu.com/p/dae87e4d7691">è®°å½•ï¼šLinuxä¸‹ V2Ray åŸç”Ÿå®¢æˆ·ç«¯é…ç½® - ç®€ä¹¦ (jianshu.com)</a></p><p>[2] <a href="https://github.com/v2fly/v2ray-core/releases">Releases Â· v2fly/v2ray-core (github.com)</a></p>]]></content>
    
    
    <summary type="html">å¦‚ä½•åœ¨linux ä¸‹ä½¿ç”¨v2ray å®¢æˆ·ç«¯</summary>
    
    
    
    <category term="å·¥å…·" scheme="https://blog.smart-lifestyle.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="v2ray" scheme="https://blog.smart-lifestyle.cn/tags/v2ray/"/>
    
  </entry>
  
  <entry>
    <title>RESTFul APIè®¾è®¡è§„åˆ™</title>
    <link href="https://blog.smart-lifestyle.cn/posts/81a9/"/>
    <id>https://blog.smart-lifestyle.cn/posts/81a9/</id>
    <published>2021-11-30T15:21:05.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æ€»ç»“ä¸€ä¸‹restful apiåœ¨è®¾è®¡æ—¶çš„ä¸€äº›è§„åˆ™</p></blockquote><p>é¦–å…ˆåº”è¯¥æ»¡è¶³ï¼Œæ— è®ºAPIå†…éƒ¨å¦‚ä½•å®ç°ï¼Œä»»ä½•å®¢æˆ·ç«¯ï¼ˆpythonã€c#ã€C++ç­‰ï¼‰éƒ½åº”è¯¥èƒ½å¤Ÿä»£ç”¨APIï¼Œ</p><p>å¼•å…¥ç‰ˆæœ¬ç®¡ç†ï¼Œå¯¹äºå·²å‘å¸ƒçš„APIï¼Œä¿æŒå·²ä½¿ç”¨çš„å®¢æˆ·ç«¯ä¸å—å½±å“</p><h2 id="è®¾è®¡åŸåˆ™"><a href="#è®¾è®¡åŸåˆ™" class="headerlink" title="è®¾è®¡åŸåˆ™"></a>è®¾è®¡åŸåˆ™</h2><p>RESTful APIè®¾è®¡çš„ä¸»è¦åŸåˆ™</p><ul><li>REST APIå›´ç»•èµ„æºè®¾è®¡ï¼Œèµ„æºæ˜¯å¯ç”±å®¢æˆ·ç«¯è®¿é—®çš„ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€æ•°æ®æˆ–æœåŠ¡</li><li>æ¯ä¸€ä¸ªèµ„æºéƒ½æœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œå³å”¯ä¸€æ ‡è¯†è¯¥èµ„æºçš„URI</li><li>é€šè¿‡JSONä½œä¸ºæ•°æ®äº¤æ¢æ ¼å¼</li><li>REST APIä½¿ç”¨åŒä¸€æ¥å£ï¼ˆPOSTæ–°å¢ã€GETè·å–ã€DELETEåˆ é™¤ã€PUTä¿®æ”¹ç­‰ï¼‰</li><li>REST APIä½¿ç”¨æ— çŠ¶æ€æ¨¡å‹ï¼ˆæœ€å¥½ï¼‰</li></ul><h3 id="URIåŸºäºï¼ˆå¤æ•°ï¼‰åè¯ï¼Œä¸”ç®€æ´"><a href="#URIåŸºäºï¼ˆå¤æ•°ï¼‰åè¯ï¼Œä¸”ç®€æ´" class="headerlink" title="URIåŸºäºï¼ˆå¤æ•°ï¼‰åè¯ï¼Œä¸”ç®€æ´"></a>URIåŸºäºï¼ˆå¤æ•°ï¼‰åè¯ï¼Œä¸”ç®€æ´</h3><p>èµ„æºçš„URIåŸºäºåè¯è€Œä¸æ˜¯åŠ¨è¯ï¼ˆå¯¹èµ„æºæ‰§è¡Œçš„æ“ä½œï¼‰ï¼Œèµ„æºæ˜¯ä¸€ä¸ªé›†åˆï¼Œæœ€å¥½ç”¨åè¯çš„å¤æ•°</p><ul><li>ç”¨åè¯ä¸ç”¨åŠ¨è¯</li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å¥½</span><br><span class="line">https://d-wz.cc/orders</span><br><span class="line"># ä¸å¥½</span><br><span class="line">https://d-wz.cc/create-order  </span><br></pre></td></tr></table></figure><ul><li>é¿å…è®¾è®¡è¿‡é•¿çš„èµ„æºURI</li></ul><p>é¿å…è¯·æ±‚å¤æ‚åº¦é¿å…è¶…è¿‡<strong>é›†åˆ/é¡¹ç›®/é›†åˆ</strong>çš„èµ„æº</p><p>æ¯”å¦‚æŸ¥è¯¢æŸä¸ªå®¢æˆ·æŸä¸ªè®¢å•çš„äº§å“æœ‰å“ªäº›</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è¯·è¿‡è¿‡äºå¤æ‚</span><br><span class="line">https://d-wz.cc/customers/2/orders/100/products</span><br></pre></td></tr></table></figure><p>æ‹†åˆ†ä¸º2æ­¥</p><ol><li>å…ˆè·å–å®¢æˆ·è®¢å•å·åˆ—è¡¨</li><li>å†è·å–è®¢å•å·ä¸‹é¢çš„äº§å“åˆ—è¡¨</li><li>å¦‚æœæŸ¥è¯¢æŸä¸ªäº§å“è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥å†åŠ ä¸€æ­¥</li></ol><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># ç¬¬ä¸€æ­¥ </span><br><span class="line">https://d-wz.cc/customers/2/orders</span><br><span class="line"># ç¬¬äºŒæ­¥</span><br><span class="line">https://d-wz.cc/orders/100/products</span><br></pre></td></tr></table></figure><h3 id="æŒ‰ç…§HTTPå®šä¹‰æ–¹æ³•å®ç°"><a href="#æŒ‰ç…§HTTPå®šä¹‰æ–¹æ³•å®ç°" class="headerlink" title="æŒ‰ç…§HTTPå®šä¹‰æ–¹æ³•å®ç°"></a>æŒ‰ç…§HTTPå®šä¹‰æ–¹æ³•å®ç°</h3><ol><li>æ ¹æ®HTTPæ–¹æ³•å®šä¹‰APIæ“ä½œ</li></ol><ul><li><strong>GET</strong> æ£€ç´¢ä½äºæŒ‡å®š URI å¤„çš„èµ„æºã€‚ å“åº”æ¶ˆæ¯çš„æ­£æ–‡åŒ…å«æ‰€è¯·æ±‚èµ„æºçš„è¯¦ç»†ä¿¡æ¯ã€‚</li><li><strong>POST</strong> åœ¨æŒ‡å®šçš„ URI å¤„åˆ›å»ºæ–°èµ„æºã€‚ è¯·æ±‚æ¶ˆæ¯çš„æ­£æ–‡å°†æä¾›æ–°èµ„æºçš„è¯¦ç»†ä¿¡æ¯ã€‚ è¯·æ³¨æ„ï¼ŒPOST è¿˜ç”¨äºè§¦å‘ä¸å®é™…åˆ›å»ºèµ„æºçš„æ“ä½œã€‚</li><li><strong>PUT</strong> åœ¨æŒ‡å®šçš„ URI å¤„åˆ›å»ºæˆ–æ›¿æ¢èµ„æºã€‚ è¯·æ±‚æ¶ˆæ¯çš„æ­£æ–‡æŒ‡å®šè¦åˆ›å»ºæˆ–æ›´æ–°çš„èµ„æºã€‚</li><li><strong>PATCH</strong> å¯¹èµ„æºæ‰§è¡Œéƒ¨åˆ†æ›´æ–°ã€‚ è¯·æ±‚æ­£æ–‡åŒ…å«è¦åº”ç”¨åˆ°èµ„æºçš„ä¸€ç»„æ›´æ”¹ã€‚</li><li><strong>DELETE</strong> åˆ é™¤ä½äºæŒ‡å®š URI å¤„çš„èµ„æº</li></ul><p>ç‰¹å®šè¯·æ±‚çš„å½±å“åº”å–å†³äºèµ„æºæ˜¯é›†åˆè¿˜æ˜¯å•ä¸ªå­é¡¹ã€‚ ä¸‹è¡¨æ€»ç»“äº†å¤§å¤šæ•° RESTful å®ç°ä½¿ç”¨ç”µå­å•†åŠ¡ç¤ºä¾‹é‡‡ç”¨çš„å…±åŒçº¦å®šã€‚ å¹¶éæ‰€æœ‰è¿™äº›è¯·æ±‚éƒ½å¯èƒ½ä¼šå®ç° â€” ï¼Œè¿™å–å†³äºç‰¹å®šæ–¹æ¡ˆã€‚</p><table><thead><tr><th align="left"><strong>èµ„æº</strong></th><th align="left"><strong>POST</strong></th><th align="left"><strong>GET</strong></th><th align="left"><strong>PUT</strong></th><th align="left"><strong>DELETE</strong></th></tr></thead><tbody><tr><td align="left">/customers</td><td align="left">åˆ›å»ºæ–°å®¢æˆ·</td><td align="left">æ£€ç´¢æ‰€æœ‰å®¢æˆ·</td><td align="left">æ‰¹é‡æ›´æ–°å®¢æˆ·</td><td align="left">åˆ é™¤æ‰€æœ‰å®¢æˆ·</td></tr><tr><td align="left">/customers/1</td><td align="left">é”™è¯¯</td><td align="left">æ£€ç´¢å®¢æˆ· 1 çš„è¯¦ç»†ä¿¡æ¯</td><td align="left">å¦‚æœå®¢æˆ· 1 å­˜åœ¨ï¼Œåˆ™æ›´æ–°å…¶è¯¦ç»†ä¿¡æ¯</td><td align="left">åˆ é™¤å®¢æˆ· 1</td></tr><tr><td align="left">/customers/1/orders</td><td align="left">åˆ›å»ºå®¢æˆ· 1 çš„æ–°è®¢å•</td><td align="left">æ£€ç´¢å®¢æˆ· 1 çš„æ‰€æœ‰è®¢å•</td><td align="left">æ‰¹é‡æ›´æ–°å®¢æˆ· 1 çš„è®¢å•</td><td align="left">åˆ é™¤å®¢æˆ· 1 çš„æ‰€æœ‰è®¢å•</td></tr></tbody></table><ol start="2"><li>ä½¿ç”¨HTPPæ ‡å‡†è§„èŒƒå®ç°è¿”å›ç </li></ol><p>å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡ç«¯çš„content-typeï¼Œå¦‚æœæœåŠ¡ç«¯ä¸æ”¯æŒï¼Œè¿”å›415é”™è¯¯</p><p>å®¢æˆ·ç«¯è¯·æ±‚åŒ…å«acceptï¼Œå¦‚æœæœåŠ¡ç«¯æ— æ³•åŒ¹é…ï¼Œè¿”å›406é”™è¯¯</p><ul><li>getæ–¹æ³•<ol><li>æˆåŠŸè¿”å›200ï¼Œ æ‰¾ä¸åˆ°è¿”å›404</li></ol></li><li>postæ–¹æ³•<pre><code>   1. åˆ›å»ºæ–°èµ„æºè¿”å›201ï¼Œæ–°èµ„æºçš„URIåŒ…å«åœ¨å“åº”çš„Locationæ ‡å¤´ä¸­2. å¦‚æœå¤„ç†ä½†æœªåˆ›å»ºæ–°èµ„æºï¼Œè¿”å›2003. å®¢æˆ·ç«¯å°†æ— æ•ˆæ•°æ®æ”¾å…¥åˆ°è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›400</code></pre></li><li>deleteæ–¹æ³•<pre><code>  1. åˆ é™¤æˆåŠŸè¿”å›204</code></pre><ol start="2"><li>èµ„æºä¸å­˜åœ¨è¿”å›404</li></ol></li></ul><ol start="3"><li>å¼‚æ­¥æ“ä½œä¸­çš„è§„èŒƒ</li></ol><p>å¼‚æ­¥æ“ä½œï¼Œæ˜¯è¯·æ±‚å‘é€åˆ°æœåŠ¡ç«¯åï¼ŒæœåŠ¡ç«¯éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½å¤„ç†å®Œæˆçš„ï¼Œå¦‚æœéœ€è¦ç­‰å¾…è¯¥æ“ä½œå®Œæˆåæ‰å‘å®¢æˆ·ç«¯å‘é€å“åº”ï¼Œå»¶è¿Ÿå¤ªå¤§ï¼Œè¿™æ—¶å€™éœ€è¦è€ƒè™‘å¼‚æ­¥æ“ä½œï¼Œé¦–å…ˆè¿”å›çŠ¶æ€ç 202ï¼Œè¡¨ç¤ºè¯·æ±‚æ¥å—å¤„ç†ï¼Œä½†å°šæœªå®Œæˆï¼Œç„¶ååœ¨è¿”å›å†…å®¹ä¸­ï¼ŒåŒ…å«ä¸€ä¸ªé“¾æ¥ï¼Œç”¨æˆ·å¯ä»¥å»æŸ¥è¯¢è¯·æ±‚çš„å½“å‰çŠ¶æ€</p><p>ç¬¬ä¸€æ­¥ï¼Œå…ˆè¿”å›202çŠ¶æ€æ³•ï¼Œå¹¶åŒæ—¶å°†åç»­æŸ¥è¯¢çŠ¶æ€URIæ”¾åˆ°Locationä¸­</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">202</span> Accepted</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>/api/status/12345</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯å‘çŠ¶æ€ç»ˆç»“ç‚¹å‘é€GETè¯·æ±‚ï¼Œå“åº”ä¸­è¿”å›ä¹‹å‰è¯·æ±‚çš„çŠ¶æ€</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line"><span class="json">&#123;</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;status&quot;</span>:<span class="string">&quot;In progress&quot;</span>,</span></span><br><span class="line"><span class="json">    <span class="attr">&quot;link&quot;</span>: &#123; <span class="attr">&quot;rel&quot;</span>:<span class="string">&quot;cancel&quot;</span>, <span class="attr">&quot;method&quot;</span>:<span class="string">&quot;delete&quot;</span>, <span class="attr">&quot;href&quot;</span>:<span class="string">&quot;/api/status/12345&quot;</span> &#125;</span></span><br><span class="line"><span class="json">&#125;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå¼‚æ­¥æ“ä½œåˆ›å»ºäº†æ–°èµ„æºï¼ŒçŠ¶æ€ç»ˆç»“ç‚¹è¿”å›çŠ¶æ€ç 303ï¼Œå¹¶åŒ…å«ä¸€ä¸ªlocationæ ‡å¤´ç”¨äºæä¾›æ–°èµ„æºçš„URI</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">303</span> See Other</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>/api/orders/12345</span><br></pre></td></tr></table></figure><ol start="4"><li><p>å¯¹äºç»ˆç»“ç‚¹å¸¦ä¸å¸¦â€™/â€˜éƒ½åº”è¯¥æ”¯æŒ</p><p>ç”¨ä¸€ä¸ªURIä»¥â€™/â€˜ç»“å°¾æˆ–è€…ä¸å¸¦â€™/â€˜æœåŠ¡ç«¯éƒ½åº”è¯¥æ”¯æŒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹é¢åº”è¯¥è¿”å›åŒæ ·å†…å®¹</span><br><span class="line">curl https://d-wz.cc/api/cats/</span><br><span class="line">curl https://d-wz.cc/api/cats</span><br></pre></td></tr></table></figure></li><li><p>401å’Œ403åŒºåˆ«</p><ul><li><p>401 è¡¨ç¤ºç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯ï¼Œæˆ–è€…æ— æ³•è¯†åˆ«ç”¨æˆ·èº«ä»½</p></li><li><p>403 è¡¨ç¤ºèƒ½å¤Ÿè¯†åˆ«ç”¨æˆ·èº«ä»½ï¼Œä½†æ˜¯ä»–æ²¡æœ‰æƒé™å»æ“ä½œ</p></li></ul></li></ol><h3 id="è¿”å›æ•°æ®éœ€è¦ç­›é€‰å’Œåˆ†é¡µ"><a href="#è¿”å›æ•°æ®éœ€è¦ç­›é€‰å’Œåˆ†é¡µ" class="headerlink" title="è¿”å›æ•°æ®éœ€è¦ç­›é€‰å’Œåˆ†é¡µ"></a>è¿”å›æ•°æ®éœ€è¦ç­›é€‰å’Œåˆ†é¡µ</h3><p>å‰ç«¯å±•ç¤ºçš„æ•°æ®å¾€å¾€æ˜¯æ‰€æœ‰æ•°æ®çš„ä¸€å°éƒ¨åˆ†ï¼Œé€šè¿‡ç­›é€‰å’Œåˆ†é¡µå‡å°‘å¯¹æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å‹åŠ›ï¼Œåœ¨GETè¯·æ±‚ä¸­ä½¿ç”¨queryæ–¹å¼ï¼Œæ¯”å¦‚å¢åŠ pageè¡¨ç¤ºç¬¬å‡ é¡µï¼Œpage_sizeè¡¨ç¤ºæ¯é¡µçš„æ•°é‡ï¼Œboolå€¼è¡¨ç¤ºçŠ¶æ€ç­‰ç­‰</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">GET</span><span class="punctuation">: </span>/books?published=true&amp;page=2&amp;page_size=10</span><br></pre></td></tr></table></figure><h3 id="APIè®¾è®¡æ—¶è¦è€ƒè™‘ç‰ˆæœ¬"><a href="#APIè®¾è®¡æ—¶è¦è€ƒè™‘ç‰ˆæœ¬" class="headerlink" title="APIè®¾è®¡æ—¶è¦è€ƒè™‘ç‰ˆæœ¬"></a>APIè®¾è®¡æ—¶è¦è€ƒè™‘ç‰ˆæœ¬</h3><p>å°½å¯èƒ½ä¿è¯é‡Šæ”¾å‡ºå»çš„APIï¼Œå®¢æˆ·åœ¨ä½¿ç”¨åä¸ç”¨ä¿®æ”¹æ¥å£</p><p>ç›®å‰è€ƒè™‘ä¸¤ç§æ–¹å¼åšç‰ˆæœ¬æ§åˆ¶</p><ol><li>åœ¨URIä¸­å¢åŠ ç‰ˆæœ¬å·ï¼Œå¯¹äºURIä¸€è‡´çš„ï¼Œä»¥å‰å­˜åœ¨çš„URIæŒ‰ç…§ä»¥å‰ä¸€æ ·ç»§ç»­è¿è¡Œï¼Œå¦‚æœæ–°ç‰ˆå¢åŠ äº†æ–°çš„è¿”å›å­—æ®µï¼Œåˆ™é€šè¿‡å¢åŠ ç‰ˆæœ¬å·çš„æ–¹å¼ç®¡ç†</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://adventure-works.com/v2/customers/3</span><br></pre></td></tr></table></figure><ol start="2"><li>æŸ¥è¯¢å­—ç¬¦ä¸²æ–¹å¼ç‰ˆæœ¬æ§åˆ¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://adventure-works.com/customers/3?version=2</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæŸäº›è¾ƒæ—§çš„ Web æµè§ˆå™¨å’Œ Web ä»£ç†ä¸ä¼šç¼“å­˜åœ¨ URI ä¸­åŒ…å«æŸ¥è¯¢å­—ç¬¦ä¸²çš„è¯·æ±‚çš„å“åº”ã€‚ è¿™å¯èƒ½ä¼šé™ä½ä½¿ç”¨ web API çš„ web åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œå¹¶ä»è¿™ç±» web æµè§ˆå™¨ä¸­è¿è¡Œã€‚</p><p>URI ç‰ˆæœ¬æ§åˆ¶å’ŒæŸ¥è¯¢å­—ç¬¦ä¸²ç‰ˆæœ¬æ§åˆ¶æ–¹æ¡ˆéƒ½æ˜¯ç¼“å­˜å‹å¥½çš„ï¼Œå› ä¸ºåŒä¸€ URI/æŸ¥è¯¢å­—ç¬¦ä¸²ç»„åˆæ¯æ¬¡éƒ½æŒ‡å‘ç›¸åŒçš„æ•°æ®ã€‚</p><h3 id="APIå‘å¸ƒè¦æœ‰é…å¥—æ¥å£æ–‡æ¡£æ”¯æŒ"><a href="#APIå‘å¸ƒè¦æœ‰é…å¥—æ¥å£æ–‡æ¡£æ”¯æŒ" class="headerlink" title="APIå‘å¸ƒè¦æœ‰é…å¥—æ¥å£æ–‡æ¡£æ”¯æŒ"></a>APIå‘å¸ƒè¦æœ‰é…å¥—æ¥å£æ–‡æ¡£æ”¯æŒ</h3><p>æ¯”å¦‚ä½¿ç”¨swaggerç®¡ç†APIæ–‡æ¡£ï¼Œåœ¨APIå‘å¸ƒæ—¶ï¼ŒåŒæ ·è¦å‘å¸ƒæ¥å£æ–‡æ¡£ï¼Œæ¥æ–¹ä¾¿ç”¨æˆ·äº†è§£å¦‚ä½•è°ƒç”¨ä½ çš„API</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://docs.microsoft.com/zh-cn/azure/architecture/best-practices/api-design">Web API è®¾è®¡æœ€ä½³åšæ³• - Azure Architecture Center | Microsoft Docs</a></p><p>[2] <a href="https://abdulrwahab.medium.com/api-architecture-best-practices-for-designing-rest-apis-bf907025f5f">API Architecture â€” Design Best Practices for REST APIs | by Abdul Wahab | Oct, 2021 | Medium</a></p><p>[3] <a href="https://docs.microsoft.com/zh-cn/azure/architecture/patterns/async-request-reply">å¼‚æ­¥Request-Replyæ¨¡å¼ - Azure Architecture Center | Microsoft Docs</a></p><p>[4] <a href="https://mathieu.fenniak.net/the-api-checklist/">The Web API Checklist â€“ 43 Things To Think About When Designing, Testing, and Releasing your API (fenniak.net)</a></p>]]></content>
    
    
    <summary type="html">ä½ éœ€è¦äº†è§£çš„RESTFul APIè®¾è®¡è§„åˆ™</summary>
    
    
    
    <category term="webå¼€å‘" scheme="https://blog.smart-lifestyle.cn/categories/web%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="api" scheme="https://blog.smart-lifestyle.cn/tags/api/"/>
    
    <category term="web" scheme="https://blog.smart-lifestyle.cn/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨Azure Pipelineä¸Šç¼–è¯‘React Native Android APP</title>
    <link href="https://blog.smart-lifestyle.cn/posts/bf91/"/>
    <id>https://blog.smart-lifestyle.cn/posts/bf91/</id>
    <published>2021-11-13T22:04:16.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»åœ¨Azure Pipelineä¸Šæ­å»ºAndroid ç¼–è¯‘æ‰“åŒ…è¿‡ç¨‹ä»¥åŠä¸­é—´é‡åˆ°çš„é—®é¢˜ï¼Œæœ€ç»ˆå°†æ‰“åŒ…å¥½çš„APPå‘å¸ƒåˆ°å¾®è½¯APP Centerä¸­</p><p><img src="https://oss.smart-lifestyle.cn/file/3adoj.png" alt="image-20211114074340599"></p><h2 id="æµæ°´çº¿"><a href="#æµæ°´çº¿" class="headerlink" title="æµæ°´çº¿"></a>æµæ°´çº¿</h2><p>æµæ°´çº¿çš„Pipelineé…ç½®å¦‚ä¸‹ï¼ˆå®é™…ä½¿ç”¨çš„æ˜¯Pipelineçš„ç»å…¸æ¨¡å¼ï¼Œå³å›¾å½¢åŒ–æ¨¡å¼ï¼Œä¸‹é¢é…ç½®è·Ÿå®é™…ç¨å¾®æœ‰åŒºåˆ«ï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pool:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">Azure</span> <span class="string">Pipelines</span></span><br><span class="line"><span class="comment">#Your build pipeline references an undefined variable named â€˜envconfig.secureFilePathâ€™. Create or edit the build pipeline for this YAML file, define the variable on the Variables tab. See https://go.microsoft.com/fwlink/?linkid=865972</span></span><br><span class="line"><span class="comment">#Your build pipeline references an undefined variable named â€˜keystorefile.secureFilePathâ€™. Create or edit the build pipeline for this YAML file, define the variable on the Variables tab. See https://go.microsoft.com/fwlink/?linkid=865972</span></span><br><span class="line"><span class="comment">#Your build pipeline references an undefined variable named â€˜envconfig.secureFilePathâ€™. Create or edit the build pipeline for this YAML file, define the variable on the Variables tab. See https://go.microsoft.com/fwlink/?linkid=865972</span></span><br><span class="line"></span><br><span class="line"><span class="attr">steps:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">DownloadSecureFile@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Download keystore file&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">secureFile:</span> <span class="string">xxx.xxx.xxx.keystore</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">DownloadSecureFile@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Download envconfig&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">secureFile:</span> <span class="string">.env.prod</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">script:</span> <span class="string">|</span></span><br><span class="line"><span class="string">   echo &quot;link env file&quot;</span></span><br><span class="line"><span class="string">   ln -s $(envconfig.secureFilePath) ./ </span></span><br><span class="line"><span class="string">   echo &quot;link keystore&quot;</span></span><br><span class="line"><span class="string">   ln -s $(keystorefile.secureFilePath) ./android/app</span></span><br><span class="line"><span class="string"></span>  <span class="attr">workingDirectory:</span> <span class="string">./</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;link env file and keystore file&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">NodeTool@0</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Use Node 14&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">versionSpec:</span> <span class="number">14</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-installer-task.YarnInstaller@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Use Yarn 1.22&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">versionSpec:</span> <span class="number">1.22</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">Cache@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">Cache</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">key:</span> <span class="string">&#x27;yarn | &quot;$(Agent.OS)&quot; | yarn.lock&#x27;</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">&#x27;./node_modules&#x27;</span></span><br><span class="line">    <span class="attr">cacheHitVar:</span> <span class="string">&#x27;yarn | &quot;$(Agent.OS)&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-task.Yarn@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Yarn add jetifier&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">projectDirectory:</span> <span class="string">./</span></span><br><span class="line">    <span class="attr">arguments:</span> <span class="string">&#x27;add jetifier&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">script:</span> <span class="string">&#x27;npx jetify&#x27;</span></span><br><span class="line">  <span class="attr">workingDirectory:</span> <span class="string">./</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;npx jetify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-task.Yarn@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Yarn  install&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">projectDirectory:</span> <span class="string">./</span></span><br><span class="line">    <span class="attr">arguments:</span> <span class="string">install</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-task.Yarn@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Yarn build&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">projectDirectory:</span> <span class="string">./</span></span><br><span class="line">    <span class="attr">arguments:</span> <span class="string">&#x27;sh:assemble:android:prod&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">CopyFiles@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Copy Files to: $(build.artifactstagingdirectory)&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">SourceFolder:</span> <span class="string">&#x27;$(system.defaultworkingdirectory)&#x27;</span></span><br><span class="line">    <span class="attr">Contents:</span> <span class="string">&#x27;**/*.apk&#x27;</span></span><br><span class="line">    <span class="attr">TargetFolder:</span> <span class="string">&#x27;$(build.artifactstagingdirectory)&#x27;</span></span><br><span class="line">  <span class="attr">condition:</span> <span class="string">succeededOrFailed()</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">PublishBuildArtifacts@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Publish Artifact: drop&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">PathtoPublish:</span> <span class="string">&#x27;$(build.artifactstagingdirectory)&#x27;</span></span><br><span class="line">  <span class="attr">condition:</span> <span class="string">succeededOrFailed()</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">AppCenterTest@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Test with Visual Studio App Center&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">appFile:</span> <span class="string">&#x27;**/*.apk&#x27;</span></span><br><span class="line">    <span class="attr">prepareTests:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">runTests:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">condition:</span> <span class="string">succeededOrFailed()</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">AppCenterDistribute@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Deploy **/*.apk to Visual Studio App Center&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">serverEndpoint:</span> <span class="string">&#x27;service name&#x27;</span></span><br><span class="line">    <span class="attr">appSlug:</span> <span class="string">&#x27;org/appname&#x27;</span></span><br><span class="line">    <span class="attr">appFile:</span> <span class="string">&#x27;**/*.apk&#x27;</span></span><br><span class="line">    <span class="attr">symbolsIncludeParentDirectory:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">releaseNotesInput:</span> <span class="string">&#x27;new release&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½æœºå¯†æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶"><a href="#ä¸‹è½½æœºå¯†æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶" class="headerlink" title="### ä¸‹è½½æœºå¯†æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶"></a>### ä¸‹è½½æœºå¯†æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">DownloadSecureFile@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Download keystore file&#x27;</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">keystorefile</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">secureFile:</span> <span class="string">xxx.xxx.xxx.keystore</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">DownloadSecureFile@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Download envconfig&#x27;</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">envconfig</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">secureFile:</span> <span class="string">.env.prod</span></span><br></pre></td></tr></table></figure><p>Azure DevOps Pipelineä¸­æä¾›äº†å®‰å…¨æ–‡ä»¶çš„ä¸‹è½½ï¼Œæˆ‘ä»¬åœ¨ç¯å¢ƒä¸­ä½¿ç”¨çš„keystoreæ–‡ä»¶ä»¥åŠenvæ–‡ä»¶æ˜¯ä¸èƒ½ç›´æ¥æäº¤åˆ°ä»£ç ä¸­ï¼Œç¬¬ä¸€æ˜¯ä¸ºäº†å®‰å…¨ï¼Œå¦‚æœæ³„æ¼åæœå¾ˆä¸¥é‡ï¼Œç¬¬äºŒæ˜¯æ–¹ä¾¿å¤šä¸ªç¯å¢ƒï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰çš„é…ç½®</p><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œé€šè¿‡<code>keystorefile.secureFilePath</code>å’Œ<code>envconfig.secureFilePath</code>æ¥ä½¿ç”¨è¿™ä¸¤ä¸ªæ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">script:</span> <span class="string">|</span></span><br><span class="line"><span class="string">   echo &quot;link env file&quot;</span></span><br><span class="line"><span class="string">   ln -s $(envconfig.secureFilePath) ./ </span></span><br><span class="line"><span class="string">   echo &quot;link keystore&quot;</span></span><br><span class="line"><span class="string">   ln -s $(keystorefile.secureFilePath) ./android/app</span></span><br><span class="line"><span class="string"></span>  <span class="attr">workingDirectory:</span> <span class="string">./</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;link env file and keystore file&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„nodeã€yarn"><a href="#å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„nodeã€yarn" class="headerlink" title="å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„nodeã€yarn"></a>å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„nodeã€yarn</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">NodeTool@0</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Use Node 14&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">versionSpec:</span> <span class="number">14</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-installer-task.YarnInstaller@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Use Yarn 1.22&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">versionSpec:</span> <span class="number">1.22</span></span><br></pre></td></tr></table></figure><h3 id="å®‰è£…ä¾èµ–åŒ…"><a href="#å®‰è£…ä¾èµ–åŒ…" class="headerlink" title="å®‰è£…ä¾èµ–åŒ…"></a>å®‰è£…ä¾èµ–åŒ…</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">Cache@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">Cache</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">key:</span> <span class="string">&#x27;yarn | &quot;$(Agent.OS)&quot; | yarn.lock&#x27;</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">&#x27;./node_modules&#x27;</span></span><br><span class="line">    <span class="attr">cacheHitVar:</span> <span class="string">&#x27;yarn | &quot;$(Agent.OS)&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-task.Yarn@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Yarn add jetifier&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">projectDirectory:</span> <span class="string">./</span></span><br><span class="line">    <span class="attr">arguments:</span> <span class="string">&#x27;add jetifier&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">script:</span> <span class="string">&#x27;npx jetify&#x27;</span></span><br><span class="line">  <span class="attr">workingDirectory:</span> <span class="string">./</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;npx jetify&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-task.Yarn@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Yarn  install&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">projectDirectory:</span> <span class="string">./</span></span><br><span class="line">    <span class="attr">arguments:</span> <span class="string">install</span></span><br></pre></td></tr></table></figure><h3 id="ç¼–è¯‘apk"><a href="#ç¼–è¯‘apk" class="headerlink" title="ç¼–è¯‘apk"></a>ç¼–è¯‘apk</h3><p>è¿™é‡Œå®é™…æ‰§è¡Œsh:assemble:android:prodå‘½ä»¤ä¸ºï¼š<code>cd android/ &amp;&amp; export ENVFILE=.env.beta &amp;&amp; ./gradlew assembleBetaRelease &amp;&amp; cd ..</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">geeklearningio.gl-vsts-tasks-yarn.yarn-task.Yarn@3</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Yarn build&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">projectDirectory:</span> <span class="string">./</span></span><br><span class="line">    <span class="attr">arguments:</span> <span class="string">&#x27;sh:assemble:android:prod&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="åˆ†å‘åˆ°appcenter"><a href="#åˆ†å‘åˆ°appcenter" class="headerlink" title="åˆ†å‘åˆ°appcenter"></a>åˆ†å‘åˆ°appcenter</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">PublishBuildArtifacts@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Publish Artifact: drop&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">PathtoPublish:</span> <span class="string">&#x27;$(build.artifactstagingdirectory)&#x27;</span></span><br><span class="line">  <span class="attr">condition:</span> <span class="string">succeededOrFailed()</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">AppCenterTest@1</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Test with Visual Studio App Center&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">appFile:</span> <span class="string">&#x27;**/*.apk&#x27;</span></span><br><span class="line">    <span class="attr">prepareTests:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">runTests:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">condition:</span> <span class="string">succeededOrFailed()</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">AppCenterDistribute@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;Deploy **/*.apk to Visual Studio App Center&#x27;</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">serverEndpoint:</span> <span class="string">&#x27;service name&#x27;</span></span><br><span class="line">    <span class="attr">appSlug:</span> <span class="string">&#x27;org/appname&#x27;</span></span><br><span class="line">    <span class="attr">appFile:</span> <span class="string">&#x27;**/*.apk&#x27;</span></span><br><span class="line">    <span class="attr">symbolsIncludeParentDirectory:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">releaseNotesInput:</span> <span class="string">&#x27;new release&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h2><p>å¤§éƒ¨åˆ†é—®é¢˜åœ¨äºå¼•ç”¨ç¯å¢ƒå˜é‡ï¼Œå¼•ç”¨æœºå¯†æ–‡ä»¶ä¸Šï¼Œå¯¼è‡´åœ¨ç¼–è¯‘æ—¶æ‰¾ä¸åˆ°ä¸€äº›å†…å®¹è€Œå‡ºé”™</p><h3 id="é—®é¢˜1-android-support-annotation-does-not-exist"><a href="#é—®é¢˜1-android-support-annotation-does-not-exist" class="headerlink" title="é—®é¢˜1 android.support.annotation does not exist"></a>é—®é¢˜1 <code>android.support.annotation does not exist</code></h3><p>å®‰è£…jetifier</p><p><code>yarn add jetifier</code></p><p><code>npx jetify</code></p><h3 id="é—®é¢˜2-ç¼“å­˜nodeä¾èµ–"><a href="#é—®é¢˜2-ç¼“å­˜nodeä¾èµ–" class="headerlink" title="é—®é¢˜2 ç¼“å­˜nodeä¾èµ–"></a>é—®é¢˜2 ç¼“å­˜nodeä¾èµ–</h3><p>ä¸ºäº†é¿å…æ¯æ¬¡buildæ—¶éƒ½é‡æ–°ä¸‹è½½nodeä¾èµ–ï¼Œazure pipelineæä¾›äº†ç®¡é“ç¼“å­˜ï¼ŒæŸ¥çœ‹<a href="https://docs.microsoft.com/zh-cn/azure/devops/pipelines/release/caching?view=azure-devops">å‚è€ƒåœ°å€</a></p><p>ä½†æ˜¯ç”±äºæ—¶é—´é—®é¢˜æ²¡æœ‰è°ƒé€š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">task:</span> <span class="string">Cache@2</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">Cache</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">key:</span> <span class="string">&#x27;yarn | &quot;$(Agent.OS)&quot; | yarn.lock&#x27;</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">&#x27;./node_modules&#x27;</span></span><br><span class="line">    <span class="attr">cacheHitVar:</span> <span class="string">&#x27;yarn | &quot;$(Agent.OS)&quot;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="gradle-file-project-env-get-filename"><a href="#gradle-file-project-env-get-filename" class="headerlink" title="gradle file(project.env.get(filename))"></a>gradle file(project.env.get(filename))</h3><p>è¿™é‡Œçš„filenameåªèƒ½æ˜¯æ–‡ä»¶åï¼Œè€Œä¸”gradleä¼šè‡ªåŠ¨åŠ ä¸Šå®Œæ•´çš„android/app/filenameï¼Œå¦‚æœè¿™é‡Œå†™çš„æ˜¯å…¶ä»–è·¯å¾„çš„æ–‡ä»¶ä¼šæ‰¾ä¸åˆ°ï¼ˆå³ä½¿å†™çš„ç»å¯¹è·¯å¾„ï¼‰ï¼Œå› æ­¤é€šè¿‡è½¯è¿æ¥çš„å½¢å¼ï¼Œå°†æ–‡ä»¶é“¾æ¥åˆ°android/appæ–‡ä»¶å¤¹ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">script:</span> <span class="string">|</span></span><br><span class="line"><span class="string">   echo &quot;link env file&quot;</span></span><br><span class="line"><span class="string">   ln -s $(envconfig.secureFilePath) ./ </span></span><br><span class="line"><span class="string">   echo &quot;link keystore&quot;</span></span><br><span class="line"><span class="string">   ln -s $(keystorefile.secureFilePath) ./android/app</span></span><br><span class="line"><span class="string"></span>  <span class="attr">workingDirectory:</span> <span class="string">./</span></span><br><span class="line">  <span class="attr">displayName:</span> <span class="string">&#x27;link env file and keystore file&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://stackoverflow.com/questions/56667264/react-native-build-error-package-android-support-annotation-does-not-exist">react native build error: package android.support.annotation does not exist - Stack Overflow</a></p><p>[2] <a href="https://github.com/staff0rd/react-native-pipeline/blob/master/azure-pipelines-android.yml">react-native-pipeline/azure-pipelines-android.yml at master Â· staff0rd/react-native-pipeline (github.com)</a></p><p>[3] <a href="https://blog.logrocket.com/continuous-deployment-of-react-native-app-with-azure-devops/">Continuous deployment of React Native app with Azure DevOps - LogRocket Blog</a></p><p>[4] <a href="https://docs.microsoft.com/zh-cn/azure/devops/pipelines/release/caching?view=azure-devops">ç®¡é“ç¼“å­˜ - Azure Pipelines | Microsoft Docs</a></p><p>[5] <a href="https://medium.com/@liam.e.andrew/continuous-integration-for-react-native-with-azure-pipelines-245d90948f6a">Continuous Integration for React Native with Azure Pipelines | by Liam Andrew | Medium</a></p><p>[6] <a href="https://docs.microsoft.com/zh-cn/azure/devops/pipelines/tasks/utility/download-secure-file?view=azure-devops">ä¸‹è½½å®‰å…¨æ–‡ä»¶ä»»åŠ¡ - Azure Pipelines | Microsoft Docs</a></p><p>[7] <a href="https://github.com/luggit/react-native-config/issues/314">gradle.properties doesnâ€™t process project.env.get(â€œ_keystore_fileâ€) Â· Issue #314 Â· luggit/react-native-config (github.com)</a></p>]]></content>
    
    
    <summary type="html">ä½¿ç”¨Azure DevOpsä¸­çš„Pipelineæ¥ç¼–è¯‘åŸºäºRNçš„Android APP</summary>
    
    
    
    <category term="DevOps" scheme="https://blog.smart-lifestyle.cn/categories/DevOps/"/>
    
    
    <category term="DevOps" scheme="https://blog.smart-lifestyle.cn/tags/DevOps/"/>
    
    <category term="React Native" scheme="https://blog.smart-lifestyle.cn/tags/React-Native/"/>
    
    <category term="Pipeline" scheme="https://blog.smart-lifestyle.cn/tags/Pipeline/"/>
    
  </entry>
  
  <entry>
    <title>Apple M1 nodeå¤šç‰ˆæœ¬åˆ‡æ¢</title>
    <link href="https://blog.smart-lifestyle.cn/posts/aa65/"/>
    <id>https://blog.smart-lifestyle.cn/posts/aa65/</id>
    <published>2021-10-11T16:35:53.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨nvmåœ¨Macbook M1ä¸‹ç®¡ç†å¤šä¸ªç‰ˆæœ¬ï¼ˆæ¶æ„ï¼‰çš„node</p><p>ç›®å‰Node V16å·²ç»åŸç”Ÿæ”¯æŒMacbook M1ï¼Œä½†æ˜¯å¦‚æœé€‰æ‹©V16ä»¥ä¸‹çš„ç‰ˆæœ¬ï¼Œéœ€è¦å®‰è£…X86çš„ç‰ˆæœ¬</p><p><img src="https://oss.smart-lifestyle.cn/file/brnx9.png" alt="image-20211011164226288"></p><h2 id="å®‰è£…nvm"><a href="#å®‰è£…nvm" class="headerlink" title="å®‰è£…nvm"></a>å®‰è£…nvm</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash</span><br><span class="line"><span class="comment"># æˆ–è€…</span></span><br><span class="line">wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash</span><br></pre></td></tr></table></figure><h2 id="å®‰è£…node"><a href="#å®‰è£…node" class="headerlink" title="å®‰è£…node"></a>å®‰è£…node</h2><h3 id="æœ€æ–°ARMç‰ˆæœ¬V16"><a href="#æœ€æ–°ARMç‰ˆæœ¬V16" class="headerlink" title="æœ€æ–°ARMç‰ˆæœ¬V16+"></a>æœ€æ–°ARMç‰ˆæœ¬V16+</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install node</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">v16.6.0</span><br><span class="line">node -p process.arch</span><br><span class="line">arm64</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…X86ç‰ˆæœ¬"><a href="#å®‰è£…X86ç‰ˆæœ¬" class="headerlink" title="å®‰è£…X86ç‰ˆæœ¬"></a>å®‰è£…X86ç‰ˆæœ¬</h3><h4 id="åˆ‡æ¢åˆ°x86ç¯å¢ƒ"><a href="#åˆ‡æ¢åˆ°x86ç¯å¢ƒ" class="headerlink" title="åˆ‡æ¢åˆ°x86ç¯å¢ƒ"></a>åˆ‡æ¢åˆ°x86ç¯å¢ƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arch -x86_64 zsh</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹å½“å‰ç¯å¢ƒ"><a href="#æŸ¥çœ‹å½“å‰ç¯å¢ƒ" class="headerlink" title="æŸ¥çœ‹å½“å‰ç¯å¢ƒ"></a>æŸ¥çœ‹å½“å‰ç¯å¢ƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arch</span><br><span class="line"><span class="comment"># i386</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="å®‰è£…node-1"><a href="#å®‰è£…node-1" class="headerlink" title="å®‰è£…node"></a>å®‰è£…node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install v14</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -p process.arch</span><br><span class="line">x64</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://github.com/nvm-sh/nvm#installing-and-updating">nvm-sh/nvm: Node Version Manager - POSIX-compliant bash script to manage multiple active node.js versions (github.com)</a></p><p>[2] <a href="https://www.jurnalanas.com/node-js-mac-m1/">macOS Big Sur: How to setup Node.js on Apple M1 Machine â€“ Jurnal Anas</a></p>]]></content>
    
    
    <summary type="html">Apple M1ä¸‹ï¼Œå¦‚æœç®¡ç†å¤šä¸ªç‰ˆæœ¬çš„node</summary>
    
    
    
    <category term="node" scheme="https://blog.smart-lifestyle.cn/categories/node/"/>
    
    
    <category term="nvm" scheme="https://blog.smart-lifestyle.cn/tags/nvm/"/>
    
    <category term="node" scheme="https://blog.smart-lifestyle.cn/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>æµ…è°ˆpythonç”ŸæˆçŸ­éšæœºæ•°</title>
    <link href="https://blog.smart-lifestyle.cn/posts/6ae6/"/>
    <id>https://blog.smart-lifestyle.cn/posts/6ae6/</id>
    <published>2021-09-29T12:53:44.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è¾ƒçŸ­çš„éšæœºæ•°ï¼ˆæ¯”å¦‚8ä½ï¼‰ï¼Œæ¯”å¦‚åœ¨ç”ŸæˆurlçŸ­é“¾æ¥ï¼Œéœ€è¦ç”Ÿæˆéšæœºä¸”å”¯ä¸€çš„8ä½å­—ç¬¦ä½œä¸ºæ–°çš„url</p><p><img src="https://oss.smart-lifestyle.cn/file/9qfwc.png" alt="image-20210929130158602"></p><p>ä»¥ä¸‹ä»‹ç»å‡ ç§ç”Ÿæˆshort uniqueéšæœºæ•°çš„æ–¹æ³•</p><h3 id="random-choices"><a href="#random-choices" class="headerlink" title="random.choices"></a>random.choices</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">alphabet = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;</span>.join(random.choices(alphabet, k=<span class="number">8</span>))</span><br></pre></td></tr></table></figure><h3 id="uuid4"><a href="#uuid4" class="headerlink" title="uuid4"></a>uuid4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"><span class="built_in">str</span>(uuid4())[:<span class="number">8</span>]</span><br></pre></td></tr></table></figure><h3 id="secrets-choice"><a href="#secrets-choice" class="headerlink" title="secrets.choice"></a>secrets.choice</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line">secrets.token_urlsafe(<span class="number">6</span>)</span><br></pre></td></tr></table></figure><h3 id="shortuuid"><a href="#shortuuid" class="headerlink" title="shortuuid"></a>shortuuid</h3><p>éœ€è¦å…ˆå®‰è£…ç¬¬ä¸‰æ–¹åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install shortuuid</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shortuuid</span><br><span class="line">su = shortuuid.ShortUUID(alphabet)</span><br><span class="line">su.random(length=<span class="number">8</span>)</span><br></pre></td></tr></table></figure><h3 id="NamedTemporaryFile"><a href="#NamedTemporaryFile" class="headerlink" title="NamedTemporaryFile"></a>NamedTemporaryFile</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> NamedTemporaryFile</span><br><span class="line"></span><br><span class="line">temp = NamedTemporaryFile(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">temp.name[-<span class="number">8</span>:]</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯„"><a href="#æµ‹è¯„" class="headerlink" title="æµ‹è¯„"></a>æµ‹è¯„</h3><p>æ— è®ºå“ªç§æ–¹æ³•ï¼Œä¼˜å…ˆè€ƒè™‘è¿™ç§æ–¹æ³•çš„ç¢°æ’æ¦‚ç‡æ˜¯å¤šå°‘ï¼Œä»¥ä¸‹æ˜¯å¯¹è¿™å‡ ç§æ–¹æ³•åœ¨ç¢°æ’æ¬¡æ•°ã€æ•ˆç‡ä¸Šçš„æµ‹è¯„</p><h4 id="random-choices-1"><a href="#random-choices-1" class="headerlink" title="random.choices"></a>random.choices</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">counts = <span class="number">10000000</span></span><br><span class="line">alphabet = string.ascii_letters + string.digits</span><br><span class="line">store = <span class="built_in">set</span>()</span><br><span class="line">collisions = <span class="number">0</span></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(counts):</span><br><span class="line">    code = <span class="string">&quot;&quot;</span>.join(random.choices(alphabet, k=<span class="number">8</span>))</span><br><span class="line">    <span class="keyword">if</span> code <span class="keyword">in</span> store:</span><br><span class="line">        collisions += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        store.add(code)</span><br><span class="line">end = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;run counts: <span class="subst">&#123;counts&#125;</span>, total time: <span class="subst">&#123;end-start&#125;</span>s, each time: <span class="subst">&#123;(end-start)/<span class="number">1.0</span>/counts&#125;</span>s, collisions=<span class="subst">&#123;collisions&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run counts: 10000000, total time: 12.96840283399979s, each time: 1.296840283399979e-06s, collisions=0</span><br></pre></td></tr></table></figure><h4 id="uuid4-1"><a href="#uuid4-1" class="headerlink" title="uuid4"></a>uuid4</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line">counts = <span class="number">10000000</span></span><br><span class="line">store = <span class="built_in">set</span>()</span><br><span class="line">collisions = <span class="number">0</span></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(counts):</span><br><span class="line">    code = <span class="built_in">str</span>(uuid4())[:<span class="number">8</span>]</span><br><span class="line">    <span class="keyword">if</span> code <span class="keyword">in</span> store:</span><br><span class="line">        collisions += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        store.add(code)</span><br><span class="line">end = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;run counts: <span class="subst">&#123;counts&#125;</span>, total time: <span class="subst">&#123;end-start&#125;</span>s, each time: <span class="subst">&#123;(end-start)/<span class="number">1.0</span>/counts&#125;</span>s, collisions=<span class="subst">&#123;collisions&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run counts: 10000000, total time: 20.264591582999856s, each time: 2.0264591582999855e-06s, collisions=11668</span><br></pre></td></tr></table></figure><h4 id="secrets-choice-1"><a href="#secrets-choice-1" class="headerlink" title="secrets.choice"></a>secrets.choice</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line">counts = <span class="number">10000000</span></span><br><span class="line">store = <span class="built_in">set</span>()</span><br><span class="line">collisions = <span class="number">0</span></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(counts):</span><br><span class="line">    code = secrets.token_urlsafe(<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">if</span> code <span class="keyword">in</span> store:</span><br><span class="line">        collisions += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        store.add(code)</span><br><span class="line">end = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;run counts: <span class="subst">&#123;counts&#125;</span>, total time: <span class="subst">&#123;end-start&#125;</span>s, each time: <span class="subst">&#123;(end-start)/<span class="number">1.0</span>/counts&#125;</span>s, collisions=<span class="subst">&#123;collisions&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run counts: 10000000, total time: 9.400313791999906s, each time: 9.400313791999906e-07s, collisions=0</span><br></pre></td></tr></table></figure><h4 id="shortuuid-1"><a href="#shortuuid-1" class="headerlink" title="shortuuid"></a>shortuuid</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> shortuuid</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">counts = <span class="number">10000000</span></span><br><span class="line">store = <span class="built_in">set</span>()</span><br><span class="line">collisions = <span class="number">0</span></span><br><span class="line">alphabet = string.ascii_letters + string.digits</span><br><span class="line">start = time.perf_counter()</span><br><span class="line">su = shortuuid.ShortUUID(alphabet)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(counts):</span><br><span class="line">    code = su.random(length=<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">if</span> code <span class="keyword">in</span> store:</span><br><span class="line">        collisions += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        store.add(code)</span><br><span class="line">end = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;run counts: <span class="subst">&#123;counts&#125;</span>, total time: <span class="subst">&#123;end-start&#125;</span>s, each time: <span class="subst">&#123;(end-start)/<span class="number">1.0</span>/counts&#125;</span>s, collisions=<span class="subst">&#123;collisions&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run counts: 10000000, total time: 20.793132207999406s, each time: 2.0793132207999407e-06s, collisions=1</span><br></pre></td></tr></table></figure><h4 id="NamedTemporaryFile-1"><a href="#NamedTemporaryFile-1" class="headerlink" title="NamedTemporaryFile"></a>NamedTemporaryFile</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> NamedTemporaryFile</span><br><span class="line">counts = <span class="number">10000000</span></span><br><span class="line">store = <span class="built_in">set</span>()</span><br><span class="line">collisions = <span class="number">0</span></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(counts):</span><br><span class="line">    temp = NamedTemporaryFile(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    code = temp.name[-<span class="number">8</span>:]</span><br><span class="line">    <span class="keyword">if</span> code <span class="keyword">in</span> store:</span><br><span class="line">        collisions += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        store.add(code)</span><br><span class="line">end = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;run counts: <span class="subst">&#123;counts&#125;</span>, total time: <span class="subst">&#123;end-start&#125;</span>s, each time: <span class="subst">&#123;(end-start)/<span class="number">1.0</span>/counts&#125;</span>s, collisions=<span class="subst">&#123;collisions&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿”å›æ—¶é—´å¤ªé•¿ï¼Œæ‰‹åŠ¨ç»ˆæ­¢</p><p><code>NamedTemporaryFile</code>å†…éƒ¨æ–¹æ³•ç”¨çš„<code>random.choices</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_RandomNameSequence</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;An instance of _RandomNameSequence generates an endless</span></span><br><span class="line"><span class="string">    sequence of unpredictable strings which can safely be incorporated</span></span><br><span class="line"><span class="string">    into file names.  Each string is eight characters long.  Multiple</span></span><br><span class="line"><span class="string">    threads can safely use the same instance at the same time.</span></span><br><span class="line"><span class="string">    _RandomNameSequence is an iterator.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    characters = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789_&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rng</span>(<span class="params">self</span>):</span></span><br><span class="line">        cur_pid = _os.getpid()</span><br><span class="line">        <span class="keyword">if</span> cur_pid != <span class="built_in">getattr</span>(self, <span class="string">&#x27;_rng_pid&#x27;</span>, <span class="literal">None</span>):</span><br><span class="line">            self._rng = _Random()</span><br><span class="line">            self._rng_pid = cur_pid</span><br><span class="line">        <span class="keyword">return</span> self._rng</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(self.rng.choices(self.characters, k=<span class="number">8</span>))</span><br></pre></td></tr></table></figure><p>ç¨å¾®ä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RandomNameSequence</span>:</span></span><br><span class="line">    characters = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rng</span>(<span class="params">self</span>):</span></span><br><span class="line">        cur_pid = os.getpid()</span><br><span class="line">        <span class="built_in">print</span>(cur_pid)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">getattr</span>(self, <span class="string">&#x27;_rng_pid&#x27;</span>, <span class="literal">None</span>))</span><br><span class="line">        <span class="keyword">if</span> cur_pid != <span class="built_in">getattr</span>(self, <span class="string">&#x27;_rng_pid&#x27;</span>, <span class="literal">None</span>):</span><br><span class="line">            self._rng = Random()</span><br><span class="line">            self._rng_pid = cur_pid</span><br><span class="line">        <span class="keyword">return</span> self._rng</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(self.rng.choices(self.characters, k=<span class="number">8</span>))</span><br></pre></td></tr></table></figure><p>æµ‹è¯•å†…å®¹(è¿™é‡Œå°†æ¬¡æ•°ç¼©å°äº†10å€ï¼Œç”±äºè€—æ—¶å¤ªé•¿)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">counts = <span class="number">1000000</span></span><br><span class="line">store = <span class="built_in">set</span>()</span><br><span class="line">collisions = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">start = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(counts):</span><br><span class="line">    code = <span class="built_in">next</span>(RandomNameSequence())</span><br><span class="line">    <span class="keyword">if</span> code <span class="keyword">in</span> store:</span><br><span class="line">        collisions += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        store.add(code)</span><br><span class="line">end = time.perf_counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;run counts: <span class="subst">&#123;counts&#125;</span>, total time: <span class="subst">&#123;end-start&#125;</span>s, each time: <span class="subst">&#123;(end-start)/<span class="number">1.0</span>/counts&#125;</span>s, collisions=<span class="subst">&#123;collisions&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run counts: 1000000, total time: 21.044718625s, each time: 2.1044718625000002e-05s, collisions=0</span><br></pre></td></tr></table></figure><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><ul><li><p>UUIDåªåŒ…å«å°å†™å­—æ¯å’Œæ•°å­—ï¼Œå› æ­¤å®ƒçš„ç¢°æ’æ¬¡æ•°å˜é«˜</p></li><li><p>NamedTemporaryFile è™½ç„¶ä¹Ÿç”¨çš„random.choicesï¼Œä½†æ˜¯ä½¿ç”¨äº†è¿­ä»£å™¨çš„å½¢å¼ï¼Œé€Ÿåº¦å˜æ…¢ï¼ˆæœ‰å¾…è¿›ä¸€æ­¥æµ‹è¯•ï¼‰</p></li><li><p>ä¼˜é€‰random.choices å’Œ secrets.choiceçš„æ–¹å¼</p></li></ul><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>[1] <a href="https://stackoverflow.com/questions/13484726/safe-enough-8-character-short-unique-random-string/55890039#55890039">python - safe enough 8-character short unique random string - Stack Overflow</a></p><p>[2] <a href="https://github.com/python/cpython/blob/b3ab4344d11edd890916be3526b07362182fb172/Lib/tempfile.py#L128">cpython/tempfile.py at b3ab4344d11edd890916be3526b07362182fb172 Â· python/cpython (github.com)</a></p>]]></content>
    
    
    <summary type="html">ä»‹ç»å‡ ç§ç”ŸæˆçŸ­éšæœºæ•°çš„æ–¹æ³•</summary>
    
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
    <category term="éšæœºæ•°" scheme="https://blog.smart-lifestyle.cn/tags/%E9%9A%8F%E6%9C%BA%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Apple M1 python3.9ä¸Šå®‰è£…psycopg2</title>
    <link href="https://blog.smart-lifestyle.cn/posts/6e90/"/>
    <id>https://blog.smart-lifestyle.cn/posts/6e90/</id>
    <published>2021-09-28T16:36:04.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨MacBook M1ä¸Šä½¿ç”¨ pip install psycopg2æ—¶ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯</p><p><code>Error: pg_config executable not found</code></p><p><img src="https://oss.smart-lifestyle.cn/file/dcn67.png" alt="BA27CAD4-A8E8-4216-A7C6-BEB0B0DEADBC"></p><p>æ˜¯å› ä¸ºç›®å‰pipæºé‡Œç›®æ ‡æ²¡æœ‰ARMç‰ˆæœ¬çš„psycopg2ï¼Œéœ€è¦è¿›è¡Œæ‰‹åŠ¨ç¼–è¯‘æ‰å¯ä»¥ç”¨</p><p><img src="https://oss.smart-lifestyle.cn/file/itzxs.png" alt="D0DACCD0-12AD-4CA6-B93B-1182C36F0D9A"></p><ul><li><p>å®‰è£…postgresql</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install postgresql</span><br></pre></td></tr></table></figure></li><li><p>å†æ¬¡æ‰§è¡Œpip installå³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install psycopg2</span><br></pre></td></tr></table></figure></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://github.com/psycopg/psycopg2/issues/1286">psycopg2-binary support for M1 chipset Â· Issue #1286 Â· psycopg/psycopg2 (github.com)</a></p>]]></content>
    
    
    <summary type="html">åœ¨Apple M1åšpythonå¼€å‘ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘psycopg2</summary>
    
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
    <category term="psycopg2" scheme="https://blog.smart-lifestyle.cn/tags/psycopg2/"/>
    
  </entry>
  
  <entry>
    <title>pythonæ ¡éªŒurlçš„å®Œæ•´æ€§</title>
    <link href="https://blog.smart-lifestyle.cn/posts/2c0e/"/>
    <id>https://blog.smart-lifestyle.cn/posts/2c0e/</id>
    <published>2021-09-28T10:55:30.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æŠ“å–é“¾æ¥ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å¯¹é“¾æ¥è¿›è¡Œæ¸…æ´—ï¼ŒæŠŠæ ¼å¼ä¸æ­£ç¡®çš„é“¾æ¥å»é™¤ï¼Œä»¥ä¾¿åé¢æ•°æ®æŠ“å–</p><ul><li><a href="https://www.baidu.com/">https://www.baidu.com</a> âœ…</li><li>httpz://<a href="http://www.baidu.com/">www.baidu.com</a> âŒ</li><li># âŒ</li><li><a href="ftp://a.com/file/1111">ftp://a.com/file/1111</a> âœ… </li></ul><p>ä»¥ä¸‹æ€»ç»“ä¸¤ç§æ–¹å¼æ¥åˆ¤æ–­urlçš„å®Œæ•´æ€§</p><h3 id="é€šè¿‡python-urlparseåº“æ¥å®ç°"><a href="#é€šè¿‡python-urlparseåº“æ¥å®ç°" class="headerlink" title="é€šè¿‡python urlparseåº“æ¥å®ç°"></a>é€šè¿‡python urlparseåº“æ¥å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™ç§æ²¡æœ‰åè®®å¤´çš„ï¼Œæ— æ³•è¿”å›åè®®å¤´ï¼Œä»¥åŠç½‘ç»œä½ç½®ï¼ŒæŠŠå®é™…çš„ç½‘ç»œä½ç½®å®šä¹‰ä¸ºäº†è·¯å¾„éƒ¨åˆ†</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>urlparse(<span class="string">&#x27;www.baidu.com&#x27;</span>)</span><br><span class="line">ParseResult(scheme=<span class="string">&#x27;&#x27;</span>, netloc=<span class="string">&#x27;&#x27;</span>, path=<span class="string">&#x27;www.baidu.com&#x27;</span>, params=<span class="string">&#x27;&#x27;</span>, query=<span class="string">&#x27;&#x27;</span>, fragment=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># æ­£ç¡®è¯†åˆ«åˆ°urlåè®®ï¼Œä»¥åŠç½‘ç»œä½ç½®</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>urlparse(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">ParseResult(scheme=<span class="string">&#x27;https&#x27;</span>, netloc=<span class="string">&#x27;www.baidu.com&#x27;</span>, path=<span class="string">&#x27;&#x27;</span>, params=<span class="string">&#x27;&#x27;</span>, query=<span class="string">&#x27;&#x27;</span>, fragment=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># ä¸€ä¸ª # è¿”å›ä¸€ä¸ªâ€˜ç©ºâ€™å¯¹è±¡</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>urlparse(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">ParseResult(scheme=<span class="string">&#x27;&#x27;</span>, netloc=<span class="string">&#x27;&#x27;</span>, path=<span class="string">&#x27;&#x27;</span>, params=<span class="string">&#x27;&#x27;</span>, query=<span class="string">&#x27;&#x27;</span>, fragment=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½†æ˜¯å‘è¿™ç§æ ¼å¼æ­£ç¡®ï¼Œä½†æ˜¯urlåè®®å¤´ä¸å¯¹çš„ï¼Œè™½ç„¶èƒ½è§£æï¼Œä½†æ˜¯ä¸ä¼šæç¤ºé”™è¯¯</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>urlparse(<span class="string">&#x27;ssp://www.baidu.com&#x27;</span>)</span><br><span class="line">ParseResult(scheme=<span class="string">&#x27;ssp&#x27;</span>, netloc=<span class="string">&#x27;www.baidu.com&#x27;</span>, path=<span class="string">&#x27;&#x27;</span>, params=<span class="string">&#x27;&#x27;</span>, query=<span class="string">&#x27;&#x27;</span>, fragment=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>urlparseçš„åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¤šç§åè®®æ ¼å¼çš„è§£æ</p><p>ä¸‹é¢çš„ä¾‹å­å°†ç”¨æˆ·åã€å¯†ç ã€æœåŠ¡å™¨åœ°å€ã€ç«¯å£ç­‰å…¨éƒ¨è§£æå‡ºæ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; data = urlparse(<span class="string">&#x27;wss://username:password@192.168.1.1:90/s/data#video1&#x27;</span>)</span><br><span class="line">&gt;&gt;&gt; data.username</span><br><span class="line"><span class="string">&#x27;username&#x27;</span></span><br><span class="line">&gt;&gt;&gt; data.password</span><br><span class="line"><span class="string">&#x27;password&#x27;</span></span><br><span class="line">&gt;&gt;&gt; data.port</span><br><span class="line">90</span><br><span class="line">&gt;&gt;&gt; data.hostname</span><br><span class="line"><span class="string">&#x27;192.168.1.1&#x27;</span></span><br><span class="line"><span class="comment"># netlocè§£æèŒƒå›´åº”è¯¥æ˜¯//.../ä¸­é—´çš„å†…å®¹</span></span><br><span class="line">&gt;&gt;&gt; data.netloc</span><br><span class="line"><span class="string">&#x27;username:password@192.168.1.1:90&#x27;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯ç”¨æ¥è§£æhttp(s)ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"></span><br><span class="line">myurl = <span class="string">&#x27;https://smart-lifestyle.cn/404.html&#x27;</span></span><br><span class="line">ret = urlparse(myurl)</span><br><span class="line"><span class="keyword">if</span> ret.scheme <span class="keyword">in</span> (<span class="string">&#x27;https&#x27;</span>, <span class="string">&#x27;http&#x27;</span>) <span class="keyword">and</span> ret.netloc:</span><br><span class="line">  fetch_data(url)</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line">  <span class="keyword">raise</span> Exception(<span class="string">&#x27;URL is not vaild&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="é€šè¿‡æ­£åˆ™è¡¨è¾¾åŒ¹é…æ¥å®ç°"><a href="#é€šè¿‡æ­£åˆ™è¡¨è¾¾åŒ¹é…æ¥å®ç°" class="headerlink" title="é€šè¿‡æ­£åˆ™è¡¨è¾¾åŒ¹é…æ¥å®ç°"></a>é€šè¿‡æ­£åˆ™è¡¨è¾¾åŒ¹é…æ¥å®ç°</h3><p>ä¹Ÿå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å®ç°è‡ªå·±çš„è§£æåŠŸèƒ½ï¼Œæ¯”å¦‚æˆ‘ä»¬åªåˆ¤æ–­httpå’Œhttpsçš„urlæ ¼å¼ï¼Œå¯ä»¥è¿™ä¹ˆåš</p><p>è¿™é‡Œå‚è€ƒäº†<a href="https://github.com/django/django/blob/main/django/core/validators.py#L74">Django</a>çš„ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">ipv4_re = <span class="string">r&#x27;(?:0|25[0-5]|2[0-4]\d|1\d?\d?|[1-9]\d?)(?:\.(?:0|25[0-5]|2[0-4]\d|1\d?\d?|[1-9]\d?))&#123;3&#125;&#x27;</span></span><br><span class="line">ipv6_re = <span class="string">r&#x27;\[[0-9a-f:.]+\]&#x27;</span></span><br><span class="line">ul = <span class="string">&#x27;\u00a1-\uffff&#x27;</span></span><br><span class="line">domain_re = <span class="string">r&#x27;(?:\.(?!-)[a-z&#x27;</span> + ul + <span class="string">r&#x27;0-9-]&#123;1,63&#125;(?&lt;!-))*&#x27;</span></span><br><span class="line">tld_re = (</span><br><span class="line">        <span class="string">r&#x27;\.&#x27;</span>                                <span class="comment"># dot</span></span><br><span class="line">        <span class="string">r&#x27;(?!-)&#x27;</span>                             <span class="comment"># can&#x27;t start with a dash</span></span><br><span class="line">        <span class="string">r&#x27;(?:[a-z&#x27;</span> + ul + <span class="string">&#x27;-]&#123;2,63&#125;&#x27;</span>         <span class="comment"># domain label</span></span><br><span class="line">        <span class="string">r&#x27;|xn--[a-z0-9]&#123;1,59&#125;)&#x27;</span>              <span class="comment"># or punycode label</span></span><br><span class="line">        <span class="string">r&#x27;(?&lt;!-)&#x27;</span>                            <span class="comment"># can&#x27;t end with a dash</span></span><br><span class="line">        <span class="string">r&#x27;\.?&#x27;</span>                               <span class="comment"># may have a trailing dot</span></span><br><span class="line">    )</span><br><span class="line">hostname_re = <span class="string">r&#x27;[a-z&#x27;</span> + ul + <span class="string">r&#x27;0-9](?:[a-z&#x27;</span> + ul + <span class="string">r&#x27;0-9-]&#123;0,61&#125;[a-z&#x27;</span> + ul + <span class="string">r&#x27;0-9])?&#x27;</span></span><br><span class="line">host_re = <span class="string">&#x27;(&#x27;</span> + hostname_re + domain_re + tld_re + <span class="string">&#x27;|localhost)&#x27;</span></span><br><span class="line">regex = re.<span class="built_in">compile</span>(</span><br><span class="line">        <span class="string">r&#x27;^(?:[a-z0-9.+-]*)://&#x27;</span>  <span class="comment"># scheme is validated separately</span></span><br><span class="line">        <span class="string">r&#x27;(?:[^\s:@/]+(?::[^\s:@/]*)?@)?&#x27;</span>  <span class="comment"># user:pass authentication</span></span><br><span class="line">        <span class="string">r&#x27;(?:&#x27;</span> + ipv4_re + <span class="string">&#x27;|&#x27;</span> + ipv6_re + <span class="string">&#x27;|&#x27;</span> + host_re + <span class="string">&#x27;)&#x27;</span></span><br><span class="line">        <span class="string">r&#x27;(?::\d&#123;1,5&#125;)?&#x27;</span>  <span class="comment"># port</span></span><br><span class="line">        <span class="string">r&#x27;(?:[/?#][^\s]*)?&#x27;</span>  <span class="comment"># resource path</span></span><br><span class="line">        <span class="string">r&#x27;\Z&#x27;</span>, re.IGNORECASE)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    url1 = <span class="string">&#x27;https://www.baidu.com&#x27;</span></span><br><span class="line">    url2 = <span class="string">&#x27;http://www.baidu.com&#x27;</span></span><br><span class="line">    url3 = <span class="string">&#x27;ht:/www.baidu.com&#x27;</span></span><br><span class="line">    url4 = <span class="string">&#x27;www.baidu.com&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(regex.match(url1))</span><br><span class="line">    <span class="built_in">print</span>(regex.match(url2))</span><br><span class="line">    <span class="built_in">print</span>(regex.match(url3))</span><br><span class="line">    <span class="built_in">print</span>(regex.match(url4))</span><br></pre></td></tr></table></figure><p>è¿”å›ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;re.Match object; span=(0, 21), match=<span class="string">&#x27;https://www.baidu.com&#x27;</span>&gt;</span><br><span class="line">&lt;re.Match object; span=(0, 20), match=<span class="string">&#x27;http://www.baidu.com&#x27;</span>&gt;</span><br><span class="line">None</span><br><span class="line">None</span><br><span class="line">[Finished <span class="keyword">in</span> 78ms]</span><br></pre></td></tr></table></figure><p>åœ¨Djangoçš„ä»£ç é‡Œï¼Œå¯¹äºurlåè®®ç±»å‹çš„åˆ¤æ–­å®ƒæ²¡æœ‰é›†æˆåˆ°è¿™ä¸ªæ­£åˆ™åŒ¹é…ä¸­ï¼Œè€Œæ˜¯å…ˆåˆ¤æ–­urlåè®®ï¼Œå†è§£ææ ¼å¼ï¼Œè¿™æ ·ä»–å¯ä»¥çµæ´»å®šä¹‰æ”¯æŒå“ªäº›urlåè®®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">schemes = [<span class="string">&#x27;http&#x27;</span>, <span class="string">&#x27;https&#x27;</span>, <span class="string">&#x27;ftp&#x27;</span>, <span class="string">&#x27;ftps&#x27;</span>]</span><br><span class="line"><span class="comment"># Check if the scheme is valid.</span></span><br><span class="line">scheme = value.split(<span class="string">&#x27;://&#x27;</span>)[<span class="number">0</span>].lower()</span><br><span class="line"><span class="keyword">if</span> scheme <span class="keyword">not</span> <span class="keyword">in</span> self.schemes:</span><br><span class="line">    <span class="keyword">raise</span> ValidationError(self.message, code=self.code, params=&#123;<span class="string">&#x27;value&#x27;</span>: value&#125;)</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>[1] <a href="https://docs.python.org/3.0/library/urllib.parse.html">urllib.parse â€” Parse URLs into components â€” Python v3.0.1 documentation</a></p><p>[2] <a href="https://github.com/django/django/blob/main/django/core/validators.py#L74">django/validators.py at main Â· django/django (github.com)</a></p>]]></content>
    
    
    <summary type="html">æ ¡éªŒurlæ˜¯å¦å®Œæ•´ï¼Œæ¯”å¦‚http(s)://www.baidu.com</summary>
    
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
    <category term="urlparse" scheme="https://blog.smart-lifestyle.cn/tags/urlparse/"/>
    
    <category term="æ­£åˆ™è¡¨è¾¾" scheme="https://blog.smart-lifestyle.cn/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE/"/>
    
  </entry>
  
  <entry>
    <title>macä¸‹git statusä¸­æ–‡ä¹±ç </title>
    <link href="https://blog.smart-lifestyle.cn/posts/a13/"/>
    <id>https://blog.smart-lifestyle.cn/posts/a13/</id>
    <published>2021-09-22T09:18:47.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>æ–‡ä»¶åå­—æ˜¯ä¸­æ–‡æ—¶ï¼Œmacä¸‹æ‰§è¡Œgit statuså‘½ä»¤æŸ¥çœ‹çŠ¶æ€æ—¶ï¼Œä¼šæ˜¾ç¤ºä¸€å †unicodeç¼–ç çš„å­—ç¬¦ï¼Œä¸ä¾¿äºæŸ¥çœ‹ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹å¯¹äºå¤§äº0x80çš„æ–‡ä»¶è·¯å¾„å­—ç¬¦ä¼šè¿›è¡Œç¼–ç ï¼Œå¯ä»¥å°†<code>core.quotePath</code>è®¾ç½®ä¸ºfalseï¼Œæ¥å–æ¶ˆå¼ºåˆ¶ç¼–ç </p><p><img src="https://oss.smart-lifestyle.cn/file/ck0gv.png" alt="image-20210922093322918"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.quotepath <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/zym74.png" alt="image-20210922093348556"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://git-scm.com/docs/git-config">Git - git-config Documentation (git-scm.com)</a></p><p>[2] <a href="https://www.cnblogs.com/ayseeing/p/4268655.html">macä¸‹gitä¸­æ–‡ä¹±ç  - ç ´ç”·å­© - åšå®¢å›­ (cnblogs.com)</a></p>]]></content>
    
    
    <summary type="html">åœ¨macå‘½ä»¤è¡Œä¸‹ä¸­æ–‡ä¹±ç çš„é—®é¢˜</summary>
    
    
    
    <category term="å·¥å…·" scheme="https://blog.smart-lifestyle.cn/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
    <category term="git" scheme="https://blog.smart-lifestyle.cn/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>nodeæŸ¥çœ‹processæ¶æ„</title>
    <link href="https://blog.smart-lifestyle.cn/posts/163c/"/>
    <id>https://blog.smart-lifestyle.cn/posts/163c/</id>
    <published>2021-09-22T08:59:52.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>ç°åœ¨nodeçš„æ–°ç‰ˆæœ¬å·²ç»æ”¯æŒMacBook M1ï¼Œå³ARMç‰ˆæœ¬çš„nodeï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦è€ç‰ˆæœ¬çš„nodeï¼Œç›®å‰æˆ‘ä½¿ç”¨nvmå¯ä»¥åˆ‡æ¢nodeçš„ç‰ˆæœ¬ï¼Œ æŸ¥çœ‹å½“å‰nodeæ˜¯x64è¿˜æ˜¯ARMç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node -p <span class="string">&quot;process.arch&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/uw2au.png" alt="image-20210922090704217"></p>]]></content>
    
    
    <summary type="html">åœ¨MacBook M1æ¶æ„ä¸‹ä½¿ç”¨äº†å¤šç‰ˆæœ¬çš„nodeï¼Œé€šè¿‡node -p &quot;process.arch&quot;æŸ¥çœ‹å½“å‰nodeçš„ç¼–è¯‘æ¶æ„</summary>
    
    
    
    <category term="node" scheme="https://blog.smart-lifestyle.cn/categories/node/"/>
    
    
    <category term="å‰ç«¯" scheme="https://blog.smart-lifestyle.cn/tags/%E5%89%8D%E7%AB%AF/"/>
    
    <category term="node" scheme="https://blog.smart-lifestyle.cn/tags/node/"/>
    
  </entry>
  
  <entry>
    <title>github actions + serverless + hexo æ­å»ºåšå®¢</title>
    <link href="https://blog.smart-lifestyle.cn/posts/186f/"/>
    <id>https://blog.smart-lifestyle.cn/posts/186f/</id>
    <published>2021-09-10T23:26:08.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>2021å¹´9æœˆ21æ—¥ï¼šæ–°å¢404é¡µé¢çš„å±•ç¤º</p><p>20201å¹´9æœˆ10æ—¥ï¼šåŸºæœ¬åŠŸèƒ½</p></blockquote><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä»æœ€å¼€å§‹çš„ECSï¼ˆé˜¿é‡Œäº‘äº‘æœåŠ¡å™¨ï¼‰åˆ°åæ¥çš„è½»é‡åº”ç”¨æœåŠ¡å™¨ï¼Œéƒ½æ˜¯åœ¨ä¼´éšç€æ–°ç”¨æˆ·æ‰“æŠ˜çš„ä¼˜æƒ ä¸Šï¼Œç»­è´¹ä¸‹å»ï¼Œä½†æ˜¯æœ€è¿‘è½»é‡åº”ç”¨æœåŠ¡å™¨å™¨åˆ°æœŸäº†ï¼Œåœ¨æ²¡æœ‰å¤§ä¼˜æƒ çš„æƒ…å†µä¸‹ä¸€å¹´çš„è´¹ç”¨éœ€è¦600å¤šè½¯å¦¹å¸ï¼Œäºæ˜¯å¼€å§‹åŠ¨æ‰‹å°†åšå®¢éƒ¨ç½²åˆ°serverlessæœåŠ¡ä¸Šï¼ŒåŸºæœ¬ä¸Šå¯¹äºæˆ‘è¿™ç§è®¿é—®é‡æä½çš„åšä¸»æ¥è¯´ï¼Œè´¹ç”¨åŸºæœ¬æ¥è¿‘äº0</p><p><img src="https://oss.smart-lifestyle.cn/file/2z2j0.png" alt="image-20210911093216962"></p><h2 id="serverlessçš„é€‰æ‹©"><a href="#serverlessçš„é€‰æ‹©" class="headerlink" title="serverlessçš„é€‰æ‹©"></a>serverlessçš„é€‰æ‹©</h2><p>ç»è¿‡å¯¹æ¯”ï¼Œé€‰æ‹©äº†è…¾è®¯äº‘çš„<a href="https://console.cloud.tencent.com/sls">Serverlessåº”ç”¨</a>ï¼Œæœ¬èº«åšå®¢çš„å†…å®¹éƒ½æ˜¯é™æ€æ–‡ä»¶ï¼Œè€Œä¸”è…¾è®¯ä¹Ÿæ˜¯å°†é™æ€ç½‘ç«™æ‰˜ç®¡åˆ°å®ƒçš„å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸Šã€‚è™½ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨å¯¹è±¡å­˜å‚¨ç›´æ¥æ‰˜ç®¡ï¼Œä½†æ˜¯è…¾è®¯äº‘çš„Serverlessåº”ç”¨åœ¨éƒ¨ç½²ä¸Šæä¾›äº†ä»£ç æ‰˜ç®¡æ–¹å¼ï¼Œæ£€æµ‹åˆ°ä»£ç åˆ†æ”¯ä¸Šçš„å˜åŠ¨ï¼Œä¼šè‡ªåŠ¨è§¦å‘æ„å»º</p><p><img src="https://oss.smart-lifestyle.cn/file/by7fr.png" alt="image-20210911095143015"></p><p>ä¸‹é¢å¼€å¹²ï¼</p><h2 id="æ­å»ºè¿‡ç¨‹"><a href="#æ­å»ºè¿‡ç¨‹" class="headerlink" title="æ­å»ºè¿‡ç¨‹"></a>æ­å»ºè¿‡ç¨‹</h2><h3 id="å¼€é€šserverlessåº”ç”¨ï¼Œå»ºç«™"><a href="#å¼€é€šserverlessåº”ç”¨ï¼Œå»ºç«™" class="headerlink" title="å¼€é€šserverlessåº”ç”¨ï¼Œå»ºç«™"></a>å¼€é€šserverlessåº”ç”¨ï¼Œå»ºç«™</h3><p>æ–°å»ºåº”ç”¨</p><p><img src="https://oss.smart-lifestyle.cn/file/bifuy.png" alt="image-20210911100249575"></p><p>é€‰æ‹©å¿«é€Ÿéƒ¨ç½²ä¸€ä¸ªWebsiteé™æ€ç½‘ç«™</p><p><img src="https://oss.smart-lifestyle.cn/file/1i7ek.png" alt="image-20210911100406421"></p><p>å¼€å¯è·¨åŸŸè®¿é—®é…ç½®ï¼ˆå¦‚æœä½ çš„ç½‘ç«™è®¿é—®ç¬¬ä¸‰æ–¹èµ„æºï¼‰</p><p><img src="https://oss.smart-lifestyle.cn/file/4q9e7.png" alt="image-20210911100923927"></p><p>å…¶ä»–æŒ‰ç…§æµç¨‹ç‚¹å‡»ä¸‹ä¸€æ­¥æ‰§è¡Œå°±å¯ä»¥</p><p>å®Œæˆä¹‹åï¼Œç‚¹å‡»è®¿é—®åœ°å€å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç®€å•çš„Demoé¡µé¢ã€‚åŒæ—¶ä¹Ÿåœ¨å¯¹è±¡å‚¨å­˜ä¸­åˆ›å»ºäº†ä¸€ä¸ªè·Ÿç½‘å€å‰ç¼€ä¸€æ ·çš„å­˜å‚¨æ¡¶ï¼ˆè¿™ä¸ªåœ°å€å°±æ˜¯å¯¹è±¡å­˜å‚¨é™æ€ç½‘ç«™åŠŸèƒ½æä¾›çš„ï¼‰</p><p><img src="https://oss.smart-lifestyle.cn/file/xsnza.png" alt="image-20210911101411755"></p><h3 id="ç»‘å®šåŸŸåå’Œè¯ä¹¦"><a href="#ç»‘å®šåŸŸåå’Œè¯ä¹¦" class="headerlink" title="ç»‘å®šåŸŸåå’Œè¯ä¹¦"></a>ç»‘å®šåŸŸåå’Œè¯ä¹¦</h3><p>è¿™é‡Œå…ˆä¸ç€æ€¥å»éƒ¨ç½²æˆ‘ä»¬çš„ç½‘ç«™å†…å®¹ï¼Œå…ˆå»ç»‘å®šæˆ‘ä»¬è‡ªå·±çš„åŸŸåä»¥åŠhttpsè¯ä¹¦ï¼Œè¦ä¸ç„¶ä½ çš„åšå®¢åªèƒ½é€šè¿‡è…¾è®¯å¯¹è±¡å­˜å‚¨æä¾›çš„ä¸€ä¸ªå››çº§åŸŸåå»è®¿é—®</p><h4 id="ç»‘å®šåŸŸå"><a href="#ç»‘å®šåŸŸå" class="headerlink" title="ç»‘å®šåŸŸå"></a>ç»‘å®šåŸŸå</h4><p>ç»‘å®šåŸŸåä¹‹å‰ç¬¬ä¸€æ˜¯ä½ å¿…é¡»æœ‰è‡ªå·±çš„åŸŸåï¼Œå„ä¸ªäº‘å‚å•†åŸºæœ¬éƒ½æä¾›åŸŸåæ³¨å†ŒæœåŠ¡ï¼Œè¿™é‡Œæ³¨å†Œè¿‡ç¨‹ä¸å†ä»‹ç»ï¼Œç¬¬äºŒæ˜¯åŸŸåéœ€è¦å¤‡æ¡ˆï¼Œå¦åˆ™ä¹Ÿæ— æ³•ç»‘å®šæˆåŠŸ</p><p><img src="https://oss.smart-lifestyle.cn/file/7tuxq.png" alt="image-20210911102552375"></p><p>åœ¨å¯¹è±¡å­˜å‚¨æœåŠ¡ä¸­ï¼Œæ‰¾åˆ°ä½ åšå®¢å¯¹åº”çš„æ¡¶</p><p><img src="https://oss.smart-lifestyle.cn/file/5a2pl.png" alt="image-20210911102232485"></p><p>ç‚¹å‡»è¿›å»ä¹‹åï¼Œé€‰æ‹©åŸŸåä¸ä¼ è¾“ç®¡ç†ä¸­çš„è‡ªå®šä¹‰æºç«™åŸŸå</p><p><img src="https://oss.smart-lifestyle.cn/file/66q6f.png" alt="image-20210911102349968"></p><p>åœ¨è‡ªå®šä¹‰æºç«™åŸŸåä¸­æ·»åŠ åŸŸå</p><p><img src="https://oss.smart-lifestyle.cn/file/p9c2k.png" alt="image-20210911102725447"></p><p>åŒæ—¶ï¼Œä½ ä¹Ÿéœ€è¦åœ¨ä½ åŸŸåæœåŠ¡å•†é‚£é‡Œå¢åŠ ä¸€é¡¹CNAMEè§£æ</p><p><img src="https://oss.smart-lifestyle.cn/file/fbz1o.png" alt="image-20210911103016315"></p><p>è¿™æ˜¯ä½ é€šè¿‡http://è‡ªå®šä¹‰åŸŸåå¯ä»¥è®¿é—®åˆ°ä½ çš„ç½‘ç«™</p><h4 id="ç»‘å®šè¯ä¹¦"><a href="#ç»‘å®šè¯ä¹¦" class="headerlink" title="ç»‘å®šè¯ä¹¦"></a>ç»‘å®šè¯ä¹¦</h4><p>å¦‚æœä½ ä¸éœ€è¦è®©ç”¨æˆ·é€šè¿‡httpsè®¿é—®ä½ çš„åšå®¢ï¼Œé‚£å¯ä»¥å¿½ç•¥æœ¬èŠ‚ï¼Œä½†æ˜¯å¼ºçƒˆå»ºè®®å¼€å¯httpsï¼Œæ¯•ç«Ÿå®‰å…¨åˆå…è´¹ï¼Œå¯ä»¥åœ¨è¿™ä¸ª<a href="https://freessl.cn/">ç½‘ç«™</a>ä¸Šç”³è¯·å…è´¹çš„è¯ä¹¦ã€‚æ‹¿åˆ°è¯ä¹¦ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ä¹‹åï¼Œ ç‚¹å‡»ç»‘å®šè¯ä¹¦ï¼Œå¦‚æœä½ ä¸æ˜¯åœ¨è…¾è®¯äº‘ç”³è¯·çš„è¯ä¹¦ï¼Œé€‰æ‹©è‡ªæœ‰è¯ä¹¦ï¼Œå°†å…¬é’¥ã€ç§é’¥ç²˜è´´è¿›å»å°±å¯ä»¥ã€‚è…¾è®¯äº‘è¯ä¹¦ç›´æ¥åœ¨è¯ä¹¦åˆ—è¡¨é€‰æ‹©å°±å¯ä»¥</p><p><img src="https://oss.smart-lifestyle.cn/file/yasz4.png" alt="image-20210911103552585"></p><p>ä»¥ä¸Šæ“ä½œå®Œæˆä¹‹åï¼Œå¦‚æœä½ é€šè¿‡https://ä½ çš„åšå®¢åŸŸåï¼Œè®¿é—®è¿˜æ˜¯æ˜¾ç¤ºçš„æ²¡æœ‰è¯ä¹¦ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯å°†httpsçš„è®¿é—®é‡æ–°å®šå‘å›äº†httpï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹å‚¨å­˜æ¡¶çš„é…ç½®æ‰å¯ä»¥ä½¿ç”¨https</p><p>åœ¨é™æ€ç½‘ç«™é…ç½®ä¸­ï¼Œä½¿èƒ½å¼ºåˆ¶HTTPSï¼Œé»˜è®¤æ²¡æœ‰ä½¿èƒ½</p><p><img src="https://oss.smart-lifestyle.cn/file/xg2x7.png" alt="image-20210911104131084"></p><p>æ­¤æ—¶å†é€šè¿‡https://ä½ çš„åšå®¢åŸŸåå°±å¯ä»¥è®¿é—®åˆ°ä½ çš„åšå®¢ï¼ˆå¯èƒ½éœ€è¦æ‰‹åŠ¨æ¸…é™¤ä¸€ä¸‹ç¼“å­˜ï¼Œæˆ–è€…å¼€å¯ä¸€ä¸ªæµè§ˆå™¨éšç§çª—å£ï¼‰</p><h2 id="éƒ¨ç½²hexoåšå®¢"><a href="#éƒ¨ç½²hexoåšå®¢" class="headerlink" title="éƒ¨ç½²hexoåšå®¢"></a>éƒ¨ç½²hexoåšå®¢</h2><p>å¤§è‡´æµç¨‹ä¸ºï¼šä½¿ç”¨githubç®¡ç†æºç ï¼ˆmdæ–‡ä»¶ï¼‰ï¼Œå¹¶é€šè¿‡github actionså°†hexoå†…å®¹ç¼–è¯‘ä¸ºé™æ€æ–‡ä»¶ï¼Œå¹¶æ¨é€åˆ°æ–°çš„åˆ†æ”¯gh_pagesï¼Œåœ¨è…¾è®¯äº‘Serverlessåº”ç”¨é‚£é‡Œï¼Œä¼šç›‘æµ‹gh_pagesï¼Œè‡ªåŠ¨æ„å»º</p><p><img src="https://oss.smart-lifestyle.cn/file/2vses.png" alt="æµç¨‹"></p><h3 id="github-actionså®ç°"><a href="#github-actionså®ç°" class="headerlink" title="github actionså®ç°"></a>github actionså®ç°</h3><p>æ–°å»ºä¸€ä¸ªworkflow</p><p><img src="https://oss.smart-lifestyle.cn/file/zb5z8.png" alt="image-20210911120703454"></p><p>å…·ä½“å®ç°å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is a basic workflow to help you get started with Actions</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">build</span> <span class="string">and</span> <span class="string">publish</span> <span class="string">gh-pages</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Controls when the workflow will run</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="comment"># Triggers the workflow on push or pull request events but only for the master branch</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">master</span> ]</span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">master</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Allows you to run this workflow manually from the Actions tab</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="comment"># This workflow contains a single job called &quot;build&quot;</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="comment"># The type of runner that the job will run on</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Steps represent a sequence of tasks that will be executed as part of the job</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">setup</span> <span class="string">node</span> <span class="string">version</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;12.x&#x27;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># Caching dependencies to speed up workflows. (GitHub will remove any cache entries that have not been accessed in over 7 days.)</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> <span class="string">hexo-cli</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">-g</span> <span class="string">hexo-cli</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">node</span> <span class="string">modules</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-node-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-node-</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Dependencies</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm ci</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">generate</span> <span class="string">public</span> <span class="string">tatic</span> <span class="string">files</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">robots.txt</span> <span class="string">to</span> <span class="string">public</span> <span class="string">directory</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">cp</span> <span class="string">robots.txt</span> <span class="string">./public</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">push</span> <span class="string">public</span> <span class="string">to</span> <span class="string">gh-pages</span> <span class="string">branch</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">REMOTE_REPO:</span> <span class="string">https://$&#123;&#123;</span> <span class="string">secrets.GIT_TOKEN</span> <span class="string">&#125;&#125;@github.com/$&#123;&#123;</span> <span class="string">secrets.GIT_REPOSITORY</span> <span class="string">&#125;&#125;.git</span></span><br><span class="line">          <span class="attr">REMOTE_BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd ./public &amp;&amp; git init &amp;&amp; git add .</span></span><br><span class="line"><span class="string">          git config user.name &quot;$&#123;&#123; secrets.GIT_USERNAME &#125;&#125;&quot;</span></span><br><span class="line"><span class="string">          git config user.email &quot;$&#123;&#123; secrets.GIT_USEREMAIL &#125;&#125;&quot;</span></span><br><span class="line"><span class="string">          echo -n &#x27;Files to Commit:&#x27; &amp;&amp; ls -l | wc -l</span></span><br><span class="line"><span class="string">          git commit -m &quot;github actions build at $(TZ=ANY-8 date +&#x27;%Y-%m-%d %H:%M:%S&#x27;)&quot; &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line"><span class="string">          git push --force $REMOTE_REPO master:$REMOTE_BRANCH &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">deploy</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          echo build successfully, now you can redeploy your website</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      </span><br><span class="line">          </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>stepsä¸­åŒ…æ‹¬å¦‚ä¸‹actions</p><ol><li><p>actions/checkout@v2 </p><p>è·å–masteråˆ†æ”¯ä»£ç </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br></pre></td></tr></table></figure></li><li><p>actions/setup-node@v2</p><p>å®‰è£…nodeï¼Œç‰ˆæœ¬ä¸º12.x</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">setup</span> <span class="string">node</span> <span class="string">version</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;12.x&#x27;</span></span><br></pre></td></tr></table></figure></li><li><p>npm install -g hexo-cli</p><p>å®‰è£…hexo cli</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">install</span> <span class="string">hexo-cli</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">-g</span> <span class="string">hexo-cli</span></span><br></pre></td></tr></table></figure></li><li><p>actions/cache@v1 | npm ci</p><p>å®‰è£…npmä¾èµ–åŒ…ï¼Œå¹¶ä½¿èƒ½ç¼“å­˜</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">node</span> <span class="string">modules</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-node-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-node-</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">Dependencies</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">npm</span> <span class="string">ci</span></span><br></pre></td></tr></table></figure></li><li><p>hexo clean | hexo g</p><p>æ¸…ç©ºå¹¶éƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">generate</span> <span class="string">public</span> <span class="string">tatic</span> <span class="string">files</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">         hexo clean</span></span><br><span class="line"><span class="string">         hexo g</span></span><br></pre></td></tr></table></figure></li><li><p>cp robots.txt ./public</p><p>å°†è‡ªå®šä¹‰é™åˆ¶çˆ¬è™«æ–‡ä»¶å¤åˆ¶åˆ°publicå³ç”Ÿæˆçš„é™æ€æ–‡ä»¶çš„æ–‡ä»¶å¤¹ä¸­</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">robots.txt</span> <span class="string">to</span> <span class="string">public</span> <span class="string">directory</span></span><br><span class="line">       <span class="attr">run:</span> <span class="string">cp</span> <span class="string">robots.txt</span> <span class="string">./public</span></span><br></pre></td></tr></table></figure></li><li><p>å°†ä»£ç æ¨é€åˆ°gh-pagesåˆ†æ”¯</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">push</span> <span class="string">public</span> <span class="string">to</span> <span class="string">gh-pages</span> <span class="string">branch</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">REMOTE_REPO:</span> <span class="string">https://$&#123;&#123;</span> <span class="string">secrets.GIT_TOKEN</span> <span class="string">&#125;&#125;@github.com/$&#123;&#123;</span> <span class="string">secrets.GIT_REPOSITORY</span> <span class="string">&#125;&#125;.git</span></span><br><span class="line">          <span class="attr">REMOTE_BRANCH:</span> <span class="string">gh-pages</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd ./public &amp;&amp; git init &amp;&amp; git add .</span></span><br><span class="line"><span class="string">          git config user.name &quot;$&#123;&#123; secrets.GIT_USERNAME &#125;&#125;&quot;</span></span><br><span class="line"><span class="string">          git config user.email &quot;$&#123;&#123; secrets.GIT_USEREMAIL &#125;&#125;&quot;</span></span><br><span class="line"><span class="string">          echo -n &#x27;Files to Commit:&#x27; &amp;&amp; ls -l | wc -l</span></span><br><span class="line"><span class="string">          git commit -m &quot;github actions build at $(TZ=ANY-8 date +&#x27;%Y-%m-%d %H:%M:%S&#x27;)&quot; &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line"><span class="string">          git push --force $REMOTE_REPO master:$REMOTE_BRANCH &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">deploy</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">build</span> <span class="string">successfully,</span> <span class="string">now</span> <span class="string">you</span> <span class="string">can</span> <span class="string">redeploy</span> <span class="string">your</span> <span class="string">website</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢æ¶‰åŠåˆ°çš„secretå˜é‡å¯ä»¥åœ¨ï¼Œä»£ç ä»“åº“secretsä¸­æ·»åŠ </p><p><img src="https://oss.smart-lifestyle.cn/file/buzmw.png" alt="image-20210911121933711"></p><p>â€‹    </p><p>è¡¥å……ï¼š</p><p><code>$(TZ=ANY-8 date +&#39;%Y-%m-%d %H:%M:%S&#39;)</code> github actioné»˜è®¤æ—¶åŒºä¸ºUTCæ—¶é—´ï¼Œè¿™æ˜¯TZ=ANY-8å°†æ—¶åŒºå˜ä¸ºUCT8æ—¶é—´</p><p>â€‹    </p></li></ol><h3 id="åœ¨Serverlessä¸­é…ç½®ä»£ç æ‰˜ç®¡"><a href="#åœ¨Serverlessä¸­é…ç½®ä»£ç æ‰˜ç®¡" class="headerlink" title="åœ¨Serverlessä¸­é…ç½®ä»£ç æ‰˜ç®¡"></a>åœ¨Serverlessä¸­é…ç½®ä»£ç æ‰˜ç®¡</h3><p>åœ¨å¼€å‘éƒ¨ç½²ä¸­é€‰æ‹©ä»£ç æ‰˜ç®¡ï¼Œé€‰æ‹©githubï¼ˆéœ€è¦æˆæƒä»£ç æºï¼‰ï¼Œç„¶åé€‰æ‹©blogä»“åº“çš„gh-pagesåˆ†æ”¯ï¼Œé€‰æ‹©è‡ªåŠ¨è§¦å‘æ„å»º</p><p><img src="https://oss.smart-lifestyle.cn/file/x1n8d.png" alt="image-20210911122509404"></p><p>è¿™æ ·æˆ‘ä»¬çš„å·¥ä½œæµå°±é…ç½®å®Œäº†</p><h2 id="404é¡µé¢"><a href="#404é¡µé¢" class="headerlink" title="404é¡µé¢"></a>404é¡µé¢</h2><ol><li><p>åœ¨hexoä¸­å¢åŠ 404.htmlï¼Œqq404.htmlæ–‡ä»¶ï¼Œæ”¾åœ¨sourceæ–‡ä»¶å¤¹ä¸‹é¢</p><p><img src="https://oss.smart-lifestyle.cn/file/j193w.png" alt="image-20210922000046337"></p><p>ä¸ºä»€ä¹ˆæ˜¯ä¸¤ä¸ª404æ–‡ä»¶ï¼Ÿqq404é‡Œé¢æ”¾çš„æ˜¯è…¾è®¯å…¬ç›Š404é¡µé¢ï¼Œä½†æ˜¯æˆ‘æƒ³åœ¨è¿™ä¸ªé¡µé¢ä¸Šå¢åŠ ä¸€ä¸ªè¿”å›æˆ‘çš„ä¸»é¡µçš„æŒ‰é’®ï¼Œéœ€è¦é€šè¿‡iframeåµŒå¥—è¿™ä¸ªè…¾è®¯404é¡µé¢ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><p>qq404.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, maximum-scale=2&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">homePageUrl</span>=<span class="string">&quot;https://blog.smart-lifestyle.cn/&quot;</span> <span class="attr">homePageName</span>=<span class="string">&quot;å›åˆ°æˆ‘çš„ä¸»é¡µ&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>404.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1, maximum-scale=2&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;theme-color&quot;</span> <span class="attr">content</span>=<span class="string">&quot;#222&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;generator&quot;</span> <span class="attr">content</span>=<span class="string">&quot;Hexo 5.4.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon&quot;</span> <span class="attr">sizes</span>=<span class="string">&quot;180x180&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/images/favicon.ico&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/png&quot;</span> <span class="attr">sizes</span>=<span class="string">&quot;32x32&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/images/favicon.ico&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/png&quot;</span> <span class="attr">sizes</span>=<span class="string">&quot;16x16&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/images/favicon-16x16.ico&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;mask-icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/images/favicon.ico&quot;</span> <span class="attr">color</span>=<span class="string">&quot;#222&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-tag">body</span> &#123;<span class="attribute">margin</span>:<span class="number">0</span>; <span class="attribute">padding</span>:<span class="number">0</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.button</span> &#123;<span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">10px</span>; <span class="attribute">border-radius</span>: <span class="number">4px</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.button</span><span class="selector-pseudo">:hover</span> &#123;<span class="attribute">background-color</span>: <span class="number">#222</span>; <span class="attribute">color</span>: <span class="number">#eee</span>; &#125;</span></span><br><span class="line"><span class="css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>simplezhaoçš„åšå®¢ - ä¸“æ³¨äºç‰©è”ç½‘æ¶æ„å’Œäº§å“<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  </span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;location.href=&#x27;https://blog.smart-lifestyle.cn&#x27;&quot;</span>&gt;</span>å›åˆ°æˆ‘çš„ä¸»é¡µ<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;./qq404.html&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;700&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>åœ¨hexo _config.ymlä¸­ä¿®æ”¹skip_renderï¼Œè‡ªåŠ¨ä»sourceæ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾ï¼Œæ‰€æœ‰ä¸è¦åŠ source</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">skip_render:</span> [<span class="number">404.</span><span class="string">html</span>, <span class="string">qq404.html</span>, <span class="string">&#x27;*.html&#x27;</span>, <span class="string">robots.txt</span>]</span><br></pre></td></tr></table></figure></li><li><p>åœ¨è…¾è®¯å¯¹è±¡å­˜å‚¨ï¼Œä¿å­˜ç½‘é¡µçš„æ¡¶ä¸­æ‰¾åˆ°é™æ€ç½‘ç«™çš„é…ç½®ï¼Œæ›´æ”¹é”™è¯¯æ–‡æ¡£ä¸º404.html</p><p><img src="https://oss.smart-lifestyle.cn/file/uv767.png" alt="image-20210922001015308"></p></li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ•´ä¸ªæµç¨‹é…ç½®å®Œä¹‹åï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å†™å®Œåšå®¢ï¼Œæäº¤åˆ°githubä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§æµæ°´çº¿è‡ªåŠ¨æ›´æ–°åœ¨çº¿åšå®¢ç½‘ç«™ã€‚</p><p><img src="https://oss.smart-lifestyle.cn/file/0jhjn.png" alt="image-20210911124903269"></p><p>ä¸€ç‚¹æ„Ÿæ‚Ÿï¼š</p><p>è…¾è®¯äº‘çš„Serverlessåº”ç”¨æ•´åˆäº†è‡ªå®¶çš„å„ç§æœåŠ¡ï¼Œæ¯”å¦‚å¯¹è±¡å­˜å‚¨çš„ç½‘ç«™æ‰˜ç®¡ã€è€Œä»£ç æ‰˜ç®¡ä½¿ç”¨çš„codingæ¥è·å–æˆæƒ</p><p><img src="https://oss.smart-lifestyle.cn/file/mub2b.png" alt="image-20210911003110757"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://github.com/marketplace/actions/hexo-action">Hexo Action Â· Actions Â· GitHub Marketplace</a></p><p>[2] <a href="https://github.com/BryanSchuetz/jekyll-deploy-gh-pages/blob/master/deploy/entrypoint.sh">jekyll-deploy-gh-pages/entrypoint.sh at master Â· BryanSchuetz/jekyll-deploy-gh-pages (github.com)</a></p><p>[3] <a href="https://github.com/NickSchimek/deploy_jamstack_action/blob/main/deploy.sh">deploy_jamstack_action/deploy.sh at main Â· NickSchimek/deploy_jamstack_action (github.com)</a></p><p>[4] <a href="https://zhuanlan.zhihu.com/p/161969042">ä½¿ç”¨ GitHub Actions è‡ªåŠ¨éƒ¨ç½² Hexo åšå®¢åˆ° GitHub Pages - çŸ¥ä¹ (zhihu.com)</a></p><p>[5] <a href="https://unix.stackexchange.com/questions/104088/why-does-tz-utc-8-produce-dates-that-are-utc8">timezone - Why does TZ=UTC-8 produce dates that are UTC+8? - Unix &amp; Linux Stack Exchange</a></p><p>[6] <a href="https://freessl.cn/">FreeSSLé¦–é¡µ - FreeSSL.cnä¸€ä¸ªæä¾›å…è´¹HTTPSè¯ä¹¦ç”³è¯·çš„ç½‘ç«™</a></p><p>[7] <a href="https://hexo.io/docs/configuration#Directory">Configuration | Hexo</a></p><p>[8] <a href="https://iitii.github.io/2019/02/15/1/">Hexoè·³è¿‡æŒ‡å®šæ–‡ä»¶çš„æ¸²æŸ“ | Hello Memo (iitii.github.io)</a></p>]]></content>
    
    
    <summary type="html">é€šè¿‡github actionså°†hexoåšå®¢ç¼–è¯‘åç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œç„¶åserverlessè‡ªåŠ¨è·å–åˆ†æ”¯ä»£ç éƒ¨ç½²ç½‘ç«™</summary>
    
    
    
    <category term="serverless" scheme="https://blog.smart-lifestyle.cn/categories/serverless/"/>
    
    
    <category term="hexo" scheme="https://blog.smart-lifestyle.cn/tags/hexo/"/>
    
    <category term="serverless" scheme="https://blog.smart-lifestyle.cn/tags/serverless/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨apple M1ä¸Šæ„å»ºx86_64 Dockeré•œåƒ</title>
    <link href="https://blog.smart-lifestyle.cn/posts/de6/"/>
    <id>https://blog.smart-lifestyle.cn/posts/de6/</id>
    <published>2021-09-05T13:40:26.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>é»˜è®¤é€šè¿‡<code>docker build</code>æ–¹å¼æ„å»ºçš„é•œåƒæ—¶arm64çš„ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡<code>docker inspect IMAGE_ID</code>æŸ¥çœ‹åˆ°</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># docker image inspect <span class="number">0382</span>b9b17bdb</span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="attr">&quot;Architecture&quot;</span>: <span class="string">&quot;arm64&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Variant&quot;</span>: <span class="string">&quot;v8&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Os&quot;</span>: <span class="string">&quot;linux&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;Size&quot;</span>: <span class="number">223036168</span>,</span><br><span class="line">        <span class="attr">&quot;VirtualSize&quot;</span>: <span class="number">223036168</span>,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„é•œåƒæ—¶æ²¡æœ‰åŠæ³•åœ¨Intel x86/64çš„å®¹å™¨æœåŠ¡ä¸­è¿è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åŸºäºarmç‰ˆæœ¬æœåŠ¡å™¨çš„å®¹å™¨æœåŠ¡ï¼Œæ›´å¥½çš„é€‰æ‹©æ˜¯åœ¨M1ä¸Šç¼–è¯‘ x86æ¶æ„çš„å®¹å™¨é•œåƒ</p><p>Docker Desktop for Mac M1ä¸­é›†æˆäº†ä¸€ä¸ªbuildxçš„å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬ç¼–è¯‘å„ç§è·¨å¹³å°çš„å®¹å™¨é•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker buildx ls</span><br><span class="line"></span><br><span class="line">desktop-linux desktop-linux   running linux/arm64, linux/amd64, linux/riscv64, linux/ppc64le, linux/s390x, linux/386, linux/arm/v7, linux/arm/v6</span><br><span class="line">default *       docker</span><br><span class="line">  default       default         running linux/arm64, linux/amd64, linux/riscv64, linux/ppc64le, linux/s390x, linux/386, linux/arm/v7, linux/arm/v6</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨docker buildx buildæ¥æ„å»ºX86/64 dockeré•œåƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker buildx build --platform=linux/amd64 . -t xxx</span><br></pre></td></tr></table></figure><p>ä¹‹åå°±å¯æŒ‰ç…§æ­£å¸¸çš„docker tagã€docker pushè¿›è¡Œæ“ä½œ</p><p>æ›´å¤šçš„å‘½ä»¤å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://blog.jaimyn.dev/how-to-build-multi-architecture-docker-images-on-an-m1-mac/">How to build x86 (and others!) Docker images on an M1 Mac â€“ Jaimynâ€™s Blog</a></p><p>[2] <a href="https://github.com/docker/buildx/blob/master/docs/reference/buildx_build.md">buildx/buildx_build.md at master Â· docker/buildx (github.com)</a></p><p>[3] <a href="https://docs.docker.com/buildx/working-with-buildx/">Docker Buildx | Docker Documentation</a></p>]]></content>
    
    
    <summary type="html">åœ¨apple M1è®¾å¤‡ä¸Šä½¿ç”¨docker buildx buildæ„å»ºx86_64 çš„é•œåƒ</summary>
    
    
    
    <category term="Devops" scheme="https://blog.smart-lifestyle.cn/categories/Devops/"/>
    
    
    <category term="docker" scheme="https://blog.smart-lifestyle.cn/tags/docker/"/>
    
    <category term="Apple M1" scheme="https://blog.smart-lifestyle.cn/tags/Apple-M1/"/>
    
  </entry>
  
  <entry>
    <title>ubuntuæ›´æ”¹ä¸»æœºå</title>
    <link href="https://blog.smart-lifestyle.cn/posts/62e8/"/>
    <id>https://blog.smart-lifestyle.cn/posts/62e8/</id>
    <published>2021-07-01T22:17:51.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<ul><li>å¢åŠ æˆ–è€…ä¿®æ”¹<code>/etc/hostname</code>ï¼Œæ·»åŠ æ–°çš„ä¸»æœºå</li><li>ä¿®æ”¹<code>/etc/hosts</code>ï¼Œåœ¨127.0.0.1ä¸­æ·»åŠ æ–°çš„ä¸»æœºå</li><li>å¦‚æœæ˜¯åœ¨äº‘ä¸Šè¿è¡Œvmå®ä¾‹ï¼Œéœ€è¦ä¿®æ”¹ä¸Šé¢çš„<code>/etc/cloud/cloud.cfg</code>ï¼Œå¦åˆ™é‡å¯æœºå™¨åï¼Œhostnameä¼šå˜ä¸ºé»˜è®¤å€¼ğŸ˜­ï¼›æ‰¾åˆ°<code>preserve_hostname</code>ï¼Œå°†å…¶å€¼æ”¹ä¸º<code>true</code></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://www.myfreax.com/how-to-change-hostname-on-ubuntu-20-04/">å¦‚ä½•åœ¨Ubuntu 20.04ä¸Šæ›´æ”¹ä¸»æœºå (myfreax.com)</a></p>]]></content>
    
    
    <summary type="html">ä¿®æ”¹å…¬æœ‰äº‘ä¸Šlinux VMä¸»æœºå</summary>
    
    
    
    <category term="è¿ç»´" scheme="https://blog.smart-lifestyle.cn/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="ubuntu" scheme="https://blog.smart-lifestyle.cn/tags/ubuntu/"/>
    
    <category term="è¿ç»´" scheme="https://blog.smart-lifestyle.cn/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>linux shellå‚æ•°ä¼ é€’</title>
    <link href="https://blog.smart-lifestyle.cn/posts/fab/"/>
    <id>https://blog.smart-lifestyle.cn/posts/fab/</id>
    <published>2021-07-01T21:10:52.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<table><thead><tr><th>$#</th><th>å‚æ•°æ•°é‡</th></tr></thead><tbody><tr><td></td><td></td></tr><tr><td>$n</td><td>è¡¨ç¤ºç¬¬nä¸ªå‚æ•°ï¼Œnä¸º0æ—¶è¡¨ç¤ºè¿è¡Œçš„è„šæœ¬å</td></tr><tr><td>$@</td><td>â€œ$1â€ â€œ$2â€ â€œ$3â€â€¦. ä¼ é€’çš„å¤šä¸ªå‚æ•°</td></tr></tbody></table><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo &quot;total params: $#&quot;</span><br><span class="line">echo &quot;filename: $0&quot;</span><br><span class="line">echo &quot;param1: $1&quot;</span><br><span class="line">echo &quot;param2: $2&quot;</span><br><span class="line">echo &quot;param3: $3&quot;</span><br><span class="line">echo &quot;==============&quot;</span><br><span class="line">for i in &quot;$@&quot;; do</span><br><span class="line">    echo &quot;param: $i&quot;</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">total params: 2</span><br><span class="line">filename: ./test.sh</span><br><span class="line">param1: x1</span><br><span class="line">param2: x2</span><br><span class="line">param3:</span><br><span class="line">==============</span><br><span class="line">param: x1</span><br><span class="line">param: x2</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://www.runoob.com/linux/linux-shell-passing-arguments.html">Shell ä¼ é€’å‚æ•° | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a></p>]]></content>
    
    
    <summary type="html">åœ¨shellè„šæœ¬ä¸­è·å–æ‰§è¡Œæ—¶ï¼Œä¼ é€’çš„å‚æ•°</summary>
    
    
    
    <category term="linux" scheme="https://blog.smart-lifestyle.cn/categories/linux/"/>
    
    
    <category term="linux" scheme="https://blog.smart-lifestyle.cn/tags/linux/"/>
    
    <category term="shell" scheme="https://blog.smart-lifestyle.cn/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>SQLè¿æ¥å­—ç¬¦ä¸²ä¸­å¯†ç åŒ…å«ç‰¹æ®Šå­—ç¬¦</title>
    <link href="https://blog.smart-lifestyle.cn/posts/1538/"/>
    <id>https://blog.smart-lifestyle.cn/posts/1538/</id>
    <published>2021-07-01T16:59:35.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ•°æ®åº“çš„å¯†ç ä¼šåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚æœåŒ…å«äº†<code>@</code>ç­‰ç¬¦å·ï¼Œä¼šè¢«create_engineè¯†åˆ«é”™è¯¯ã€‚</p><p>å¯ä»¥å¯¹å¯†ç è¿›è¡Œurlç¼–ç ï¼Œä½¿ç”¨<code>urllib.parse.quote_plus</code></p><blockquote><p>As the URL is like any other URL, <strong>special characters such as those that may be used in the password need to be URL encoded to be parsed correctly.</strong>. Below is an example of a URL that includes the password <code>&quot;kx%jj5/g&quot;</code>, where the percent sign and slash characters are represented as <code>%25</code> and <code>%2F</code>, respectively:</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line">username = <span class="string">&#x27;scoot&#x27;</span></span><br><span class="line">password = <span class="string">&#x27;@#@%/g&#x27;</span></span><br><span class="line"></span><br><span class="line">engine = create_engine(<span class="string">f&#x27;postgresql://<span class="subst">&#123;username&#125;</span>:<span class="subst">&#123;urllib.parse.quote_plus(password)&#125;</span>@localhost:5432/mydatabase&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://docs.sqlalchemy.org/en/14/core/engines.html">Engine Configuration â€” SQLAlchemy 1.4 Documentation</a></p>]]></content>
    
    
    <summary type="html">SQLAlchemyè¿æ¥å­—ç¬¦ä¸²ä¸­å¯†ç åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥è¿›è¡Œurlç¼–ç </summary>
    
    
    
    <category term="SQLAlchemy" scheme="https://blog.smart-lifestyle.cn/categories/SQLAlchemy/"/>
    
    
    <category term="SQL" scheme="https://blog.smart-lifestyle.cn/tags/SQL/"/>
    
    <category term="SQLAlchemy" scheme="https://blog.smart-lifestyle.cn/tags/SQLAlchemy/"/>
    
  </entry>
  
  <entry>
    <title>pythonæ–‡ä»¶åæ“ä½œ</title>
    <link href="https://blog.smart-lifestyle.cn/posts/bea3/"/>
    <id>https://blog.smart-lifestyle.cn/posts/bea3/</id>
    <published>2021-06-30T13:41:58.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æˆ–è€…æ–‡ä»¶è½¬æ¢æ—¶ï¼Œéœ€è¦è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼ˆè¯»å–å®Œæ•´çš„æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼‰ï¼Œæ–‡ä»¶ä¿å­˜ï¼ˆä»…æ–‡ä»¶åï¼‰ï¼Œæ ¼å¼è½¬æ¢ï¼ˆä¸åŒ…å«åç¼€çš„æ–‡ä»¶åä»¥åŠåç¼€åï¼‰</p><p>ä½¿ç”¨åˆ°pythonåº“æœ‰ï¼š</p><ul><li><p>os.path.splitext()</p><p>åˆ†ç¦»æ–‡ä»¶åå’Œæ–‡ä»¶åç¼€ï¼Œä»¥æœ€åä¸€ä¸ªâ€™.â€™æ¥è·å–æ–‡ä»¶åç¼€</p></li><li><p>os.path.split()</p><p>åˆ†ç¦»æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶å</p></li></ul><ol><li>os.path.splitext()</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> os.path <span class="keyword">import</span> splitext</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>splitext(<span class="string">&#x27;/Users/simple/workspace/tmp/traefik/docker-compose.yml&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;/Users/simple/workspace/tmp/traefik/docker-compose&#x27;</span>, <span class="string">&#x27;.yml&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªä¸åŒ…å«è·¯å¾„çš„éšè—æ–‡ä»¶æ ¼å¼ï¼Œåç¼€è¿”å›ä¸ºç©º</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>splitext(<span class="string">&#x27;.bashrc&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;.bashrc&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="2"><li>os.path.split()</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> os.path <span class="keyword">import</span> split</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>split(<span class="string">&#x27;/Users/simple/workspace/tmp/traefik/docker-compose.yml&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;/Users/simple/workspace/tmp/traefik&#x27;</span>, <span class="string">&#x27;docker-compose.yml&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¾“å…¥ä¸ºä¸€ä¸ªä¸å«è·¯å¾„çš„ä»¥.å¼€å¤´çš„æ–‡ä»¶ï¼Œè·¯å¾„è¿”å›ä¸ºç©º</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>split(<span class="string">&#x27;.bascrc&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;.bascrc&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://docs.python.org/3/library/os.path.html">os.path â€” Common pathname manipulations â€” Python 3.9.6 documentation</a></p><p>[2] <a href="https://blog.csdn.net/lilongsy/article/details/99853925">Pythonè·å–æ–‡ä»¶è·¯å¾„ã€æ–‡ä»¶åå’Œæ‰©å±•å_å°é¾™åœ¨çº¿-CSDNåšå®¢_python è·å–è·¯å¾„æ–‡ä»¶å</a></p>]]></content>
    
    
    <summary type="html">è·å–æ–‡ä»¶è·¯å¾„ã€æ–‡ä»¶åã€æ–‡ä»¶åç¼€</summary>
    
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
    <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
    <category term="file" scheme="https://blog.smart-lifestyle.cn/tags/file/"/>
    
  </entry>
  
  <entry>
    <title>ä¿®æ”¹SQL Serverè¿æ¥å­—ç¬¦ä¸²</title>
    <link href="https://blog.smart-lifestyle.cn/posts/3178/"/>
    <id>https://blog.smart-lifestyle.cn/posts/3178/</id>
    <published>2021-06-30T11:13:50.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>com.microsoft.sql server.jdbc.sqlserverException:é©±åŠ¨ç¨‹åºæ— æ³•ä½¿ç”¨å®‰å…¨å¥—æ¥å­—å±‚ï¼ˆSSLï¼‰åŠ å¯†å»ºç«‹åˆ°SQL Serverçš„å®‰å…¨è¿æ¥</p></blockquote><p>åœ¨é«˜çº§è®¾ç½®ä¸­trustServerCertificateæ”¹ä¸ºtrueå³å¯</p><p><img src="https://oss.smart-lifestyle.cn/file/cs6v8.png" alt="image-20210630111813541"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://www.baooytra.com/knowledge/questions/56246/modifying-sql-server-connection-string.html?smartspace=fme-desktop-getting-started_2">ä¿®æ”¹SQL Serverè¿æ¥å­—ç¬¦ä¸²-FMEç¤¾åŒº - äºšæåœ¨çº¿ (baooytra.com)</a></p>]]></content>
    
    
    <summary type="html">åœ¨DataGripä¸­è§£å†³SQL Serverè¿æ¥æŠ¥â€œé©±åŠ¨ç¨‹åºæ— æ³•ä½¿ç”¨å®‰å…¨å¥—æ¥å­—å±‚ï¼ˆSSLï¼‰åŠ å¯†å»ºç«‹åˆ°SQL Serverçš„å®‰å…¨è¿æ¥â€</summary>
    
    
    
    <category term="SQL" scheme="https://blog.smart-lifestyle.cn/categories/SQL/"/>
    
    
    <category term="SQL" scheme="https://blog.smart-lifestyle.cn/tags/SQL/"/>
    
    <category term="sqlserverException" scheme="https://blog.smart-lifestyle.cn/tags/sqlserverException/"/>
    
  </entry>
  
  <entry>
    <title>å‡½æ•°è®¡ç®—ä¸­pythonä¾èµ–åŒ…æ‰“åŒ…</title>
    <link href="https://blog.smart-lifestyle.cn/posts/990c/"/>
    <id>https://blog.smart-lifestyle.cn/posts/990c/</id>
    <published>2021-06-30T10:09:58.000Z</published>
    <updated>2022-05-05T14:53:03.075Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹æ“ä½œä½¿ç”¨äºåä¸ºäº‘çš„<a href="https://support.huaweicloud.com/functiongraph/">functiongraph</a>å’Œè…¾è®¯äº‘çš„<a href="https://cloud.tencent.com/document/product/583/9199">serverless</a></p><p><em>ï¼æœ‰äº›åŒ…éœ€è¦ç¼–è¯‘ï¼Œå› æ­¤å»ºè®®åœ¨centos7ä¸­è¿›è¡Œæ“ä½œ</em></p><h3 id="å‡†å¤‡å†…å®¹"><a href="#å‡†å¤‡å†…å®¹" class="headerlink" title="å‡†å¤‡å†…å®¹"></a>å‡†å¤‡å†…å®¹</h3><ol><li>Centos7 + python3.6ç¯å¢ƒ + zip</li><li>requirements.txt</li></ol><h3 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h3><ul><li><p>å®‰è£…ä¾èµ–åˆ°æœ¬åœ°æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºæ–‡ä»¶å¤¹</span></span><br><span class="line">mkdir new_dir</span><br><span class="line"><span class="comment"># pythonä¾èµ–åŒ…å®‰è£…åˆ°æŒ‡å®šç›®å½•, -tå°†æ‰€æœ‰ä¾èµ–å®‰è£…åˆ°new_dirç›®å½•</span></span><br><span class="line">pip install -r requirements-prod.txt -t  new_dir/</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æ‰“åŒ…æˆzipåŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥åˆ°å®‰è£…ç›®å½•æ–‡ä»¶å¤¹é‡Œ</span></span><br><span class="line"><span class="built_in">cd</span> new_dir</span><br><span class="line"><span class="comment"># å‹ç¼©ä¸ºzipåŒ…(æ‰“åŒ…çš„ä¸ºé‡Œé¢çš„æ–‡ä»¶ï¼Œä¸æ˜¯new_dirè¿™ä¸ªç›®å½•)</span></span><br><span class="line">zip -rq package_name.1.1.zip *</span><br></pre></td></tr></table></figure></li><li><p>ä¸Šä¼ </p><p>æ ¹æ®å„ä¸ªäº‘çš„è¦æ±‚ï¼Œå°†zipåŒ…ä¸Šä¼ ï¼Œå¦‚æœzipåŒ…å¤ªå¤§ï¼Œä¸€èˆ¬éƒ½è¦æ±‚å…ˆä¸Šä¼ åˆ°å¯¹è±¡å­˜å‚¨ä¸­</p></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>[1] <a href="https://cloud.tencent.com/document/product/583/9702">äº‘å‡½æ•° éƒ¨ç½²å‡½æ•° - æ“ä½œæŒ‡å— - æ–‡æ¡£ä¸­å¿ƒ - è…¾è®¯äº‘ (tencent.com)</a></p><p>[2] <a href="https://support.huaweicloud.com/functiongraph_faq/functiongraph_03_0343.html">å¦‚ä½•åˆ¶ä½œå‡½æ•°ä¾èµ–åŒ…ï¼Ÿ_å‡½æ•°å·¥ä½œæµ FunctionGraph_å¸¸è§é—®é¢˜_é€šç”¨é—®é¢˜_åä¸ºäº‘ (huaweicloud.com)</a></p>]]></content>
    
    
    <summary type="html">å¦‚ä½•åœ¨å‡½æ•°è®¡ç®—ä¸­ä¸ºpythonæ‰“åŒ…ä¾èµ–åŒ…</summary>
    
    
    
    <category term="serverless" scheme="https://blog.smart-lifestyle.cn/categories/serverless/"/>
    
    
    <category term="serverless" scheme="https://blog.smart-lifestyle.cn/tags/serverless/"/>
    
    <category term="function" scheme="https://blog.smart-lifestyle.cn/tags/function/"/>
    
  </entry>
  
</feed>
