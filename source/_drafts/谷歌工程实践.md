---
title: 谷歌工程实践—code review 开发者指南
tags:
  - code review
categories: book
abbrlink: '5e57'
---
> 更好的通过Code review
## 写一个好的CL[^1]描述
> 一个CL描述记录了做了什么更改以及为什么做这个更改
### 第一行
CL描述的第一行，应该是对CL正在做的具体工作的短简总结，要做到：
* 言简意赅
* 语义完整
* 空行隔开
### 正文内容丰富
其余描述应该具体丰富，可能包括正在解决问题的简要概述、为什么这么做，如果存在缺点，应该提及到。也应该包括相关的背景信息
### 举例
#### 反例
* 修复bug
* 添加补丁
* 阶段1
以上描述不够充分，不知道究竟在干什么
#### 好的CL描述
```md
重构，将modbus采集由同步方式改为异步方式

多路modbus采集时，同步方式导致采集时间过长，影响后续的数据处理，改为异步方式后，增加并发数，提高采集速度。

```
## CL应该尽可能简短
> 简短的CL指的是尽可能在一次减少提交变更，避免巨大改动
> 如果你提供不了简短的CL，说明你的代码可能需要重构了
CL更简短，有如下优点：
* code review 更快
* 减少导致bug的可能性
* 较少不必要的工作
* 更方便的合并代码
* 有助于做出更好的设计
* 降低审查者的难度
### 怎么算简短
通常CL的正确大小是一个独立的更改，这意味着：CL所做的最小更改仅解决了一件事情，比如你需要增加两个独立的API接口，应该分别提交API。
### 把代码重构分离出来
重构最好不要和功能修改或者bug fix一起提CL，比如重命名一个Class，最好和这个CLass的bug fix分开提CL，这样对于评审者来说，更容易理解
### 将相关测试代码保存在同一CL中
应该避免将测试代码拆分为单独的CL，验证代码修改的测试也应该进入相同的CL

[^1]:	CL is ChangeList