<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>simple&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.smart-lifestyle.cn/"/>
  <updated>2021-03-31T16:26:25.050Z</updated>
  <id>https://blog.smart-lifestyle.cn/</id>
  
  <author>
    <name>simple</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>git abc tutorial</title>
    <link href="https://blog.smart-lifestyle.cn/posts/de34/"/>
    <id>https://blog.smart-lifestyle.cn/posts/de34/</id>
    <published>2021-03-31T14:19:56.000Z</published>
    <updated>2021-03-31T16:26:25.050Z</updated>
    
    <content type="html"><![CDATA[<h1>git-abc</h1><p>ä¸‹é¢ä»‹ç»ç»å¸¸ç”¨åˆ°ä¸”æœ€åŸºæœ¬çš„git å‘½ä»¤</p><h2 id="ä»“åº“ç®¡ç†">ä»“åº“ç®¡ç†</h2><h3 id="åˆ›å»ºæœ¬åœ°ä»“åº“">åˆ›å»ºæœ¬åœ°ä»“åº“</h3><ul><li><code>git init</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir git-abc</span><br><span class="line"><span class="built_in">cd</span> git-abc</span><br><span class="line">git init</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/qm2vb.png" alt="image-20210331222402099"></p><h3 id="æ·»åŠ è¿œç¨‹åˆ†æ”¯">æ·»åŠ è¿œç¨‹åˆ†æ”¯</h3><ul><li><code>git remote add &lt;shortname&gt; &lt;url&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/simplezhao/git-abc.git</span><br></pre></td></tr></table></figure><h3 id="æŠ“å–è¿œç¨‹ä»£ç ">æŠ“å–è¿œç¨‹ä»£ç </h3><ul><li><code>git fetch &lt;remote&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/48gpy.png" alt="image-20210331223237496"></p><h3 id="æŸ¥çœ‹æŸä¸ªè¿œç¨‹ä»“åº“">æŸ¥çœ‹æŸä¸ªè¿œç¨‹ä»“åº“</h3><ul><li><code>git remote show &lt;remote&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote show origin</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/50dkt.png" alt="image-20210331223628444"></p><h3 id="åŒæ­¥è¿œç¨‹åˆ†æ”¯">åŒæ­¥è¿œç¨‹åˆ†æ”¯</h3><ul><li><code>git checkout -b &lt;branch&gt; &lt;remote&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b main origin/main</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/vkntn.png" alt="image-20210331224921389"></p><h2 id="ä»£ç ç®¡ç†">ä»£ç ç®¡ç†</h2><h3 id="æŸ¥çœ‹å½“å‰åˆ†æ”¯çŠ¶æ€">æŸ¥çœ‹å½“å‰åˆ†æ”¯çŠ¶æ€</h3><ul><li><code>git status</code></li></ul><ol><li>ä¿®æ”¹readme.mdæ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><p>æç¤ºæ–‡ä»¶è¢«ä¿®æ”¹</p><p><img src="https://oss.smart-lifestyle.cn/file/jjthz.png" alt="image-20210331225856222"></p><ol start="2"><li>æ–°å¢ä¸€ä¸ªreadme_en.mdæ–‡ä»¶</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><p>æç¤ºæœ‰æœªè·Ÿè¸ªçš„æ–‡ä»¶</p><p><img src="https://oss.smart-lifestyle.cn/file/ttydm.png" alt="image-20210331230055526"></p><h3 id="æ·»åŠ æ–‡ä»¶">æ·»åŠ æ–‡ä»¶</h3><ul><li><p><code>git add .</code> æ·»åŠ æ‰€æœ‰æ–‡ä»¶</p></li><li><p><code>git add &lt;file&gt;</code>æ·»åŠ æŒ‡å®šæ–‡ä»¶</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">git add .</span><br></pre></td></tr></table></figure><p>æ·»åŠ æˆåŠŸåï¼Œæ˜¾ç¤ºå‡†å¤‡æäº¤çš„æ–‡ä»¶</p><p><img src="https://oss.smart-lifestyle.cn/file/2m0ge.png" alt="image-20210331230400289"></p><h3 id="æäº¤æ–‡ä»¶">æäº¤æ–‡ä»¶</h3><ul><li><code>git commit -a</code> åœ¨é»˜è®¤ç¼–è¾‘å™¨å†…å¢åŠ æœ¬æ¬¡æäº¤å†…å®¹</li><li><code>git commit -m &lt;message&gt;</code>ç®€çŸ­æäº¤</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">"update readme file and add new readme for english version"</span></span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/xkx4s.png" alt="image-20210331230900239"></p><h3 id="æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯">æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯</h3><ul><li><code>git push &lt;shortname&gt; &lt;branch&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin main</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/136q4.png" alt="image-20210331231029318"></p><h3 id="æŸ¥çœ‹æäº¤è®°å½•">æŸ¥çœ‹æäº¤è®°å½•</h3><ul><li><code>git log</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/wvarp.png" alt="image-20210331231130554"></p><h2 id="ä»£ç åˆå¹¶">ä»£ç åˆå¹¶</h2><p>å¤šäººå¼€å‘åŒä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦å…±åŒç»´æŠ¤åŒä¸€ä¸ªä»£ç åº“ï¼Œå‡å¦‚æ¯ä¸ªäººè´Ÿè´£ç‹¬ç«‹çš„æ¨¡å—ï¼Œä¸ä¼šæ¶‰åŠåˆ°ä»£ç å†²çª</p><p>æŸæ¬¡æäº¤æ—¶ï¼Œæç¤ºå¦‚ä¸‹é—®é¢˜</p><p><img src="https://oss.smart-lifestyle.cn/file/d62zw.png" alt="image-20210331232246543"></p><p>è¿™æ˜¯å› ä¸ºè¿œç¨‹åˆ†æ”¯è¦ä¼˜å…ˆæœ¬åœ°çš„åˆ†æ”¯ï¼Œéœ€è¦å…ˆæ‰§è¡Œgit pullï¼Œç„¶ååœ¨æ‰§è¡Œgit pushå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git pull origin main</span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œpullæ—¶ä¼šæç¤ºMergeä¿¡æ¯</p><p><img src="https://oss.smart-lifestyle.cn/file/xq0ww.png" alt="image-20210331232418971"></p><p>å®Œæˆå¹¶é€€å‡ºç¼–è¾‘åï¼Œæç¤ºpullä¿¡æ¯</p><p><img src="https://oss.smart-lifestyle.cn/file/ct9wp.png" alt="image-20210331232514825"></p><p>å†æ¬¡æ‰§è¡Œgit push origin mainï¼Œæ˜¾ç¤ºæäº¤æˆåŠŸ</p><p><img src="https://oss.smart-lifestyle.cn/file/lwto3.png" alt="image-20210331232632195"></p><h2 id="åˆ†æ”¯ç®¡ç†">åˆ†æ”¯ç®¡ç†</h2><h3 id="åˆ›å»ºæ–°çš„åˆ†æ”¯">åˆ›å»ºæ–°çš„åˆ†æ”¯</h3><ul><li><code>git branch &lt;branch&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git branch hotfix</span><br><span class="line">git checkout hotfix</span><br></pre></td></tr></table></figure><h3 id="åˆ†æ”¯åˆå¹¶">åˆ†æ”¯åˆå¹¶</h3><p>åœ¨ä¸Šä¸€æ­¥æ“ä½œï¼Œå› ä¸ºç³»ç»Ÿå‡ºç°bugï¼Œç´§æ€¥åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œç„¶ååœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šè¿›è¡Œä¿®å¤ï¼Œä¿®æ”¹æµ‹è¯•éªŒè¯å®Œæ¯•åï¼Œä»hotfixåˆ†æ”¯åˆå¹¶åˆ°mainåˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout main</span><br><span class="line">git merge hotfix</span><br></pre></td></tr></table></figure><p><img src="https://oss.smart-lifestyle.cn/file/8q60h.png" alt="image-20210331235235214"></p><h3 id="åˆ†æ”¯åˆ é™¤">åˆ†æ”¯åˆ é™¤</h3><ul><li><code>git branch -d &lt;branch&gt;</code></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d hotfix</span><br></pre></td></tr></table></figure><h3 id="æ‰“æ ‡ç­¾">æ‰“æ ‡ç­¾</h3><ul><li><p><code>git tag</code></p></li><li><p><code>git tag -a &lt;version&gt; -m &lt;message&gt;</code></p></li></ul><p>é€šè¿‡<code>git tag</code>æŸ¥çœ‹ä»“åº“å†…å·²ç»å­˜åœ¨çš„æ ‡ç­¾åˆ—è¡¨</p><h4 id="åˆ›å»ºæ ‡ç­¾">åˆ›å»ºæ ‡ç­¾</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag -a <span class="string">'1.0'</span> -m <span class="string">"first version"</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨è½»é‡çº§æ ‡ç­¾</p><p><code>git tag 1.0-a</code></p><h4 id="å…±äº«æ ‡ç­¾">å…±äº«æ ‡ç­¾</h4><p>é»˜è®¤æƒ…å†µä¸‹ git pushå‘½ä»¤ä¸ä¼šæŠŠæ ‡ç­¾ä¼ é€åˆ°è¿œç¨‹ä»“åº“ï¼Œå¿…é¡»æ˜¾å¼åœ°æ¨é€æ ‡ç­¾åˆ°æœåŠ¡å™¨ï¼Œç±»ä¼¼äºæ¨é€ä»£ç </p><p><code>git push &lt;shortname&gt; &lt;tagname&gt;</code></p><p>å¦‚æœæƒ³ä¸€æ¬¡æ¨é€å¤šä¸ªæ ‡ç­¾ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤</p><p><code>git push &lt;shortname&gt; --tags</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push origin 1.0</span><br><span class="line">git push origin --tags</span><br></pre></td></tr></table></figure><p>æ¨é€æŒ‡å®šæ ‡ç­¾</p><p><img src="https://oss.smart-lifestyle.cn/file/o6cju.png" alt="image-20210401001342160"></p><p>æ¨é€æ‰€æœ‰æ ‡ç­¾</p><p><img src="https://oss.smart-lifestyle.cn/file/fyqxl.png" alt="image-20210401001405265"></p><h2 id="git-é…ç½®">git é…ç½®</h2><p>ä½¿ç”¨<code>git config -l </code>æŸ¥çœ‹å½“å‰ä»“åº“é…ç½®</p><h3 id="é…ç½®å…¨å±€ä¿¡æ¯">é…ç½®å…¨å±€ä¿¡æ¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">"yourname"</span></span><br><span class="line">git config --global user.email <span class="string">"youremail"</span></span><br></pre></td></tr></table></figure><h3 id="é…ç½®å½“å‰ä»“åº“ä¿¡æ¯">é…ç½®å½“å‰ä»“åº“ä¿¡æ¯</h3><p>å’Œå…¨å±€åŒºåˆ«åœ¨äºå»æ‰â€“globalæ ‡è®°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config user.name <span class="string">"yourname"</span></span><br><span class="line">git config user.email <span class="string">"youremail"</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] <a href="https://git-scm.com/book/en/v2" target="_blank" rel="noopener">Book: Pro Git</a></p>]]></content>
    
    <summary type="html">
    
      æœ€å¸¸ç”¨ä¸”æœ€åŸºæœ¬çš„gitç”¨æ³•
    
    </summary>
    
    
      <category term="git" scheme="https://blog.smart-lifestyle.cn/categories/git/"/>
    
    
      <category term="git" scheme="https://blog.smart-lifestyle.cn/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>python web--flask jsonify unicode</title>
    <link href="https://blog.smart-lifestyle.cn/posts/9b/"/>
    <id>https://blog.smart-lifestyle.cn/posts/9b/</id>
    <published>2021-03-31T08:10:09.000Z</published>
    <updated>2021-03-31T08:16:22.256Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ç±»ä¼¼äºjson.dumpsä¸­ensure_asciiçš„é…ç½®ï¼Œåœ¨flaskä¸­ä¹Ÿæœ‰ç±»ä¼¼é…ç½®ï¼Œæ¥é¿å…jsonifyæ—¶ï¼Œè¿”å›unicodeç¼–ç å­—ç¬¦</p></blockquote><p>åœ¨flask configä¸­åŠ å…¥<code>app.config['JSON_AS_ASCII'] = False</code>æ¥é¿å…jsonifyå¯¹éasciiå­—ç¬¦è¿›è¡Œunicodeç¼–ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(app_config)</span><br><span class="line">app.config.from_mapping(</span><br><span class="line">    SQLALCHEMY_DATABASE_URI=<span class="string">f"postgresql+psycopg2://<span class="subst">&#123;app_config.DB_USER&#125;</span>:<span class="subst">&#123;app_config.DB_PASSWORD&#125;</span>"</span></span><br><span class="line">                            <span class="string">f"@<span class="subst">&#123;app_config.DB_HOST&#125;</span>:<span class="subst">&#123;app_config.DB_PORT&#125;</span>/<span class="subst">&#123;app_config.DB_NAME&#125;</span>"</span>,</span><br><span class="line">    SQLALCHEMY_TRACK_MODIFICATIONS=<span class="literal">False</span>,</span><br><span class="line">    <span class="comment"># SQLALCHEMY_ECHO=True</span></span><br><span class="line">)</span><br><span class="line">app.config[<span class="string">'JSON_AS_ASCII'</span>] = <span class="literal">False</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] [<a href="https://stackoverflow.com/questions/37531067/how-to-prevent-unicode-representation-for-latin1-characters" target="_blank" rel="noopener">How to prevent Unicode representation for Latin1 characters?</a>]</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;ç±»ä¼¼äºjson.dumpsä¸­ensure_asciiçš„é…ç½®ï¼Œåœ¨flaskä¸­ä¹Ÿæœ‰ç±»ä¼¼é…ç½®ï¼Œæ¥é¿å…jsonifyæ—¶ï¼Œè¿”å›unicodeç¼–ç å­—ç¬¦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨flask configä¸­åŠ å…¥&lt;code&gt;app.config[&#39;JSON_AS_ASCII&#39;] = False&lt;/code&gt;æ¥é¿å…jsonifyå¯¹éasciiå­—ç¬¦è¿›è¡Œunicodeç¼–ç &lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;app = Flask(__name__)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.config.from_object(app_config)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.config.from_mapping(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SQLALCHEMY_DATABASE_URI=&lt;span class=&quot;string&quot;&gt;f&quot;postgresql+psycopg2://&lt;span class=&quot;subst&quot;&gt;&amp;#123;app_config.DB_USER&amp;#125;&lt;/span&gt;:&lt;span class=&quot;subst&quot;&gt;&amp;#123;app_config.DB_PASSWORD&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;span class=&quot;string&quot;&gt;f&quot;@&lt;span class=&quot;subst&quot;&gt;&amp;#123;app_config.DB_HOST&amp;#125;&lt;/span&gt;:&lt;span class=&quot;subst&quot;&gt;&amp;#123;app_config.DB_PORT&amp;#125;&lt;/span&gt;/&lt;span class=&quot;subst&quot;&gt;&amp;#123;app_config.DB_NAME&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    SQLALCHEMY_TRACK_MODIFICATIONS=&lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# SQLALCHEMY_ECHO=True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;app.config[&lt;span class=&quot;string&quot;&gt;&#39;JSON_AS_ASCII&#39;&lt;/span&gt;] = &lt;span class=&quot;literal&quot;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;[1] [&lt;a href=&quot;https://stackoverflow.com/questions/37531067/how-to-prevent-unicode-representation-for-latin1-characters&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;How to prevent Unicode representation for Latin1 characters?&lt;/a&gt;]&lt;/p&gt;
    
    </summary>
    
    
      <category term="flask" scheme="https://blog.smart-lifestyle.cn/categories/flask/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="flask" scheme="https://blog.smart-lifestyle.cn/tags/flask/"/>
    
  </entry>
  
  <entry>
    <title>python json.dumps unicode</title>
    <link href="https://blog.smart-lifestyle.cn/posts/b1/"/>
    <id>https://blog.smart-lifestyle.cn/posts/b1/</id>
    <published>2021-03-31T07:54:04.000Z</published>
    <updated>2021-03-31T08:06:36.171Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨dumps/dumpä¸­ä½¿ç”¨ensure_ascii=Falseï¼Œæ¥æ‰‹åŠ¨ç¼–ç ä¸ºUTF8æ ¼å¼</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># è¾“å‡ºä¸ºUnicodeç¼–ç ï¼Œä¸ä¾¿äºå¯è§†åŒ–</span></span><br><span class="line">&gt; json.dumps(<span class="string">"æˆ‘çˆ±ChinağŸ‡¨ğŸ‡³"</span>)</span><br><span class="line"><span class="string">'"\\u6211\\u7231China\\ud83c\\udde8\\ud83c\\uddf3"'</span></span><br><span class="line"></span><br><span class="line">&gt; json.dumps(<span class="string">"æˆ‘çˆ±ChinağŸ‡¨ğŸ‡³"</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"><span class="string">'"æˆ‘çˆ±ChinağŸ‡¨ğŸ‡³"'</span></span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] <a href="https://stackoverflow.com/questions/18337407/saving-utf-8-texts-with-json-dumps-as-utf8-not-as-u-escape-sequence" target="_blank" rel="noopener">json dumps unicode</a></p>]]></content>
    
    <summary type="html">
    
      å¤„ç†json dumpsæ—¶ä¸­æ–‡æ˜¾ç¤ºunicodeç¼–ç 
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="json" scheme="https://blog.smart-lifestyle.cn/tags/json/"/>
    
  </entry>
  
  <entry>
    <title>kombu.exceptions.EncodeError XXXX is not JSON serializable</title>
    <link href="https://blog.smart-lifestyle.cn/posts/3277/"/>
    <id>https://blog.smart-lifestyle.cn/posts/3277/</id>
    <published>2021-03-31T06:02:05.000Z</published>
    <updated>2021-03-31T06:51:44.068Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®°å½•åœ¨ä½¿ç”¨celeryæ—¶ï¼Œä»»åŠ¡å‡½æ•°å‚æ•°åºåˆ—åŒ–é—®é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@celery_app.task(name="create_subscription")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_subscription_file</span><span class="params">(req: SubscriptionRequest)</span>:</span></span><br><span class="line"></span><br><span class="line">    req = SubscriptionRequest(**kwargs)</span><br><span class="line">    subscription_count = req.count</span><br><span class="line">    run_times = math.ceil(subscription_count / <span class="number">200</span>)</span><br><span class="line">    results = &#123;</span><br><span class="line">        <span class="string">"count"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"validDateTime"</span>: <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionRequest</span><span class="params">(BaseModel)</span>:</span></span><br><span class="line">    bearer_token: str = <span class="literal">None</span></span><br><span class="line">    validDateTime: datetime = <span class="literal">None</span></span><br><span class="line">    validPeriodTime: int = <span class="number">12</span></span><br><span class="line">    count: int = <span class="number">200</span></span><br><span class="line">    deviceTypeId: int = <span class="number">2</span></span><br><span class="line">    subscriptionLevelId: int = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">data_json</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.json(exclude=&#123;<span class="string">'bearer_token'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @validator('validDateTime')</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_default_date</span><span class="params">(cls, v)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            v = get_default_valid_datetime()</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">default</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.json()</span><br></pre></td></tr></table></figure><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå‡†å¤‡ä½¿ç”¨pydanticä½œä¸ºå‚æ•°æ ¡éªŒï¼Œå› æ­¤åœ¨ä¼ é€’ç»™celery taskæ—¶ï¼Œä¼ é€’äº†ä¸€ä¸ªclass Instanceï¼›æ¥ç€åœ¨ä»»åŠ¡è°ƒåº¦æ—¶æŠ¥é”™ï¼š</p><p><code>kombu.exceptions.EncodeError: SubscriptionRequest is not JSON serializable</code></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œcelery ä½¿ç”¨JSONè¿›è¡Œåºåˆ—åŒ–æ•°æ®ï¼Œå› æ­¤æ ¹æœ¬åŸå› åœ¨äºé»˜è®¤æƒ…å†µä¸‹classå®ä¾‹æ— æ³•è¢«jsonåºåˆ—åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; json.dumps(SubscriptionRequest)</span><br><span class="line">TypeError: Object of type SubscriptionRequest <span class="keyword">is</span> <span class="keyword">not</span> JSON serializable</span><br></pre></td></tr></table></figure><p>json.dumpsæœ‰ä¸€ä¸ªå‚æ•°defaultï¼Œåœ¨python docsæ–‡æ¡£ä¸­æè¿°å¦‚ä¸‹</p><blockquote><p>å½“ <em>default</em> è¢«æŒ‡å®šæ—¶ï¼Œå…¶åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¯å½“æŸä¸ªå¯¹è±¡æ— æ³•è¢«åºåˆ—åŒ–æ—¶å®ƒä¼šè¢«è°ƒç”¨ã€‚å®ƒåº”è¯¥è¿”å›è¯¥å¯¹è±¡çš„ä¸€ä¸ªå¯ä»¥è¢« JSON ç¼–ç çš„ç‰ˆæœ¬æˆ–è€…å¼•å‘ä¸€ä¸ª <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#TypeError" target="_blank" rel="noopener"><code>TypeError</code></a>ã€‚å¦‚æœæ²¡æœ‰è¢«æŒ‡å®šï¼Œåˆ™ä¼šç›´æ¥å¼•å‘ <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#TypeError" target="_blank" rel="noopener"><code>TypeError</code></a>ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©defaultå‡½æ•°æ¥ä¸ºclasså®ä¾‹åˆ›å»ºä¸€ä¸ªæ–¹æ³•å®ç°å¯¹å…¶jsonåºåˆ—åŒ–ã€‚</p><p>è¿™é‡Œæ²¡æœ‰å¯¹ç±»è¿›è¡Œæ”¹é€ ï¼Œè€Œæ˜¯ä¼˜åŒ–å‡½æ•°çš„å…¥å‚</p><p>æœ€åæ”¹æˆï¼Œå…ˆä¼ é€’å‚æ•°åˆ°taskï¼Œç„¶ååœ¨taskå†…å¯¹æ‰€æœ‰å‚æ•°è¿›è¡Œpydantic æ ¡éªŒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@celery_app.task(name="create_subscription")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_subscription_file</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line"><span class="comment"># å¯¹kvå‚æ•°ä½¿ç”¨pydanticæ ¡éªŒ</span></span><br><span class="line">    req = SubscriptionRequest(**kwargs)</span><br><span class="line">    subscription_count = req.count</span><br><span class="line">    run_times = math.ceil(subscription_count / <span class="number">200</span>)</span><br><span class="line">    results = &#123;</span><br><span class="line">        <span class="string">"count"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"validDateTime"</span>: <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line">    result_queue = Queue()</span><br><span class="line">...</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] <a href="https://stackoverflow.com/questions/10252010/serializing-class-instance-to-json" target="_blank" rel="noopener">class serialize</a></p><p>[2] <a href="https://github.com/celery/celery/issues/5922" target="_blank" rel="noopener">github issue</a></p>]]></content>
    
    <summary type="html">
    
      celeryåºåˆ—åŒ–é—®é¢˜
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="celery" scheme="https://blog.smart-lifestyle.cn/tags/celery/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€ç¯‡--function</title>
    <link href="https://blog.smart-lifestyle.cn/posts/2f69/"/>
    <id>https://blog.smart-lifestyle.cn/posts/2f69/</id>
    <published>2021-03-29T15:30:20.000Z</published>
    <updated>2021-03-30T14:31:21.893Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="function" scheme="https://blog.smart-lifestyle.cn/tags/function/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€ç¯‡--Exception</title>
    <link href="https://blog.smart-lifestyle.cn/posts/f1e8/"/>
    <id>https://blog.smart-lifestyle.cn/posts/f1e8/</id>
    <published>2021-03-29T15:30:00.000Z</published>
    <updated>2021-03-31T02:58:04.560Z</updated>
    
    <content type="html"><![CDATA[<p>ä»¥ä¸‹æ€»ç»“ä¸€ä¸‹pythonçš„å¼‚å¸¸å¤„ç†</p><h2 id="åŸºç±»">åŸºç±»</h2><h3 id="BaseException">BaseException</h3><blockquote><p>æ‰€æœ‰å†…ç½®å¼‚å¸¸çš„åŸºç±»ã€‚ å®ƒä¸åº”è¯¥è¢«ç”¨æˆ·è‡ªå®šä¹‰ç±»ç›´æ¥ç»§æ‰¿ (è¿™ç§æƒ…å†µè¯·ä½¿ç”¨ <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#Exception" target="_blank" rel="noopener"><code>Exception</code></a>)ã€‚ å¦‚æœåœ¨æ­¤ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨ <a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#str" target="_blank" rel="noopener"><code>str()</code></a>ï¼Œåˆ™ä¼šè¿”å›å®ä¾‹çš„å‚æ•°è¡¨ç¤ºï¼Œæˆ–è€…å½“æ²¡æœ‰å‚æ•°æ—¶è¿”å›ç©ºå­—ç¬¦ä¸²</p></blockquote><h3 id="Exception">Exception</h3><blockquote><p>æ‰€æœ‰å†…ç½®çš„éç³»ç»Ÿé€€å‡ºç±»å¼‚å¸¸éƒ½æ´¾ç”Ÿè‡ªæ­¤ç±»ã€‚ æ‰€æœ‰ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸ä¹Ÿåº”å½“æ´¾ç”Ÿè‡ªæ­¤ç±»</p></blockquote><h3 id="ArithmeticError">ArithmeticError</h3><blockquote><p>æ­¤åŸºç±»ç”¨äºæ´¾ç”Ÿé’ˆå¯¹å„ç§ç®—æœ¯ç±»é”™è¯¯è€Œå¼•å‘çš„å†…ç½®å¼‚å¸¸: <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#OverflowError" target="_blank" rel="noopener"><code>OverflowError</code></a>, <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#ZeroDivisionError" target="_blank" rel="noopener"><code>ZeroDivisionError</code></a>, <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#FloatingPointError" target="_blank" rel="noopener"><code>FloatingPointError</code></a></p></blockquote><h3 id="BufferError">BufferError</h3><blockquote><p>å½“ä¸ <a href="https://docs.python.org/zh-cn/3/c-api/buffer.html#bufferobjects" target="_blank" rel="noopener">ç¼“å†²åŒº</a> ç›¸å…³çš„æ“ä½œæ— æ³•æ‰§è¡Œæ—¶å°†è¢«å¼•å‘</p></blockquote><h3 id="LookupError">LookupError</h3><blockquote><p>æ­¤åŸºç±»ç”¨äºæ´¾ç”Ÿå½“æ˜ å°„æˆ–åºåˆ—æ‰€ä½¿ç”¨çš„é”®æˆ–ç´¢å¼•æ— æ•ˆæ—¶å¼•å‘çš„å¼‚å¸¸: <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#IndexError" target="_blank" rel="noopener"><code>IndexError</code></a>, <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#KeyError" target="_blank" rel="noopener"><code>KeyError</code></a>ã€‚ è¿™å¯ä»¥é€šè¿‡ <a href="https://docs.python.org/zh-cn/3/library/codecs.html#codecs.lookup" target="_blank" rel="noopener"><code>codecs.lookup()</code></a> æ¥ç›´æ¥å¼•å‘</p></blockquote><h3 id="å…·ä½“å¼‚å¸¸">å…·ä½“å¼‚å¸¸</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">BaseException</span><br><span class="line"> +-- SystemExit</span><br><span class="line"> +-- KeyboardInterrupt</span><br><span class="line"> +-- GeneratorExit</span><br><span class="line"> +-- Exception</span><br><span class="line">      +-- StopIteration</span><br><span class="line">      +-- StopAsyncIteration</span><br><span class="line">      +-- ArithmeticError</span><br><span class="line">      |    +-- FloatingPointError</span><br><span class="line">      |    +-- OverflowError</span><br><span class="line">      |    +-- ZeroDivisionError</span><br><span class="line">      +-- AssertionError</span><br><span class="line">      +-- AttributeError</span><br><span class="line">      +-- BufferError</span><br><span class="line">      +-- EOFError</span><br><span class="line">      +-- ImportError</span><br><span class="line">      |    +-- ModuleNotFoundError</span><br><span class="line">      +-- LookupError</span><br><span class="line">      |    +-- IndexError</span><br><span class="line">      |    +-- KeyError</span><br><span class="line">      +-- MemoryError</span><br><span class="line">      +-- NameError</span><br><span class="line">      |    +-- UnboundLocalError</span><br><span class="line">      +-- OSError</span><br><span class="line">      |    +-- BlockingIOError</span><br><span class="line">      |    +-- ChildProcessError</span><br><span class="line">      |    +-- ConnectionError</span><br><span class="line">      |    |    +-- BrokenPipeError</span><br><span class="line">      |    |    +-- ConnectionAbortedError</span><br><span class="line">      |    |    +-- ConnectionRefusedError</span><br><span class="line">      |    |    +-- ConnectionResetError</span><br><span class="line">      |    +-- FileExistsError</span><br><span class="line">      |    +-- FileNotFoundError</span><br><span class="line">      |    +-- InterruptedError</span><br><span class="line">      |    +-- IsADirectoryError</span><br><span class="line">      |    +-- NotADirectoryError</span><br><span class="line">      |    +-- PermissionError</span><br><span class="line">      |    +-- ProcessLookupError</span><br><span class="line">      |    +-- TimeoutError</span><br><span class="line">      +-- ReferenceError</span><br><span class="line">      +-- RuntimeError</span><br><span class="line">      |    +-- NotImplementedError</span><br><span class="line">      |    +-- RecursionError</span><br><span class="line">      +-- SyntaxError</span><br><span class="line">      |    +-- IndentationError</span><br><span class="line">      |         +-- TabError</span><br><span class="line">      +-- SystemError</span><br><span class="line">      +-- TypeError</span><br><span class="line">      +-- ValueError</span><br><span class="line">      |    +-- UnicodeError</span><br><span class="line">      |         +-- UnicodeDecodeError</span><br><span class="line">      |         +-- UnicodeEncodeError</span><br><span class="line">      |         +-- UnicodeTranslateError</span><br><span class="line">      +-- Warning</span><br><span class="line">           +-- DeprecationWarning</span><br><span class="line">           +-- PendingDeprecationWarning</span><br><span class="line">           +-- RuntimeWarning</span><br><span class="line">           +-- SyntaxWarning</span><br><span class="line">           +-- UserWarning</span><br><span class="line">           +-- FutureWarning</span><br><span class="line">           +-- ImportWarning</span><br><span class="line">           +-- UnicodeWarning</span><br><span class="line">           +-- BytesWarning</span><br><span class="line">           +-- ResourceWarning</span><br></pre></td></tr></table></figure><h2 id="å…·ä½“ç”¨æ³•">å…·ä½“ç”¨æ³•</h2><p>å…¸å‹çš„å¼‚å¸¸å¤„ç†ç»“æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  (your code)</span><br><span class="line"><span class="keyword">except</span> YourException <span class="keyword">as</span> e:</span><br><span class="line">  (your code)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  (your code)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">  (your code)</span><br></pre></td></tr></table></figure><ul><li>finally è¯­å¥ æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œï¼Œå¦å¤–å¦‚æœfinallyä¸­æœ‰returnè¯­å¥ï¼Œé‚£ä¹ˆå§‹ç»ˆè¿”å›finallyä¸­çš„returnè¯­å¥</li><li>else  è¯­å¥åœ¨æ²¡æœ‰å¼‚å¸¸æ—¶æ‰§è¡Œ</li><li>except å¯ä»¥åŒæ—¶å¡«å†™å¤šä¸ªException</li></ul><h3 id="å¤„ç†å¤šä¸ªå¼‚å¸¸">å¤„ç†å¤šä¸ªå¼‚å¸¸</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pow</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(n1, n2)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> pow(n1, n2) / n2</span><br><span class="line">    <span class="keyword">except</span> (TypeError,ZeroDivisionError) <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line"></span><br><span class="line">&gt; test(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•è·åˆ° ZeroDivisionError</span></span><br><span class="line">&gt; test(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">float division by zero</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•è·åˆ°TypeError</span></span><br><span class="line">&gt; test(<span class="string">'0'</span>, <span class="number">0</span>)</span><br><span class="line">must be real number, <span class="keyword">not</span> str</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ²¡æœ‰æ•è·åˆ°ï¼Œç¨‹åºå¼‚å¸¸è§¦å‘ValueError</span></span><br><span class="line">&gt; test(<span class="number">-1</span>, <span class="number">0.1</span>)</span><br><span class="line">ValueError: math domain error</span><br></pre></td></tr></table></figure><h3 id="æ•è·æ‰€æœ‰å¼‚å¸¸">æ•è·æ‰€æœ‰å¼‚å¸¸</h3><p>ä½¿ç”¨<code>except Exception as e:</code>æ¥æ•è·å…¶ä»–æ‰€æœ‰å¼‚å¸¸ï¼ˆæ³¨ï¼šè¿™ä¸ªå°†ä¼šæ•è·é™¤äº† <code>SystemExit</code> ã€ <code>KeyboardInterrupt</code> å’Œ <code>GeneratorExit</code> ä¹‹å¤–çš„æ‰€æœ‰å¼‚å¸¸ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pow</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(n1, n2)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> pow(n1, n2) / n2</span><br><span class="line">    <span class="keyword">except</span> (TypeError,ZeroDivisionError) <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">      print(<span class="string">'Exception: '</span>, e)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># å¦‚æœä¸ç¡®å®šå¼‚å¸¸ç±»å‹ï¼Œå¯ä»¥å†™Exceptionï¼Œæ•è·é€šç”¨Exception   </span></span><br><span class="line">&gt; test(<span class="number">-1</span>, <span class="number">0.1</span>)</span><br><span class="line">Exception:  math domain error</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸">åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸</h3><p>è‡ªå®šä¹‰å¼‚å¸¸ï¼Œç»§æ‰¿äº<code>Exception</code> æˆ–è€…å…¶ä»–ä»»ä½•ä¸€ä¸ªå·²å­˜åœ¨çš„å¼‚å¸¸ç±»å‹ï¼Œå‡å¦‚åœ¨å¤„ç†æµï¼Œéœ€è¦æ¶‰åŠåˆ°ç½‘ç»œæµã€æ–‡ä»¶æµã€å†…å­˜æµï¼Œé‚£ä¹ˆå¯ä»¥æ¶‰åŠåˆ°å¦‚ä¸‹å¼‚å¸¸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StreamError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetWorkStreamError</span><span class="params">(StreamError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileStreamError</span><span class="params">(StreamError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MemoryStreamError</span><span class="params">(StreamError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>éœ€è¦ç”¨åˆ°æ—¶ï¼Œå¯ä»¥æŒ‰ç…§Exceptionæ–¹å¼ï¼Œä¼ é€’å‚æ•°å³å¯ï¼ŒExceptionå°†æ‰€æœ‰ä¼ é€’çš„å‚æ•°ä»¥å…ƒç»„çš„å½¢å¼ï¼Œå­˜åœ¨<code>args</code>é‡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">'name error'</span>, <span class="string">'IO error'</span>, <span class="string">'EOF error'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e.args)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">(<span class="string">'name error'</span>, <span class="string">'IO error'</span>, <span class="string">'EOF error'</span>)</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦é‡å†™<code>__init__()</code>æ–¹æ³•ï¼Œéœ€è¦ç¡®ä¿æ‰€æœ‰å‚æ•°éƒ½ç»™èµ‹å€¼åˆ°çˆ¶ç±»<code>Exception.__init__()</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, message, status)</span>:</span></span><br><span class="line">    super().__init__(message, status)</span><br><span class="line">    self.msg = message</span><br><span class="line">    self.sta = status</span><br></pre></td></tr></table></figure><h3 id="æ•è·å¼‚å¸¸åæŠ›å‡ºå¦å¤–å¼‚å¸¸">æ•è·å¼‚å¸¸åæŠ›å‡ºå¦å¤–å¼‚å¸¸</h3><p>ä½¿ç”¨<code>raise Error from e</code>æ¥å½¢æˆå¼‚å¸¸é“¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä¿¡æ¯ï¼š</p><p>The above exception was the direct cause of the following exception</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">'EOF'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'need str'</span>) <span class="keyword">from</span> e</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-80-e2122a02c1f3&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      1 try:</span><br><span class="line">----&gt; 2     raise ValueError(<span class="string">'EOF'</span>)</span><br><span class="line">      3 except Exception as e:</span><br><span class="line"></span><br><span class="line">ValueError: EOF</span><br><span class="line"></span><br><span class="line">The above exception was the direct cause of the following exception:</span><br><span class="line"></span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-80-e2122a02c1f3&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      2     raise ValueError(<span class="string">'EOF'</span>)</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">----&gt; 4     raise TypeError(<span class="string">'need str'</span>) from e</span><br><span class="line">      5     <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">TypeError: need str</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ä½¿ç”¨<code>from e</code>ï¼Œè®¤ä¸ºåŒæ—¶å‘ç”Ÿäº†ä¸¤ä¸ªException</p><p>During handling of the above exception, another exception occurred</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">     x = <span class="number">3</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'need str'</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ZeroDivisionError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-93-7ae0db540006&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      1 try:</span><br><span class="line">----&gt; 2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line"></span><br><span class="line">ZeroDivisionError: division by zero</span><br><span class="line"></span><br><span class="line">During handling of the above exception, another exception occurred:</span><br><span class="line"></span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-93-7ae0db540006&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">----&gt; 4     raise TypeError(<span class="string">'need str'</span>)</span><br><span class="line"></span><br><span class="line">TypeError: need str</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦å¿½ç•¥æ‰å¼‚å¸¸é“¾ï¼Œå¯ä»¥ä½¿ç”¨<code>raise from None</code>, åªæœ€åçš„å¼‚å¸¸æŠ›å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">     x = <span class="number">3</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'need str'</span>) <span class="keyword">from</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-94-3858a6e7a744&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">----&gt; 4     raise TypeError(<span class="string">'need str'</span>) from None</span><br><span class="line"></span><br><span class="line">TypeError: need str</span><br></pre></td></tr></table></figure><h3 id="é‡æ–°æŠ›å‡ºè¢«æ•è·çš„å¼‚å¸¸">é‡æ–°æŠ›å‡ºè¢«æ•è·çš„å¼‚å¸¸</h3><p>å¦‚æœæƒ³å°†å¼‚å¸¸é‡æ–°è¢«ä¸Šä¸€çº§æ•è·ï¼Œå¯ä»¥åœ¨exceptä¸­å•ç‹¬åŠ ä¸€ä¸ª<code>raise</code>è¯­å¥ï¼Œè¿™æ ·å¯ä»¥åœ¨å¼‚å¸¸ä¸­è®°å½•æ—¥å¿—ç­‰æ“ä½œåå°†å¼‚å¸¸ä¼ æ’­å‡ºå»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">     x = <span class="number">3</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="comment"># other code</span></span><br><span class="line">    <span class="keyword">raise</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ZeroDivisionError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-95-1519a0755ccc&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      1 try:</span><br><span class="line">----&gt; 2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">      4     raise</span><br><span class="line"></span><br><span class="line">ZeroDivisionError: division by zero</span><br></pre></td></tr></table></figure><h2 id="æ€§èƒ½">æ€§èƒ½</h2><p>å¼•å…¥å¼‚å¸¸å¤„ç†ï¼Œä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½æŸè€—ï¼Œå¯¹äºå¯¹æ€§èƒ½æœ‰è¦æ±‚çš„ç¨‹åºï¼Œåº”è¯¥å¯¹å¯é¢„æµ‹çš„ç»“æœåšé€»è¾‘å¤„ç†ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ç”¨å¼‚å¸¸å¤„ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timer</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">       st = time.perf_counter()</span><br><span class="line">       func(*args, **kwargs)</span><br><span class="line">       end = time.perf_counter()</span><br><span class="line">       print(<span class="string">f'using <span class="subst">&#123;end - st&#125;</span>s'</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">div1</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span> / num</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">   </span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">div2</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span> / num</span><br><span class="line">      </span><br><span class="line">&gt; div1(<span class="number">0</span>)</span><br><span class="line">using <span class="number">4.4405460357666016e-06</span>s</span><br><span class="line"></span><br><span class="line">&gt; div2(<span class="number">0</span>)</span><br><span class="line">using <span class="number">1.341104507446289e-06</span>s</span><br></pre></td></tr></table></figure><p>ä¹Ÿè®¸ä¼šæœ‰äººè¯´ï¼Œæ—¢ç„¶ç”¨pythonäº†ï¼Œè¿˜åœ¨ä¹é‚£ç‚¹æ€§èƒ½ï¼Œæˆ‘æƒ³è¯´pythonæ€§èƒ½è°ƒä¼˜ä¹Ÿæ˜¯ä¸€ç§è¿½æ±‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#bltin-exceptions" target="_blank" rel="noopener">pythonå†…ç½®å¼‚å¸¸</a></p><p>[2] <a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">python cookbook</a></p>]]></content>
    
    <summary type="html">
    
      å¦‚ä½•ä½¿ç”¨pythonçš„å¼‚å¸¸å¤„ç†
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="exception" scheme="https://blog.smart-lifestyle.cn/tags/exception/"/>
    
  </entry>
  
  <entry>
    <title>github actionsåˆè¯•ç‰›åˆ€</title>
    <link href="https://blog.smart-lifestyle.cn/posts/9f77/"/>
    <id>https://blog.smart-lifestyle.cn/posts/9f77/</id>
    <published>2021-03-26T05:59:27.666Z</published>
    <updated>2021-03-26T06:43:18.224Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ€è¿‘å°†hexåšå®¢éƒ¨ç½²ç”±æ‰‹åŠ¨æ‰§è¡Œï¼Œæ”¹ä¸ºé€šè¿‡github actionsè‡ªåŠ¨éƒ¨ç½²ï¼Œè¿™é‡Œåšä¸‹è®°å½•</p></blockquote><h3 id="è‡ªåŠ¨éƒ¨ç½²åŸç†">è‡ªåŠ¨éƒ¨ç½²åŸç†</h3><p>ä½¿ç”¨github actionsåŠŸèƒ½ï¼Œå°†hexoç”Ÿæˆçš„é™æ€æ–‡ä»¶åœ¨æ¯æ¬¡æäº¤ä»£ç æ—¶ï¼Œé€šè¿‡scpå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><h3 id="ä½¿ç”¨æ­¥éª¤">ä½¿ç”¨æ­¥éª¤</h3><p><img src="https://oss.smart-lifestyle.cn/file/jl6ye.png" alt="image-20210326140634778"></p><p>åœ¨gitä»“åº“æ–°å¢actionsï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is a basic workflow to help you get started with Actions</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">CI</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Controls when the action will run. </span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="comment"># Triggers the workflow on push or pull request events but only for the master branch</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> <span class="string">[</span> <span class="string">master</span> <span class="string">]</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> <span class="string">[</span> <span class="string">master</span> <span class="string">]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Allows you to run this workflow manually from the Actions tab</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="comment"># This workflow contains a single job called "build"</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="comment"># The type of runner that the job will run on</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Steps represent a sequence of tasks that will be executed as part of the job</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># Runs a single command using the runners shell</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">a</span> <span class="string">one-line</span> <span class="string">script</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">echo</span> <span class="string">Hello,</span> <span class="string">world!</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># Runs a set of commands using the runners shell</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">a</span> <span class="string">multi-line</span> <span class="string">script</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">Add</span> <span class="string">other</span> <span class="string">actions</span> <span class="string">to</span> <span class="string">build,</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">test,</span> <span class="string">and</span> <span class="string">deploy</span> <span class="string">your</span> <span class="string">project.</span></span><br><span class="line">          <span class="string">ls</span></span><br><span class="line">          <span class="string">pwd</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">file</span> <span class="string">via</span> <span class="string">ssh</span> <span class="string">password</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">appleboy/scp-action@master</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">host:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HOST</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">username:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.USERNAME</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.PASSWORD</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">port:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.PORT</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">source:</span> <span class="string">"public/*,!public/robots.txt"</span></span><br><span class="line">          <span class="attr">target:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.TARGET_DIR</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>è¯´æ˜</p><ul><li><p>on è§¦å‘æ¡ä»¶</p><ul><li>push æ¨é€ç›®æ ‡ä»“åº“</li><li>pull_request åˆå¹¶åˆ†æ”¯ä»“åº“</li></ul></li><li><p>steps æ­¥éª¤</p><ul><li>uses: actions/checkout@v2 è·å–ä»£ç </li><li>uses: appleboy/scp-action@master ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œé€šè¿‡scp ä¼ è¾“æ–‡ä»¶<ul><li>host: $</li><li>username: $</li><li>password: $</li><li>port: $</li><li>source: â€œpublic/*,!public/robots.txtâ€</li><li>target: $</li></ul></li></ul></li></ul><p>ä¸Šé¢çš„secretsä¿¡æ¯åœ¨githubä¸Šè¿›è¡Œé…ç½®</p><p><img src="https://oss.smart-lifestyle.cn/file/oydi5.png" alt="image-20210326141554880"></p><p>æ¯å½“pushä»£ç åˆ°ä»“åº“masteråˆ†æ”¯æ—¶ï¼Œä¼šè¿›è¡Œæ‰§è¡Œactionsï¼Œè¿›è¡Œåšå®¢éƒ¨ç½²</p><p><img src="https://oss.smart-lifestyle.cn/file/jbae5.png" alt="image-20210326141938875"></p><h3 id="ä¸è¶³">ä¸è¶³</h3><ol><li>ç›®å‰æ²¡æœ‰é€šè¿‡github actionsç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¨é€ä¹‹å‰éœ€è¦æ‰‹åŠ¨æ‰§è¡Œhexo gï¼Œè¿™ä¸ªåœ¨è¿›ä¸€æ­¥ç ”ç©¶ä¹‹åå†å°è¯•</li><li>github æœ¬èº«å¯ä»¥æ·»åŠ Deploy keysï¼Œä¸ºäº†å®‰å…¨ï¼Œscpåº”è¯¥é¿å…ä½¿ç”¨å¯†ç è¿›è¡Œæ“ä½œï¼Œä¹Ÿåœ¨ç ”ç©¶æ˜ç™½ä¹‹åå†å°è¯•</li><li>ç”±äºé—®é¢˜1ï¼Œå°¤ä¸ºhexo gä¼šé‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œæ¯æ¬¡pushçš„æ—¶å€™ä¼šæœ‰å¤§é‡å¸¦æäº¤æ–‡ä»¶ã€‚ã€‚ã€‚</li></ol><h3 id="å‚è€ƒ">å‚è€ƒ</h3><p>[1] <a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html" target="_blank" rel="noopener">GitHub Actions å…¥é—¨æ•™ç¨‹</a></p><p>[2] <a href="https://github.com/appleboy/scp-action" target="_blank" rel="noopener">ğŸš€ SCP for GitHub Actions</a></p><p>[3] <a href="https://dev.to/miangame/how-to-automate-a-deploy-in-a-vps-with-github-actions-via-ssh-101e" target="_blank" rel="noopener">How to automate a deploy in a VPS with GitHub actions via SSH</a></p>]]></content>
    
    <summary type="html">
    
      é€šè¿‡github actionséƒ¨ç½²hexoåšå®¢
    
    </summary>
    
    
      <category term="éƒ¨ç½²" scheme="https://blog.smart-lifestyle.cn/categories/%E9%83%A8%E7%BD%B2/"/>
    
    
      <category term="github actions" scheme="https://blog.smart-lifestyle.cn/tags/github-actions/"/>
    
      <category term="hexo" scheme="https://blog.smart-lifestyle.cn/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€ -- timeä¸datetimeå¸¸è§ç”¨æ³•</title>
    <link href="https://blog.smart-lifestyle.cn/posts/3a95/"/>
    <id>https://blog.smart-lifestyle.cn/posts/3a95/</id>
    <published>2021-03-25T13:31:20.790Z</published>
    <updated>2021-03-29T08:45:32.021Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨HTTP APIæ¥å£ï¼Œä»¥åŠè·Ÿæ•°æ®åº“äº¤äº’æ—¶ç»å¸¸ç”¨åˆ°æ—¶é—´æˆ³ï¼ˆæ—¶é—´ï¼‰ï¼Œè¿™é‡Œæ•´ç†pythonä¸­å¸¸è§çš„timeã€datetimeç”¨æ³•ï¼Œä»¥åŠä¹‹é—´çš„ç›¸äº’è½¬åŒ–æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timezone</span><br></pre></td></tr></table></figure><h2 id="timeåŸºæœ¬ç”¨æ³•">timeåŸºæœ¬ç”¨æ³•</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰unixæ—¶é—´æˆ³ï¼Œè¿”å›å€¼ä¸ºfloat</span></span><br><span class="line">&gt; time.time()</span><br><span class="line"><span class="number">1615178606.6729627</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æœ¬åœ°æ—¶é—´ï¼ˆstruct timeï¼‰</span></span><br><span class="line">&gt; time.localtime()</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">8</span>, tm_hour=<span class="number">12</span>, tm_min=<span class="number">47</span>, tm_sec=<span class="number">12</span>, tm_wday=<span class="number">0</span>, tm_yday=<span class="number">67</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–UTCæ—¶é—´ï¼ˆstruct timeï¼‰</span></span><br><span class="line">&gt; time.gmtime()</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">8</span>, tm_hour=<span class="number">4</span>, tm_min=<span class="number">47</span>, tm_sec=<span class="number">25</span>, tm_wday=<span class="number">0</span>, tm_yday=<span class="number">67</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ¯«ç§’çº§Unix æ—¶é—´æˆ³ int</span></span><br><span class="line">&gt; int(time.time()*<span class="number">1000</span>)</span><br><span class="line"><span class="number">1615178896227</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç§’çº§Unix æ—¶é—´æˆ³ int</span></span><br><span class="line">&gt; int(time.time())</span><br><span class="line"><span class="number">1615178924</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Unix æ—¶é—´æˆ³ï¼ˆint/floatï¼‰è½¬åŒ–ä¸º struct time</span></span><br><span class="line">&gt; time.localtime(time.time())</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">21</span>, tm_min=<span class="number">44</span>, tm_sec=<span class="number">6</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># strcut time è½¬åŒ–ä¸º Unixæ—¶é—´æˆ³ï¼ˆfloatï¼‰</span></span><br><span class="line"><span class="comment"># ä¸»è¦mktimeçš„å‚æ•°åº”è¯¥æ˜¯localtimeï¼Œä¸èƒ½æ˜¯UTCtime</span></span><br><span class="line">&gt; time.mktime(time.localtime())</span><br><span class="line"><span class="number">1616680137.0</span></span><br></pre></td></tr></table></figure><h2 id="datetimeåŸºæœ¬ç”¨æ³•">datetimeåŸºæœ¬ç”¨æ³•</h2><ul><li>datetime(year, month, day[, hour[, minute[, second[, microsecond[,tzinfo]]]]])</li></ul><p><em>æ³¨æ„ï¼šç§’åé¢æ˜¯å¾®ç§’ï¼Œä¸æ˜¯æ¯«ç§’</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰æ—¶åˆ»çš„datetime</span></span><br><span class="line">&gt; datetime.now()</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">21</span>, <span class="number">59</span>, <span class="number">29</span>, <span class="number">534163</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰æ—¶åˆ»çš„UTC datetime</span></span><br><span class="line">&gt; datetime.utcnow()</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">803165</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰æ—¶åˆ»çš„Unix æ—¶é—´æˆ³, å‚æ•°ä¸º datetime</span></span><br><span class="line">&gt; datatime.timestamp(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">803165</span>))</span><br><span class="line"><span class="number">1616651979.803165</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°datetime,replace(year, month, day, hour, minute, second, microsecond...)</span></span><br><span class="line">&gt; datetime.now().replace(year=<span class="number">2022</span>)</span><br><span class="line">datetime.datetime(<span class="number">2022</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">21</span>, <span class="number">59</span>, <span class="number">29</span>, <span class="number">534163</span>)</span><br></pre></td></tr></table></figure><h3 id="iosformatç”¨æ³•">iosformatç”¨æ³•</h3><ul><li>isoformat(sep=â€˜Tâ€™, timespec=â€˜autoâ€™)</li></ul><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¾®ç§’å­˜åœ¨ï¼Œåˆ™è¾“å‡ºå¾®ç§’ï¼Œå¦‚æœå¾®ç§’ä¸º0ï¼Œåˆ™å¾®ç§’ä¼šè¢«å¿½ç•¥ï¼Œè€Œä¸æ˜¯è¾“å‡º0</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ä¿®æ”¹é»˜è®¤å‚æ•°æ—¶ï¼Œè¿”å›æ ¼å¼åŒ–å­—ç¬¦ä¸²</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">803165</span>))</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.803165'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¯æŒä¸¤ä¸ªå‚æ•°ï¼Œsepï¼Œ timespec</span></span><br><span class="line"><span class="comment"># sep é»˜è®¤ä¸º'T'ï¼Œå³ç”¨Tåšåˆ†éš”ç¬¦</span></span><br><span class="line"><span class="comment"># timespecé»˜è®¤ä¸º'auto', å¯ä»¥ä¸º'hours', 'seconds', 'milliseconds', 'microseconds'</span></span><br><span class="line"><span class="comment"># è¾“å‡ºå¸¦å¾®ç§’</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1</span>))</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000001'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾®ç§’è¢«å¿½ç•¥</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">0</span>))</span><br><span class="line"><span class="string">'2021-03-25T13:59:39'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœtimespecä¸ºmillisecondsï¼Œå°äº1msä¼šè¾“å‡º000</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">2</span>), timespec=<span class="string">'milliseconds'</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰äº0æ—¶ï¼Œä¹Ÿä¼šè¾“å‡º000</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>), timespec=<span class="string">'milliseconds'</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>), timespec=<span class="string">'milliseconds'</span>, sep=<span class="string">' '</span>)</span><br><span class="line"><span class="string">'2021-03-25 13:59:39.001'</span></span><br></pre></td></tr></table></figure><h3 id="timedelta">timedelta</h3><ul><li>datetime.timedelta(days, seconds, microseconds, minutes, hours, weeks)</li></ul><p>ä¸¤ä¸ªdatetimeç›´æ¥çš„æ—¶é—´é—´éš”</p><blockquote><p>åªæœ‰ <em>days</em>,<em>seconds</em> å’Œ <em>microseconds</em> ä¼šå­˜å‚¨åœ¨å†…éƒ¨ï¼Œå³pythonå†…éƒ¨ä»¥ <em>days</em>,<em>seconds</em> å’Œ <em>microseconds</em> ä¸‰ä¸ªå•ä½ä½œä¸ºå­˜å‚¨çš„åŸºæœ¬å•ä½ã€‚å‚æ•°å•ä½è½¬æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>1æ¯«ç§’ä¼šè½¬æ¢æˆ1000å¾®ç§’ã€‚</li><li>1åˆ†é’Ÿä¼šè½¬æ¢æˆ60ç§’ã€‚</li><li>1å°æ—¶ä¼šè½¬æ¢æˆ3600ç§’ã€‚</li><li>1æ˜ŸæœŸä¼šè½¬æ¢æˆ7å¤©ã€‚</li></ul></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¯”å½“å‰æ—¶åˆ»å°‘1å¤©5åˆ†é’Ÿ</span></span><br><span class="line">&gt; datetime.now() + timedelta(days=<span class="number">-1</span>, minutes=<span class="number">-5</span>)</span><br><span class="line">&gt; datetime.now() - timedelta(days=<span class="number">1</span>, minutes=<span class="number">5</span>)</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">41</span>, <span class="number">10</span>, <span class="number">557550</span>)</span><br></pre></td></tr></table></figure><h3 id="timezone-astimezone">timezone/astimezone</h3><p>å°†UTCæ—¶é—´è½¬åŒ–ä¸ºæœ¬åœ°æ—¶é—´</p><blockquote><p>å‡å¦‚æ•°æ®åº“å­˜å‚¨çš„æ—¶é—´æˆ³éƒ½æ˜¯UTCæ—¶é—´ï¼Œå¦‚æœå®¢æˆ·ç«¯è·å–åˆ°åï¼Œè½¬åŒ–ä¸ºæœ¬åœ°æ—¶é—´ï¼Œå¯ä»¥å€ŸåŠ©timezoneå’Œastimezone</p><p>ç®€å•å¯ä»¥ä½¿ç”¨timedelta(hours=Â±8)è¿›è¡ŒåŒ—äº¬æ—¶é—´å’ŒUTCæ—¶é—´è½¬æ¢</p></blockquote><p>å…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–ä¸€ä¸ªUTCæ—¶é—´</span></span><br><span class="line">&gt; date = datetime.utcnow()</span><br><span class="line">&gt; date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">240199</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ‰è¶£çš„æ—¶ï¼Œå¦‚æœæ­¤æ—¶è·å–tzinfoï¼Œä¸æ˜¯utcï¼Œè€Œæ˜¯None</span></span><br><span class="line">&gt; date.tzinfo</span><br><span class="line"><span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å› æ­¤å…ˆç»™å®ƒèµ‹å€¼ä¸€ä¸ªUTC timezone</span></span><br><span class="line">&gt; new = date.replace(tzinfo=timezone.utc)</span><br><span class="line">&gt; new</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">240199</span>, tzinfo=datetime.timezone.utc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># astimezone æ¥å—ä¸€ä¸ªtzå‚æ•°ï¼Œé»˜è®¤ä¸ºNoneï¼Œä¸ºNoneæ—¶ï¼Œè½¬åŒ–ä¸ºæœ¬åœ°æ—¶é—´</span></span><br><span class="line"><span class="comment"># 28800 = 8h * 3600</span></span><br><span class="line">&gt; new.astimezone()</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">240199</span>, tzinfo=datetime.timezone(datetime.timedelta(seconds=<span class="number">28800</span>), <span class="string">'CST'</span>))</span><br></pre></td></tr></table></figure><p>æœ¬åœ°æ—¶é—´è½¬åŒ–ä¸ºutcæ—¶é—´</p><blockquote><p>å†™å…¥åˆ°æ•°æ®åº“æ—¶ï¼Œéœ€è¦å°†å®é™…è½¬åŒ–ä¸ºUTCæ—¶é—´</p><p>æ–¹æ³•ä¸€ï¼šé€šè¿‡astimezoneè½¬æ¢ï¼Œ<a href="http://%E6%AD%A4%E6%97%B6tz=timezone.info" target="_blank" rel="noopener">æ­¤æ—¶tz=timezone.info</a></p><p>æ–¹æ³•äºŒï¼šå€ŸåŠ©äºfromtimestamp/utcfromtimestampè½¬æ¢</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–ä¸€ä¸ªæœ¬åœ°æ—¶é—´</span></span><br><span class="line">&gt; localdate = datetime.now()</span><br><span class="line">&gt; localdate</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•1ï¼Œç»™datetimeåŠ ä¸Šæ—¶åŒºä¿¡æ¯ï¼Œç„¶åé€šè¿‡astimezoneè½¬æ¢</span></span><br><span class="line">&gt; new_localdate = localdate.replace(tzinfo=timezone(timedelta(seconds=<span class="number">28800</span>)))</span><br><span class="line">&gt; new_localdate</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>, tzinfo=datetime.timezone(datetime.timedelta(seconds=<span class="number">28800</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬åŒ–æ—¶åŒº</span></span><br><span class="line">&gt; utc_date = new_localdate.astimezone(tz=timezone.utc)</span><br><span class="line">&gt; utc_date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>, tzinfo=datetime.timezone.utc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2ï¼Œå€ŸåŠ©äºtimestampè½¬æ¢</span></span><br><span class="line">&gt; timestamp = localdate.timestamp()</span><br><span class="line">&gt; utc_date = datetime.utcfromtimestamp(timestamp)</span><br><span class="line">&gt; utc_date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>)</span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨fromtimestamp åŠ ä¸Šæ—¶åŒºå‚æ•°</span></span><br><span class="line">&gt; utc_date = datetime.fromtimestamp(timestamp, tz=timezone.utc)</span><br><span class="line">&gt; utc_date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>, tzinfo=datetime.timezone.utc)</span><br></pre></td></tr></table></figure><h2 id="strä¸datetimeäº’è½¬">strä¸datetimeäº’è½¬</h2><ul><li><p>datetime.strptime(string, format) å°†å­—ç¬¦ä¸²æ—¶é—´è½¬ä¸ºdatetime</p></li><li><p>datetime.strftime(format) å°†datetimeè½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ—¶é—´</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># str --&gt; datetime</span></span><br><span class="line"><span class="comment"># '2021-03-25T13:59:39.001'</span></span><br><span class="line">&gt; datetime_str = datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>), timespec=<span class="string">'milliseconds'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># %f ç”¨äºæ ¼å¼åŒ–å¾®ç§’</span></span><br><span class="line">&gt; datetime.strptime(datetime_str, <span class="string">"%Y-%m-%dT%H:%M:%S.%f"</span>)</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># datetime --&gt; str</span></span><br><span class="line"><span class="comment"># æ¨èç¬¬ä¸€ç§ç”¨ä¸Šé¢æåˆ°çš„isoformat</span></span><br><span class="line"><span class="comment"># ç¬¬äºŒç§ä½¿ç”¨strftime</span></span><br><span class="line">&gt; datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>).strftime(format=<span class="string">"%Y-%m-%dT%H:%M:%S.%f"</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.001000'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å¾®ç§’è¾“å‡ºä¸º000</span></span><br><span class="line">&gt; datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>).strftime(format=<span class="string">"%Y-%m-%dT%H:%M:%S.000"</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000'</span></span><br></pre></td></tr></table></figure><h2 id="strä¸timeäº’è½¬">strä¸timeäº’è½¬</h2><ul><li><p>time.strftime(format[,t]) å°†timeæ¢ä½ä¸ºå­—ç¬¦ä¸²æ—¶é—´ï¼Œå¦‚æœt(time)æœªæä¾›ï¼Œåˆ™ä½¿ç”¨locatime()è·å–å½“å‰æ—¶é—´</p></li><li><p>time.strptime(string[,format]) å°†å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢ä¸º struct time</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># local time</span></span><br><span class="line"><span class="comment"># time.struct_time(tm_year=2021, tm_mon=3, tm_mday=25, tm_hour=23, tm_min=12, tm_sec=10, tm_wday=3, tm_yday=84, tm_isdst=0)</span></span><br><span class="line">&gt; now = time.localtime()</span><br><span class="line"></span><br><span class="line"><span class="comment"># time --&gt; str</span></span><br><span class="line"><span class="comment"># è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ—¶é—´, ä¸æ”¯æŒå¾®ç§’</span></span><br><span class="line">&gt; time.strftime( <span class="string">"%Y-%m-%dT%H:%M:%S"</span>, now)</span><br><span class="line"><span class="string">'2021-03-25T23:12:10'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># str --&gt; time</span></span><br><span class="line"><span class="comment"># å°†å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢ä¸º struct time</span></span><br><span class="line">&gt; time.strptime(time.strftime( <span class="string">"%Y-%m-%dT%H:%M:%S"</span>, now), <span class="string">"%Y-%m-%dT%H:%M:%S"</span>)</span><br><span class="line"></span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">23</span>, tm_min=<span class="number">12</span>, tm_sec=<span class="number">10</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">-1</span>)</span><br></pre></td></tr></table></figure><h2 id="timeä¸datetimeäº’è½¬">timeä¸datetimeäº’è½¬</h2><ul><li><p>datetime.timetuple(datetime) å°†datetimeè½¬åŒ–ä¸º struct time</p></li><li><p>datetime.fromtimestamp(unixæ—¶é—´æˆ³) å°†unixæ—¶é—´æˆ³è½¬åŒ–ä¸ºdatetime</p></li><li><p>datetime.timestamp() å°†datetimeè½¬åŒ–ä¸ºunix æ—¶é—´æˆ³</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># time --&gt; datetime</span></span><br><span class="line"><span class="comment"># ç¬¬ä¸€ç§ unix æ—¶é—´æˆ³ è½¬åŒ–ä¸º datetime</span></span><br><span class="line">&gt; datetime.fromtimestamp(time.time())</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">33</span>, <span class="number">548042</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒç§ struct timeè½¬åŒ–ä¸º datetime</span></span><br><span class="line">&gt; datetime.fromtimestamp(time.mktime(time.localtime()))</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># datetime --&gt; time</span></span><br><span class="line"><span class="comment"># ç¬¬ä¸€ç§ä½¿ç”¨timetuple</span></span><br><span class="line">&gt; datetime.timetuple(datetime.now())</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">23</span>, tm_min=<span class="number">33</span>, tm_sec=<span class="number">9</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒç§ä½¿ç”¨Unixæ—¶é—´æˆ³</span></span><br><span class="line">&gt; time.localtime(datetime.timestamp(datetime.now()))</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">23</span>, tm_min=<span class="number">34</span>, tm_sec=<span class="number">6</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h1>å‚è€ƒ</h1><p>[1] <a href="https://pythontic.com/datetime/datetime/isoformat" target="_blank" rel="noopener">Isoformat() Method Of Datetime Class In Python</a></p><p>[2] <a href="https://docs.python.org/zh-cn/3.7/library/datetime.html" target="_blank" rel="noopener">datetime â€” åŸºæœ¬çš„æ—¥æœŸå’Œæ—¶é—´ç±»å‹</a></p><p>[3] <a href="https://docs.python.org/zh-cn/3/library/time.html" target="_blank" rel="noopener">time â€” æ—¶é—´çš„è®¿é—®å’Œè½¬æ¢</a></p><p>[4] <a href="https://docs.python.org/zh-cn/3.7/library/datetime.html#strftime-and-strptime-behavior" target="_blank" rel="noopener">strftime() å’Œ strptime()çš„è¡Œä¸º</a></p><p>[5] <a href="https://stackoverflow.com/questions/4563272/convert-a-python-utc-datetime-to-a-local-datetime-using-only-python-standard-lib/13287083#13287083" target="_blank" rel="noopener">Convert a python UTC datetime to a local datetime</a></p>]]></content>
    
    <summary type="html">
    
      strã€timeã€datetimeä¹‹é—´çš„è½¬æ¢
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>python web -- pydanticåŸºç¡€ç”¨æ³•-1</title>
    <link href="https://blog.smart-lifestyle.cn/posts/e075/"/>
    <id>https://blog.smart-lifestyle.cn/posts/e075/</id>
    <published>2021-03-03T14:39:18.126Z</published>
    <updated>2021-03-29T15:37:09.214Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½¿ç”¨pydanticæ ¡éªŒè¾“å…¥å‚æ•°ï¼Œå¯ä»¥çœå»åç»­å‡½æ•°ä½“å†…çš„æ ¡éªŒï¼Œå¹¶å¯ä»¥ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ ¡éªŒå™¨æ–¹ä¾¿å…¶ä»–æ–¹æ³•è°ƒç”¨ï¼Œåšçš„å…¥å‚æ ¡éªŒä¸å…¥å‚è°ƒç”¨çš„è§£è€¦</p><p>è‘—åçš„FastAPIæ¡†æ¶ï¼Œä¹Ÿæ˜¯ä½¿ç”¨çš„pydanticä½œä¸ºhttpè¯·æ±‚ä¸­å‚æ•°çš„æ ¡éªŒ</p></blockquote><h3 id="å®‰è£…">å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># need python3.6+</span></span><br><span class="line">pip install pydantic -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure><h3 id="åŸºæœ¬æ¨¡å‹ç”¨æ³•">åŸºæœ¬æ¨¡å‹ç”¨æ³•</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># model.py</span></span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, validator</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ¨¡å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionRequest</span><span class="params">(BaseModel)</span>:</span></span><br><span class="line">    bearer_token: str = <span class="literal">None</span></span><br><span class="line">    validDateTime: str = <span class="literal">None</span></span><br><span class="line">    validPeriodTime: int = <span class="number">12</span></span><br><span class="line">    count: int = <span class="number">200</span></span><br><span class="line">    deviceTypeId: int = <span class="number">2</span></span><br><span class="line">    subscriptionLevelId: int = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å¾—jsonæ ¼å¼å†…å®¹ï¼Œä¸è¿”è¿˜bearer_token</span></span><br><span class="line">    <span class="comment"># def data_json(self):</span></span><br><span class="line">    <span class="comment">#    return self.json(exclude=&#123;'bearer_token'&#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ¡éªŒå‚æ•°</span></span><br><span class="line">    <span class="comment"># @validator('validDateTime')</span></span><br><span class="line">    <span class="comment"># def create_default_date(cls, v):</span></span><br><span class="line">    <span class="comment">#    if v is None:</span></span><br><span class="line">    <span class="comment">#        v = get_default_valid_datetime().strftime("%Y-%m-%dT23:59:59.000Z")</span></span><br><span class="line">    <span class="comment">#    return v</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºç»™æ¨¡å‹ä¸­æ¯ä¸ªå­—æ®µéƒ½è®¾ç½®äº†é»˜è®¤å€¼ï¼Œåœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°æ—¶ä¹Ÿä¸ä¼šæŠ¥é”™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="keyword">from</span> model <span class="keyword">import</span> SubscriptionRequest</span><br><span class="line">&gt;&gt; m = SubscriptionRequest()</span><br><span class="line">&gt;&gt; print(m)</span><br><span class="line">bearer_token=<span class="literal">None</span> validDateTime=<span class="literal">None</span> validPeriodTime=<span class="number">12</span> count=<span class="number">200</span> deviceTypeId=<span class="number">2</span> subscriptionLevelId=<span class="number">2</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å°†æ¨¡å‹æ–‡ä»¶ä¸­ä¸€äº›å‚æ•°é»˜è®¤å€¼å»æ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># model.py</span></span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, validator</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ¨¡å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionRequest</span><span class="params">(BaseModel)</span>:</span></span><br><span class="line">    bearer_token: str</span><br><span class="line">    validDateTime: str</span><br><span class="line">    validPeriodTime: int = <span class="number">12</span></span><br><span class="line">    count: int = <span class="number">200</span></span><br><span class="line">    deviceTypeId: int = <span class="number">2</span></span><br><span class="line">    subscriptionLevelId: int = <span class="number">2</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ç»§ç»­æ‰§è¡Œï¼Œå°†ä¼šæç¤ºå‚æ•°ç¼ºå¤±</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="keyword">from</span> model <span class="keyword">import</span> SubscriptionRequest</span><br><span class="line">&gt;&gt; m = SubscriptionRequest()</span><br><span class="line">&gt;&gt; print(m)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"/Users/simple/workspace/Columbus/admin_tools/serializer.py"</span>, line <span class="number">60</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    m = SubscriptionRequest()</span><br><span class="line">  File <span class="string">"pydantic/main.py"</span>, line <span class="number">391</span>, <span class="keyword">in</span> pydantic.main.BaseModel.__init__</span><br><span class="line">pydantic.error_wrappers.ValidationError: <span class="number">2</span> validation errors <span class="keyword">for</span> SubscriptionRequest</span><br><span class="line">bearer_token</span><br><span class="line">  field required (type=value_error.missing)</span><br><span class="line">validDateTime</span><br><span class="line">  field required (type=value_error.missing)</span><br></pre></td></tr></table></figure><p>æ­£å¸¸ç”¨æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; data= &#123;</span><br><span class="line"><span class="meta">... </span>       <span class="string">'bearer_token'</span>: <span class="string">'1234567=='</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'validDateTime'</span>: <span class="literal">None</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'validPeriodTime'</span>: <span class="number">12</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'count'</span>: <span class="number">12</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'deviceTypeId'</span>: <span class="number">2</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'subscriptionLevelId'</span>: <span class="number">2</span></span><br><span class="line"><span class="meta">... </span>   &#125;</span><br><span class="line">&gt;&gt; m = SubscriptionRequest(**data)</span><br><span class="line">&gt;&gt; print(m)</span><br><span class="line">bearer_token=<span class="string">'1234567=='</span> validDateTime=<span class="string">'2022-09-01T23:59:59.000Z'</span> validPeriodTime=<span class="number">12</span> count=<span class="number">12</span> deviceTypeId=<span class="number">2</span> subscriptionLevelId=<span class="number">2</span></span><br><span class="line"><span class="comment"># è¾“å‡ºjsonæ ¼å¼</span></span><br><span class="line">&gt;&gt; m.json()</span><br><span class="line">&#123;<span class="string">"bearer_token"</span>: <span class="string">"1234567=="</span>, <span class="string">"validDateTime"</span>: <span class="string">"2022-09-01T23:59:59.000Z"</span>, <span class="string">"validPeriodTime"</span>: <span class="number">12</span>, <span class="string">"count"</span>: <span class="number">12</span>, <span class="string">"deviceTypeId"</span>: <span class="number">2</span>, <span class="string">"subscriptionLevelId"</span>: <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢è¿”å›jsonç»“æœä¸­ï¼Œé™¤äº†bearer_tokenï¼Œå…¶ä»–éƒ½æ˜¯è¦èµ‹å€¼ç»™body jsonï¼Œå› æ­¤æƒ³åœ¨jsonè¾“å‡ºä¸­å»é™¤</p><p><code>bearer_token</code></p><p>åœ¨æ¨¡å‹ç±»ä¸­å¢åŠ å¦‚ä¸‹æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è·å¾—jsonæ ¼å¼å†…å®¹ï¼Œä¸è¿”è¿˜bearer_token</span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">data_json</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.json(exclude=&#123;<span class="string">'bearer_token'</span>&#125;)</span><br></pre></td></tr></table></figure><p>åŒæ ·å¦‚æœæƒ³å¯¹è¾“å…¥çš„å‚æ•°åšå…·ä½“æ ¡éªŒï¼ŒvalidDateTimeå¦‚æœä¸ºNoneï¼Œå°±ä¸ºå®ƒèµ‹å€¼ä¸€ä¸ªæ—¶é—´æˆ³</p><p>åœ¨æ¨¡å‹ç±»ä¸­å¢åŠ ä¸€ä¸ªvalidator</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ ¡éªŒå‚æ•°</span></span><br><span class="line"><span class="meta">     @validator('validDateTime')</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">create_default_date</span><span class="params">(cls, v)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            v = get_default_valid_datetime().strftime(<span class="string">"%Y-%m-%dT23:59:59.000Z"</span>)</span><br><span class="line">        <span class="keyword">return</span> v</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_default_valid_datetime</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    é»˜è®¤æœ‰æ•ˆæœŸæ—¶é—´ä¸ºå½“å‰æ—¶é—´+1å¹´åŠ</span></span><br><span class="line"><span class="string">    :return: æ—¶é—´æˆ³å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    diff = <span class="number">365</span> + int(<span class="number">365</span>/<span class="number">2</span>)</span><br><span class="line">    valid_datetime = datetime.utcnow() + timedelta(days=diff)</span><br><span class="line">    <span class="comment"># return valid_datetime.strftime("%Y-%m-%dT23:59:59.000Z")</span></span><br><span class="line">    <span class="keyword">return</span> valid_datetime</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯validatorè£…é¥°çš„ä¸ºç±»å‡½æ•°ï¼Œå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºclsï¼Œä¸æ˜¯selfï¼Œå¦å¤–è¿™ä¸ªå‡½æ•°è¿˜æœ‰å…¶ä»–å‚æ•°</p><ul><li><p>v ä¸ºå½“å‰å‚æ•°çš„å€¼</p></li><li><p>valuesä¸ºå½“å‰ä¼ é€’åˆ°æ¨¡å‹æ‰€æœ‰å‚æ•°çš„å­—å…¸é›†åˆï¼Œæ¯”å¦‚é€šè¿‡values[â€˜countâ€™] æ¥è·å–countçš„å€¼</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@validator('validDateTime')</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">create_default_date</span><span class="params">(cls, v, values, **kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><strong>å¦å¤–å¦‚æœæ ¡éªŒçš„å‚æ•°æ²¡æœ‰ä¼ é€’ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªé»˜è®¤å€¼ï¼Œä¸ä¼šè°ƒç”¨æ ¡éªŒæ–¹æ³•</strong></p><h3 id="å‚è€ƒ">å‚è€ƒ</h3><p>[1] <a href="https://pydantic-docs.helpmanual.io/usage/validators/" target="_blank" rel="noopener">pydantic validators</a></p><p>[2] <a href="https://pydantic-docs.helpmanual.io/usage/exporting_models/#json_encoders" target="_blank" rel="noopener">export json</a></p><p>[3] <a href="https://pydantic-docs.helpmanual.io/install/" target="_blank" rel="noopener">install</a></p><p>[4] <a href="https://pydantic-docs.helpmanual.io/usage/models/" target="_blank" rel="noopener">basic models</a></p>]]></content>
    
    <summary type="html">
    
      ä½¿ç”¨pydanticå¯¹å…¥å‚æ ¡éªŒ
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="pydantic" scheme="https://blog.smart-lifestyle.cn/tags/pydantic/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€ -- pythonä¸excel-1</title>
    <link href="https://blog.smart-lifestyle.cn/posts/df7e/"/>
    <id>https://blog.smart-lifestyle.cn/posts/df7e/</id>
    <published>2021-03-02T05:20:11.240Z</published>
    <updated>2021-03-30T14:33:16.326Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>ä½¿ç”¨openpyxlå¯¹excelæ–‡ä»¶è¿›è¡Œè¯»å†™</p><p><a href="https://openpyxl.readthedocs.io/en/stable/tutorial.html" target="_blank" rel="noopener">å®˜æ–¹æŒ‡å¯¼æ–‡æ¡£</a></p></blockquote><h2 id="å‡†å¤‡">å‡†å¤‡</h2><h3 id="excelåŸºæœ¬æœ¯è¯­">excelåŸºæœ¬æœ¯è¯­</h3><table><thead><tr><th>æœ¯è¯­</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>Spreadsheet or Workbook</td><td>excelæ–‡ä»¶</td></tr><tr><td>Worksheet or Sheet</td><td>è¡¨ï¼Œä¸€ä¸ªworkbook/spreadsheetå¯ä»¥æœ‰å¤šä¸ªsheet</td></tr><tr><td>Column</td><td>è¡¨æ ¼åˆ—Aâ€¦Zâ€¦</td></tr><tr><td>Row</td><td>è¡¨æ ¼è¡Œ1â€¦10â€¦</td></tr><tr><td>Cell</td><td>å•å…ƒæ ¼A1â€¦A2â€¦</td></tr></tbody></table><h3 id="å®‰è£…openpyxl">å®‰è£…openpyxl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install openpyxl -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure><h2 id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</h2><h3 id="æ–°å»ºworkbook">æ–°å»ºworkbook</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line">wb = Workbook()</span><br></pre></td></tr></table></figure><h3 id="åŠ è½½å·²ç»å­˜åœ¨çš„å·¥ä½œç°¿">åŠ è½½å·²ç»å­˜åœ¨çš„å·¥ä½œç°¿</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line">wb = load_workbook(<span class="string">'File Name'</span>)</span><br></pre></td></tr></table></figure><h3 id="é€‰æ‹©sheet">é€‰æ‹©sheet</h3><p>é»˜è®¤Workbookåˆ›å»ºæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªsheetï¼Œé€šè¿‡<code>ws = wb.active</code> é€‰æ‹©å¹¶ä½¿ç”¨å®ƒ</p><p>å­˜åœ¨å¤šä¸ªsheetæ—¶ï¼Œå¯ä»¥é€šè¿‡<code>ws = wb[Sheet Name]</code> é€‰æ‹©æ‰€æœ‰æ“ä½œçš„sheetï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ“ä½œé€‰æ‹©</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰æ‰€æœ‰sheetname</span></span><br><span class="line">sheetlist = wb.sheetnames</span><br><span class="line"><span class="comment"># &gt;&gt; ['1st Sheet', 'æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic', 'æ ‡ç­¾å†…å®¹ä¿¡æ¯ -Standard', 'Readme', 'Add your sheets and content...']</span></span><br><span class="line">ws = wb[sheetlist[<span class="number">2</span>]] <span class="comment"># æˆ–è€…</span></span><br><span class="line">ws.active = <span class="number">2</span></span><br><span class="line">ws = wb.active</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰sheetåå­—</span></span><br><span class="line">ws.title</span><br><span class="line">&gt;&gt; æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic</span><br></pre></td></tr></table></figure><p><code>ws = wb[Sheet Name]</code> æ–¹æ³•æ²¡æœ‰æ”¹å˜å½“å‰æ´»è·ƒçš„è¡¨æ ¼å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wb.active</span><br><span class="line">&gt;&gt; &lt;Worksheet <span class="string">"æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic"</span>&gt;</span><br><span class="line">ws = wb[<span class="string">'æ ‡ç­¾å†…å®¹ä¿¡æ¯ -Standard'</span>]</span><br><span class="line">wb.active <span class="comment"># è¿˜æ˜¯è¿æ¥çš„å•å…ƒæ ¼</span></span><br><span class="line">&gt;&gt; &lt;Worksheet <span class="string">"æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic"</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="æ–°å»ºsheet">æ–°å»ºsheet</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤æ’åœ¨æœ€åä½ç½®</span></span><br><span class="line">ws = wb.create_sheet(<span class="string">'Sheet Name'</span>)</span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥åœ¨sheet nameå‚æ•°åå¢åŠ ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºåˆ›å»ºä½ç½®</span></span><br><span class="line">ws = wb.create_sheet(<span class="string">'Sheet Name'</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹sheet-tittle">ä¿®æ”¹sheet tittle</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.title = New Title</span><br></pre></td></tr></table></figure><h3 id="å†™å…¥å•å…ƒæ ¼">å†™å…¥å•å…ƒæ ¼</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ws[<span class="string">'A1'</span>] = <span class="string">'Name'</span></span><br><span class="line">ws[<span class="string">'B1'</span>] = <span class="string">'Age'</span></span><br><span class="line">ws[<span class="string">'C1'</span>] = <span class="string">'score'</span></span><br><span class="line">ws[<span class="string">'A2'</span>] = <span class="string">'å¼ ä¸‰'</span></span><br><span class="line">ws[<span class="string">'B2'</span>] = <span class="number">18</span></span><br><span class="line">ws[<span class="string">'C3'</span>] = <span class="number">95</span></span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å•å…ƒæ ¼å†…å®¹">æŸ¥çœ‹å•å…ƒæ ¼å†…å®¹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ws[<span class="string">'A2'</span>].value</span><br><span class="line">&gt;&gt; <span class="string">'å¼ ä¸‰'</span></span><br></pre></td></tr></table></figure><h3 id="ä¿å­˜æ–‡ä»¶-å·¥ä½œç°¿">ä¿å­˜æ–‡ä»¶/å·¥ä½œç°¿</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœfilenameå·²ç»å­˜åœ¨ï¼Œä¼šæ²¡æœ‰ç¡®è®¤çš„ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line">wb.save(filename)</span><br></pre></td></tr></table></figure><h3 id="å…³é—­å·¥ä½œç°¿">å…³é—­å·¥ä½œç°¿</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯èƒ½æ²¡æœ‰ç”¨ï¼Ÿ</span></span><br><span class="line">wb.close()</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] <a href="https://openpyxl.readthedocs.io/en/stable/tutorial.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p><p>[2] <a href="https://stackoverflow.com/questions/41556378/openpyxl-set-active-sheet/50117733" target="_blank" rel="noopener">é€‰æ‹©sheet</a></p><p>[3] <a href="https://realpython.com/openpyxl-excel-spreadsheets-python/" target="_blank" rel="noopener">realpython openpyxl guide</a></p>]]></content>
    
    <summary type="html">
    
      ä½¿ç”¨openpyxlå¯¹excelè¯»å†™æ“ä½œ
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="excel" scheme="https://blog.smart-lifestyle.cn/tags/excel/"/>
    
  </entry>
  
  <entry>
    <title>shellå˜é‡ä¸ç¯å¢ƒå˜é‡</title>
    <link href="https://blog.smart-lifestyle.cn/posts/77ae/"/>
    <id>https://blog.smart-lifestyle.cn/posts/77ae/</id>
    <published>2021-02-27T02:14:32.000Z</published>
    <updated>2021-02-27T14:18:53.188Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Shell å˜é‡åªåœ¨ä¸»shellæœ‰æ•ˆï¼Œå­è¿›ç¨‹æ— æ•ˆï¼Œç¯å¢ƒå˜é‡åœ¨ä¸»shellå’Œå­è¿›ç¨‹éƒ½æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡exportå‘½ä»¤å°†shellå˜é‡å˜ä¸ºç¯å¢ƒå˜é‡</p><p>ä½¿ç”¨setå‘½ä»¤æŸ¥çœ‹shellå˜é‡</p><p>ä½¿ç”¨printenvå‘½ä»¤æŸ¥çœ‹ç¯å¢ƒå˜é‡</p></blockquote><a id="more"></a><h2 id="èƒŒæ™¯">èƒŒæ™¯</h2><p>åœ¨pythonå·¥ç¨‹ä¸­ï¼Œæƒ³é€šè¿‡ç¯å¢ƒå˜é‡è·å–å‚æ•°å€¼ï¼Œå¹¶èµ‹å€¼ç»™pythonå˜é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(<span class="string">f"PID: <span class="subst">&#123;os.getpid()&#125;</span>, PPID: <span class="subst">&#123;os.getppid()&#125;</span>"</span>)</span><br><span class="line">host = os.getenv(<span class="string">'REDIS_HOST'</span>)</span><br><span class="line">port = os.getenv(<span class="string">'REDIS_PORT'</span>)</span><br><span class="line">password = os.getenv(<span class="string">'REDIS_PASSWORD'</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f"<span class="subst">&#123;password&#125;</span>@<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>"</span>)</span><br></pre></td></tr></table></figure><p>è€Œå‚æ•°å€¼æ”¾åœ¨ä¸€ä¸ªenvæ–‡ä»¶é‡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">REDIS_HOST=example.com</span><br><span class="line">REDIS_PORT=5432</span><br><span class="line">REDIS_PASSWORD=123456</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ‰§è¡Œ<code>source .env</code> ååœ¨ç»ˆç«¯æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$REDIS_HOST</span> <span class="variable">$REDIS_PORT</span> <span class="variable">$REDIS_PASSWORD</span></span><br><span class="line">&gt; example.com 5432 123456</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰shell pid</span></span><br><span class="line"><span class="built_in">echo</span> $$</span><br><span class="line">&gt; 22650</span><br><span class="line"><span class="comment"># è¿è¡Œpython æ–‡ä»¶</span></span><br><span class="line">python variables.py</span><br><span class="line">&gt; PID: 23034, PPID: 22650</span><br><span class="line">&gt; None@None:None</span><br></pre></td></tr></table></figure><p>å‘ç°pythonå¹¶æœªè·å–åˆ°å­˜åœ¨shellç¯å¢ƒå˜é‡ä¸­çš„å€¼ï¼Œpythonè¿è¡Œçš„çˆ¶è¿›ç¨‹å·ä¸ºå½“å‰shellçš„è¿›ç¨‹å·ï¼Œè€Œå½“æ—¶pythonè¿è¡Œæ˜¯åœ¨å­è¿›ç¨‹ä¸­è¿è¡Œ</p><p>ä»¥ä¸Šçš„<code>souce .env</code>æ“ä½œæ˜¯å°†å˜é‡å­˜å…¥åˆ°shellå˜é‡ä¸­ï¼Œä½†æœªåœ¨ç¯å¢ƒå˜é‡ä¸­</p><h2 id="shellå˜é‡å’Œç¯å¢ƒå˜é‡">shellå˜é‡å’Œç¯å¢ƒå˜é‡</h2><p>For <a href="http://www.ee.surrey.ac.uk/Teaching/Unix/unix8.html" target="_blank" rel="noopener">Standard UNIX variables</a> , says:</p><blockquote><p>Standard UNIX variables are split into two categories, environment variables and shell variables. In broad terms, shell variables apply only to the current instance of the shell and are used to set short-term working conditions; environment variables have a farther reaching significance, and those set at login are valid for the duration of the session. By convention, environment variables have UPPER CASE and shell variables have lower case names.</p><p>æ ‡å‡†UNIXå˜é‡åˆ†ä¸ºä¸¤ç±»ï¼šç¯å¢ƒå˜é‡å’Œshellå˜é‡ï¼Œshellå˜é‡ä»…åœ¨å½“å‰shellï¼ˆä¸»è¿›ç¨‹ï¼‰æœ‰æ•ˆï¼Œç¯å¢ƒå˜é‡å¯ä»¥åœ¨å­è¿›ç¨‹æœ‰æ•ˆï¼Œé€šå¸¸ç¯å¢ƒå˜é‡ä¸ºå¤§å†™ï¼Œshellå˜é‡ä¸ºå°å†™</p></blockquote><p>For <a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_05_03" target="_blank" rel="noopener">POSIX-compatible shells</a> (including Bash), the standard says:</p><blockquote><p><strong>2.5.3 Shell Variables</strong><br>Variables shall be initialized from the environment <em>[â€¦]</em> If a variable is initialized from the environment, it shall be marked for export immediately; see the export special built-in. New variables can be defined and initialized with variable assignments, <em>[etc.]</em></p><p>å¦‚æœshellå˜é‡è¦è½¬åŒ–ä¸ºç¯å¢ƒå˜é‡ï¼Œæ‰§è¡Œexport å‘½ä»¤</p></blockquote><h3 id="æŸ¥çœ‹shellå˜é‡å’Œç¯å¢ƒå˜é‡">æŸ¥çœ‹shellå˜é‡å’Œç¯å¢ƒå˜é‡</h3><ul><li>æŸ¥çœ‹shellå˜é‡ä½¿ç”¨<code>set</code>å‘½ä»¤</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span></span><br><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†</span></span><br><span class="line">&gt; ...</span><br><span class="line">&gt; status=0</span><br><span class="line">&gt; termcap</span><br><span class="line">&gt; terminfo</span><br><span class="line">&gt; userdirs</span><br><span class="line">&gt; usergroups</span><br><span class="line">&gt; watch=(  )</span><br><span class="line">&gt; widgets</span><br><span class="line">&gt; zle_bracketed_paste=( $<span class="string">'\C-[[?2004h'</span> $<span class="string">'\C-[[?2004l'</span> )</span><br><span class="line">&gt; zsh_eval_context=( toplevel )</span><br><span class="line">&gt; zsh_scheduled_events</span><br><span class="line">&gt; ...</span><br></pre></td></tr></table></figure><p>å¦å¤–å¯ä»¥é€šè¿‡set/unset æ¥è®¾ç½®/åˆ é™¤shellå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span></span><br><span class="line"></span><br><span class="line">  Display, <span class="built_in">set</span> or <span class="built_in">unset</span> values of shell attributes and positional parameters.</span><br><span class="line"></span><br><span class="line">  - Display the names and values of shell variables:</span><br><span class="line">    <span class="built_in">set</span></span><br><span class="line"></span><br><span class="line">  - Mark variables that are modified or created <span class="keyword">for</span> <span class="built_in">export</span>:</span><br><span class="line">    <span class="built_in">set</span> -a</span><br><span class="line"></span><br><span class="line">  - Notify of job termination immediately:</span><br><span class="line">    <span class="built_in">set</span> -b</span><br><span class="line"></span><br><span class="line">  - Set various options, e.g. <span class="built_in">enable</span> vi style line editing:</span><br><span class="line">    <span class="built_in">set</span> -o vi</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span></span><br><span class="line"></span><br><span class="line">  Remove shell variables or <span class="built_in">functions</span>.</span><br><span class="line"></span><br><span class="line">  - Remove the variable foo, or <span class="keyword">if</span> the variable doesn<span class="string">'t exist, remove the function foo:</span></span><br><span class="line"><span class="string">    unset foo</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  - Remove the variables foo and bar:</span></span><br><span class="line"><span class="string">    unset -v foo bar</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  - Remove the function my_func:</span></span><br><span class="line"><span class="string">    unset -f my_func</span></span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹ç¯å¢ƒå˜é‡ä½¿ç”¨envæˆ–è€…printenv</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">printenv</span><br><span class="line">&gt; VIRTUALENVWRAPPER_WORKON_CD=1</span><br><span class="line">&gt; VIRTUALENVWRAPPER_SCRIPT=/opt/anaconda3/bin/virtualenvwrapper.sh</span><br><span class="line">&gt; WORKON_HOME=/Users/simple/.virtualenvs</span><br><span class="line">&gt; VIRTUALENVWRAPPER_HOOK_DIR=/Users/simple/.virtualenvs</span><br><span class="line">&gt; ANDROID_HOME=/Users/simple/Library/Android/sdk</span><br><span class="line">&gt; _=/usr/bin/printenv</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">env</span><br><span class="line"></span><br><span class="line">  Show the environment or run a program <span class="keyword">in</span> a modified environment.</span><br><span class="line"></span><br><span class="line">  - Show the environment:</span><br><span class="line">    env</span><br><span class="line"></span><br><span class="line">  - Run a program. Often used <span class="keyword">in</span> scripts after the shebang (<span class="comment">#!) for looking up the path to the program:</span></span><br><span class="line">    env program</span><br><span class="line"></span><br><span class="line">  - Clear the environment and run a program:</span><br><span class="line">    env -i program</span><br><span class="line"></span><br><span class="line">  - Remove variable from the environment and run a program:</span><br><span class="line">    env -u variable program</span><br><span class="line"></span><br><span class="line">  - Set a variable and run a program:</span><br><span class="line">    env variable=value program</span><br><span class="line"></span><br><span class="line">  - Set multiple variables and run a program:</span><br><span class="line">    env variable1=value variable2=value variable3=value program</span><br></pre></td></tr></table></figure><h2 id="è§£å†³">è§£å†³</h2><p>æ–¹æ³•å°±æ¯”è¾ƒæ˜æ˜¾äº†</p><p>ç¬¬ä¸€ç§ï¼Œä¿®æ”¹.envæ–‡ä»¶ï¼ŒåŠ å…¥exportï¼Œç„¶åæ‰§è¡Œ<code>source .env</code>ï¼Œæœ€åè¿è¡Œpythonå‘½ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> REDIS_HOST=example.com</span><br><span class="line"><span class="built_in">export</span> REDIS_PORT=5432</span><br><span class="line"><span class="built_in">export</span> REDIS_PASSWORD=123456</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§ï¼Œåœ¨è¿è¡Œpython å‘½ä»¤å‰é¢åŠ ä¸Šenvæ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">env REDIS_HOST=example.com REDIS_PORT=5432 REDIS_PASSWORD=123456 python variables.py</span><br><span class="line">&gt; PID: 23517, PPID: 22650</span><br><span class="line">&gt; 123456@example.com:5432</span><br></pre></td></tr></table></figure><h2 id="Tips">Tips</h2><p>åœ¨shellä¸­è·å–å½“å‰è¿›ç¨‹IDï¼Œçˆ¶è¿›ç¨‹IDä»¥åŠUID</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"PID of this script: $$"</span></span><br><span class="line">&gt; 22650</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"PPID of this script: <span class="variable">$PPID</span>"</span></span><br><span class="line">&gt; 22649</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"UID of this script: <span class="variable">$UID</span>"</span></span><br><span class="line">&gt; 501</span><br></pre></td></tr></table></figure><p>åœ¨pythonè„šæœ¬ä¸­è·å–å½“å‰è¿›ç¨‹IDä»¥åŠçˆ¶è¿›ç¨‹ID</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print(<span class="string">f"PID: <span class="subst">&#123;os.getpid()&#125;</span>, PPID: <span class="subst">&#123;os.getppid()&#125;</span>"</span>)</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>[1] <a href="http://www.ee.surrey.ac.uk/Teaching/Unix/unix8.html" target="_blank" rel="noopener">UNIX Tutorial Eight</a></p><p>[2] <a href="https://stackoverflow.com/questions/3341372/difference-between-shell-and-environment-variables" target="_blank" rel="noopener">difference-between-shell-and-environment-variables</a></p><p>[3] <a href="https://unix.stackexchange.com/questions/364655/shell-variable-vs-environment-variable-which-one-is-preferred-if-both-have-the" target="_blank" rel="noopener">shell-variable-vs-environment-variable-which-one-is-preferred-if-both-have-the-same-name</a></p><p>[4] <a href="https://linuxize.com/post/how-to-set-and-list-environment-variables-in-linux/" target="_blank" rel="noopener">How to Set and List Environment Variables in Linux</a></p>]]></content>
    
    <summary type="html">
    
      shellå˜é‡ä¸ç¯å¢ƒå˜é‡çš„åŒºåˆ«
    
    </summary>
    
    
      <category term="linux" scheme="https://blog.smart-lifestyle.cn/categories/linux/"/>
    
    
      <category term="linux" scheme="https://blog.smart-lifestyle.cn/tags/linux/"/>
    
      <category term="shell" scheme="https://blog.smart-lifestyle.cn/tags/shell/"/>
    
  </entry>
  
  <entry>
    <title>æµ‹è¯•</title>
    <link href="https://blog.smart-lifestyle.cn/posts/938d/"/>
    <id>https://blog.smart-lifestyle.cn/posts/938d/</id>
    <published>2021-02-19T06:21:51.560Z</published>
    <updated>2021-02-19T06:21:51.560Z</updated>
    
    <content type="html"><![CDATA[<p>ç”¨äºæµ‹è¯•SEO</p>]]></content>
    
    <summary type="html">
    
      è¿™æ˜¯ä¸€ç¯‡æµ‹è¯•æ–‡æ¡£
    
    </summary>
    
    
      <category term="test" scheme="https://blog.smart-lifestyle.cn/categories/test/"/>
    
    
      <category term="SEO" scheme="https://blog.smart-lifestyle.cn/tags/SEO/"/>
    
  </entry>
  
  <entry>
    <title>Python</title>
    <link href="https://blog.smart-lifestyle.cn/posts/aaa7/"/>
    <id>https://blog.smart-lifestyle.cn/posts/aaa7/</id>
    <published>2021-01-16T06:39:20.391Z</published>
    <updated>2021-01-16T06:39:20.391Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š</p><ol><li><a href="https://github.com/python-poetry/poetry" target="_blank" rel="noopener">https://github.com/python-poetry/poetry</a></li><li><a href="https://zhuanlan.zhihu.com/p/110721747" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/110721747</a></li><li><a href="https://blog.csdn.net/daihaoxin/article/details/109262807" target="_blank" rel="noopener">https://blog.csdn.net/daihaoxin/article/details/109262807</a></li></ol></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/python-poetry/poetry&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/python-
      
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="dependency" scheme="https://blog.smart-lifestyle.cn/tags/dependency/"/>
    
  </entry>
  
  <entry>
    <title>Python Type Checking</title>
    <link href="https://blog.smart-lifestyle.cn/posts/acc1/"/>
    <id>https://blog.smart-lifestyle.cn/posts/acc1/</id>
    <published>2020-12-06T14:48:54.139Z</published>
    <updated>2020-12-06T14:48:54.139Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‚è€ƒï¼š</p><ol><li><p><a href="https://testdriven.io/blog/python-type-checking/" target="_blank" rel="noopener">https://testdriven.io/blog/python-type-checking/</a></p></li><li><p><a href="https://testdriven.io/blog/python-code-quality/#running-code-quality-tools" target="_blank" rel="noopener">https://testdriven.io/blog/python-code-quality/#running-code-quality-tools</a></p></li></ol></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://testdriven.io/blog/python-type-checking/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://testd
      
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>python library package</title>
    <link href="https://blog.smart-lifestyle.cn/posts/205e/"/>
    <id>https://blog.smart-lifestyle.cn/posts/205e/</id>
    <published>2020-12-06T14:40:36.325Z</published>
    <updated>2020-12-06T14:40:36.325Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è§†è§‰">è§†è§‰</h2><ol><li></li></ol><img src="https://oss.smart-lifestyle.cn/blog/cc19h.jpg" /><blockquote><p>[<a href="https://github.com/bokeh/bokeh" target="_blank" rel="noopener">https://github.com/bokeh/bokeh</a>][1]<br>Bokeh is an interactive visualization library for modern web browsers. It provides elegant, concise construction of versatile graphics, and affords high-performance interactivity over large or streaming datasets. Bokeh can help anyone who would like to quickly and easily make interactive plots, dashboards, and data applications.</p></blockquote><p>![][image-2]![][image-3]![][image-4]![][image-5]</p><h3 id="install">install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install bokeh</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿäº§åŠ›">ç”Ÿäº§åŠ›</h2><ol><li><img src="https://oss.smart-lifestyle.cn/file/r7d0g.jpg" alt=""></li></ol><blockquote><p>[<a href="https://github.com/PyCQA/isort" target="_blank" rel="noopener">https://github.com/PyCQA/isort</a>][2]<br>isort your imports, so you donâ€™t have to.<br>isort is a Python utility / library to sort imports alphabetically, and automatically separated into sections and by type. It provides a command line utility, Python library and plugins for various editors to quickly sort all your imports. It requires Python 3.6+ to run but supports formatting Python 2 code too.</p></blockquote><h3 id="install-2">install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install isort</span><br></pre></td></tr></table></figure><h3 id="use">use</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">isort file.py</span><br></pre></td></tr></table></figure><ol start="2"><li><img src="https://oss.smart-lifestyle.cn/file/4dv6l.jpg" alt=""></li></ol><blockquote><p>[<a href="https://github.com/pypyr/pypyr" target="_blank" rel="noopener">https://github.com/pypyr/pypyr</a>][3]<br>pypyr is a free &amp; open-source task-runner that lets you define and run sequential steps in a pipeline.</p></blockquote><h3 id="install-3">install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install --upgrade pypyr</span><br></pre></td></tr></table></figure><h2 id="æ¡†æ¶">æ¡†æ¶</h2><h3 id="äº‹ä»¶é©±åŠ¨ï¼Œè§‚å¯Ÿè€…æ¨¡å¼">äº‹ä»¶é©±åŠ¨ï¼Œè§‚å¯Ÿè€…æ¨¡å¼</h3><ol><li>RxPY v3.0</li></ol><blockquote><p>[<a href="https://github.com/ReactiveX/RxPY" target="_blank" rel="noopener">https://github.com/ReactiveX/RxPY</a>][4]<br>A library for composing asynchronous and event-based programs using observable collections and query operator functions in Python</p></blockquote><h3 id="install-4">install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install rx</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è§†è§‰&quot;&gt;è§†è§‰&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;img src=&quot;https://oss.smart-lifestyle.cn/blog/cc19h.jpg&quot;&gt;
&lt;blockquote&gt;
&lt;p&gt;[&lt;a href=&quot;https://github.com/bokeh/bokeh&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/bokeh/bokeh&lt;/a&gt;][1]&lt;br&gt;
Bokeh is an interactive visualization library for modern web browsers. It provides elegant, concise construction of versatile graphics, and affords high-performance interactivity over large or streaming datasets. Bokeh can help anyone who would like to quickly and easily make interactive plots, dashboards, and data applications.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;![][image-2]![][image-3]![][image-4]![][image-5]&lt;/p&gt;
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python library" scheme="https://blog.smart-lifestyle.cn/tags/python-library/"/>
    
  </entry>
  
  <entry>
    <title>dockeréƒ¨ç½²è®°å½•</title>
    <link href="https://blog.smart-lifestyle.cn/posts/c5ac/"/>
    <id>https://blog.smart-lifestyle.cn/posts/c5ac/</id>
    <published>2020-12-06T14:29:56.852Z</published>
    <updated>2020-12-06T14:29:56.852Z</updated>
    
    <content type="html"><![CDATA[<ul><li><a href="">x</a> ç£ç›˜åˆå§‹åŒ–</li><li><a href="">x</a> ä¿®æ”¹ç³»ç»Ÿæ—¶åŒºä¸ºUTC+8</li><li><a href="">x</a> éƒ¨ç½²dockerç¯å¢ƒï¼Œä¿®æ”¹dockerå®‰è£…ä½ç½®</li><li><a href="">x</a> ä¼˜åŒ–dockerç¯å¢ƒï¼Œé€‚é…china</li><li><a href="">x</a> ä¿®æ”¹ä»£ç é…ç½®æ–‡ä»¶ï¼Œé€‚é…æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ</li><li><a href="">x</a> ä»£ç mergeåˆ°masteråˆ†æ”¯</li><li><a href="">x</a> å®‰è£…dockeré•œåƒ</li><li><a href="">x</a> ä»gitè·å–ä»£ç ï¼Œéƒ¨ç½²</li><li><a href="">Â </a> é…ç½®https</li><li><a href="">Â </a> æµ‹è¯•</li></ul><blockquote><p>æœ¬æ–‡è®°å½•åœ¨Azure ä¸Šéƒ¨ç½²dockeråº”ç”¨çš„è¿‡ç¨‹</p></blockquote><h2 id="ç£ç›˜åˆå§‹åŒ–">ç£ç›˜åˆå§‹åŒ–</h2><p>Azureæä¾›çš„ç£ç›˜ä¸ºç³»ç»Ÿç›˜+æ•°æ®ç›˜ï¼Œæ•°æ®ç›˜çš„å¤§å°åœ¨æ–°å»ºè™šæ‹Ÿæœºçš„æ—¶å€™å¯ä»¥é€‰ï¼Œé»˜è®¤æ•°æ®ç›˜æ˜¯æœªæŒ‚è½½åˆ°ç³»ç»Ÿä¸Šçš„ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‚è½½ï¼ŒæŒ‚è½½æ•°æ®ç›˜å¯ä»¥å‚è€ƒï¼š<br><a href="https://docs.azure.cn/zh-cn/virtual-machines/linux/add-disk" target="_blank" rel="noopener">https://docs.azure.cn/zh-cn/virtual-machines/linux/add-disk</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡dh -hå‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿç£ç›˜çš„å¤§å°å’Œä½¿ç”¨æƒ…å†µï¼Œç›®å‰æ²¡æœ‰æ•°æ®ç›˜</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs           796M  676K  795M   1% /run</span><br><span class="line">/dev/sda1        29G  1.5G   28G   5% /</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /dev/shm</span><br><span class="line">tmpfs           5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda15      105M  3.6M  101M   4% /boot/efi</span><br><span class="line">/dev/sdb1        16G   45M   15G   1% /mnt</span><br><span class="line">tmpfs           796M     0  796M   0% /run/user/1000</span><br><span class="line">........</span><br><span class="line"><span class="comment"># æ“ä½œå®Œä¹‹åï¼Œ df -hï¼Œæœ€åä¸€è¡Œå·²ç»æŒ‚åœ¨åˆ°/datadriveä¸Š</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs           796M  680K  795M   1% /run</span><br><span class="line">/dev/sda1        29G  1.5G   28G   5% /</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /dev/shm</span><br><span class="line">tmpfs           5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda15      105M  3.6M  101M   4% /boot/efi</span><br><span class="line">/dev/sdb1        16G   45M   15G   1% /mnt</span><br><span class="line">tmpfs           796M     0  796M   0% /run/user/1000</span><br><span class="line">/dev/sdc1       196G   61M  186G   1% /datadrive</span><br></pre></td></tr></table></figure><p><strong>ä¹‹åçš„æ‰€æœ‰æ–‡ä»¶æ“ä½œéƒ½æ˜¯åœ¨/datadriveä¸‹</strong><br>é»˜è®¤datadriveçš„æƒé™ä¸ºrootæƒé™ï¼Œä¿®æ”¹æ‰€æœ‰è€…ä¸ºå½“å‰ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R cniabservice:cniabservice /datadrive/</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹ç³»ç»Ÿæ—¶åŒº">ä¿®æ”¹ç³»ç»Ÿæ—¶åŒº</h2><p>Azureæä¾›çš„linuxé»˜è®¤æ—¶åŒºä¸ºUTCï¼Œéœ€è¦æ”¹ä¸ºä¸­å›½UTC+8æ—¶åŒº<br>ç®€å•æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure><p><strong>!docker å†…æ—¶åŒºé»˜è®¤ä¹Ÿä¸ºUTCï¼Œè·Ÿä¸»æœºå¹¶ä¸åŒæ­¥ï¼Œéœ€è¦ä¿®æ”¹ä¸ºUTC+8ï¼Œä¸‹é¢ä¼šè¯´æ˜ï¼Œä¸åœ¨è¿™é‡Œä»‹ç»</strong></p><h2 id="å®‰è£…docker">å®‰è£…docker</h2><h3 id="1-ä½¿ç”¨Ubuntu-æºè¿›è¡Œå®‰è£…">1. ä½¿ç”¨Ubuntu æºè¿›è¡Œå®‰è£…</h3><p>å‚è€ƒ <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove docker docker-engine docker.io containerd runc</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install \</span><br><span class="line">apt-transport-https \</span><br><span class="line">ca-certificates \</span><br><span class="line">curl \</span><br><span class="line">gnupg-agent \</span><br><span class="line">software-properties-common</span><br><span class="line"></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo apt-key fingerprint 0EBFCD88</span><br><span class="line"></span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">   <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string">   <span class="variable">$(lsb_release -cs)</span> \</span></span><br><span class="line"><span class="string">   stable"</span></span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br><span class="line">sudo apt-get install docker-compose</span><br></pre></td></tr></table></figure><p><strong>apt-getæ˜¯ä»å›½å¤–ç½‘ç«™ä¸‹è½½ï¼Œå¯èƒ½é€Ÿåº¦ä¼šéå¸¸æ…¢</strong>ï¼Œå¯ä»¥ä¸‹è½½debç¦»çº¿åŒ…ï¼š<br><a href="https://download.docker.com/linux/ubuntu/dists/bionic/pool/stable/amd64/" target="_blank" rel="noopener" title="é’ˆå¯¹äºubuntu 18.04">https://download.docker.com/linux/ubuntu/dists/bionic/pool/stable/amd64/</a></p><blockquote><p>Go to <a href="https://download.docker.com/linux/ubuntu/dists/" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu/dists/</a>, choose your Ubuntu version, browse to pool/stable/, choose amd64, armhf, arm64, ppc64el, or s390x, and download the .deb file for the Docker Engine - Community version you want to install.<br>ä½¿ç”¨dpkg -i *.deb å®‰è£…é¡ºåºä¸ºï¼š</p></blockquote><ol><li><a href="http://containerd.io" target="_blank" rel="noopener">containerd.io</a></li><li>docker-ce</li><li>docker-ce-cli</li><li>æœ€å apt-get install docker-compose</li></ol><p>dockeré»˜è®¤rootæƒé™æ“ä½œï¼Œå°†å½“å‰ç”¨æˆ·åŠ å…¥rootç»„ï¼Œå…æ¯æ¬¡æ“ä½œè¾“å…¥å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># If you would like to use Docker as a non-root user, you should now consider adding your user to the â€œdockerâ€ group with something like:</span></span><br><span class="line">sudo usermod -aG docker your-user</span><br></pre></td></tr></table></figure><h3 id="2-ä¿®æ”¹dockeré•œåƒå­˜å‚¨ç­‰å­˜å‚¨ä½ç½®">2. ä¿®æ”¹dockeré•œåƒå­˜å‚¨ç­‰å­˜å‚¨ä½ç½®</h3><p>é»˜è®¤å­˜å‚¨ä½ç½®åœ¨ç³»ç»Ÿç›˜ï¼Œè¦å°†å…¶è¿ç§»è‡³æ•°æ®ç›˜<br>åœ¨æ§åˆ¶å°è¾“å…¥docker infoï¼ŒæŸ¥çœ‹å½“å‰docker å­˜å‚¨ä½ç½®<br><img src="https://oss.smart-lifestyle.cn/blog/qx062.jpg" alt=""><br>åœ¨/etc/docker/ä¸‹æ–°å»ºdaemon.jsonæ–‡ä»¶, graphä¸ºå­˜å‚¨ä½ç½®</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"registry-mirrors"</span>: [<span class="string">"https://1x2ypu6h.mirror.aliyuncs.com"</span>],</span><br><span class="line">  <span class="attr">"hosts"</span>:[</span><br><span class="line">    <span class="string">"tcp://0.0.0.0:2375"</span>,</span><br><span class="line">    <span class="string">"unix:///var/run/docker.sock"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"graph"</span>: <span class="string">"/datadrive/dockerdata"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡å¯dockerï¼Œsudo service docker restartï¼Œå†æ¬¡docker infoæŸ¥çœ‹é…ç½®<br><img src="https://oss.smart-lifestyle.cn/blog/7rvdj.jpg" alt=""><br><strong>ä¿®æ”¹æˆåŠŸï¼</strong></p><h2 id="ä»ä»£ç ä»“åº“è·å–ä»£ç ">ä»ä»£ç ä»“åº“è·å–ä»£ç </h2><h3 id="1-pull-request-to-Master">1. pull request to Master</h3><p>é‡åˆ°é—®é¢˜ï¼Œæ²¡æœ‰æƒé™è¿›è¡Œåˆå¹¶æ“ä½œï¼Œåªæœ‰å®¡æ‰¹åŠŸèƒ½ï¼Œä¿®æ”¹å¦‚ä¸‹åœ°æ–¹<br><img src="https://oss.smart-lifestyle.cn/blog/98qaq.jpg" alt=""></p><h3 id="2-åœ¨è¿œç¨‹æœåŠ¡å™¨ä½¿ç”¨git-cloneè·å–ä»£ç ">2. åœ¨è¿œç¨‹æœåŠ¡å™¨ä½¿ç”¨git cloneè·å–ä»£ç </h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å¦‚ä¸‹ç”¨æˆ·åå¯†ç </span></span><br><span class="line"><span class="comment"># ç”¨æˆ·åï¼šjenkins å¯†ç ï¼š***************</span></span><br><span class="line">git <span class="built_in">clone</span> https://dev.azure.com/ds-rnd/*************</span><br></pre></td></tr></table></figure><h2 id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir redisdb</span><br><span class="line">mkdir mysqldb</span><br><span class="line">mkdir ssl_key</span><br><span class="line">mkdir conf</span><br><span class="line"><span class="comment"># ä¿®æ”¹nginx.confæ–‡ä»¶</span></span><br><span class="line">mkdir -p static/.well-known</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"1.0.0"</span> \&gt; version</span><br></pre></td></tr></table></figure><h3 id="1-æ„å»ºdocker">1. æ„å»ºdocker</h3><p>åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸‹æ‰§è¡Œ docker-compose up è¿›è¡Œé¦–æ¬¡ç¼–è¯‘é•œåƒå’Œå¯åŠ¨å®¹å™¨</p><h3 id="2-åˆå§‹åŒ–æ•°æ®åº“">2. åˆå§‹åŒ–æ•°æ®åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºabbdriveæ•°æ®åº“</span></span><br><span class="line">python manage.py makemigrations abbdrivemodel</span><br><span class="line">python manage.py migrate</span><br><span class="line">æ‰§è¡Œ</span><br><span class="line">http://g*************.cloudapp.chinacloudapi.cn/**********</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; ç£ç›˜åˆå§‹åŒ–&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; ä¿®æ”¹ç³»ç»Ÿæ—¶åŒºä¸ºUTC+8&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; éƒ¨ç½²dockerç¯å¢ƒï¼Œä¿®æ”¹dockerå®‰è£…ä½ç½®&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; ä¼˜åŒ–dockerç¯å¢ƒï¼Œé€‚é…china&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; ä¿®æ”¹ä»£ç é…ç½®æ–‡ä»¶ï¼Œé€‚é…æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; ä»£ç mergeåˆ°masteråˆ†æ”¯&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; å®‰è£…dockeré•œåƒ&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;x&lt;/a&gt; ä»gitè·å–ä»£ç ï¼Œéƒ¨ç½²&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;Â &lt;/a&gt; é…ç½®https&lt;/li&gt;
&lt;li&gt;&lt;a href&gt;Â &lt;/a&gt; æµ‹è¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡è®°å½•åœ¨Azure ä¸Šéƒ¨ç½²dockeråº”ç”¨çš„è¿‡ç¨‹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;ç£ç›˜åˆå§‹åŒ–&quot;&gt;ç£ç›˜åˆå§‹åŒ–&lt;/h2&gt;
&lt;p&gt;Azureæä¾›çš„ç£ç›˜ä¸ºç³»ç»Ÿç›˜+æ•°æ®ç›˜ï¼Œæ•°æ®ç›˜çš„å¤§å°åœ¨æ–°å»ºè™šæ‹Ÿæœºçš„æ—¶å€™å¯ä»¥é€‰ï¼Œé»˜è®¤æ•°æ®ç›˜æ˜¯æœªæŒ‚è½½åˆ°ç³»ç»Ÿä¸Šçš„ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‚è½½ï¼ŒæŒ‚è½½æ•°æ®ç›˜å¯ä»¥å‚è€ƒï¼š&lt;br&gt;
&lt;a href=&quot;https://docs.azure.cn/zh-cn/virtual-machines/linux/add-disk&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://docs.azure.cn/zh-cn/virtual-machines/linux/add-disk&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# é€šè¿‡dh -hå‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿç£ç›˜çš„å¤§å°å’Œä½¿ç”¨æƒ…å†µï¼Œç›®å‰æ²¡æœ‰æ•°æ®ç›˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Filesystem      Size  Used Avail Use% Mounted on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;udev            3.9G     0  3.9G   0% /dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           796M  676K  795M   1% /run&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sda1        29G  1.5G   28G   5% /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           3.9G     0  3.9G   0% /dev/shm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           5.0M     0  5.0M   0% /run/lock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sda15      105M  3.6M  101M   4% /boot/efi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sdb1        16G   45M   15G   1% /mnt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           796M     0  796M   0% /run/user/1000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;........&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# æ“ä½œå®Œä¹‹åï¼Œ df -hï¼Œæœ€åä¸€è¡Œå·²ç»æŒ‚åœ¨åˆ°/datadriveä¸Š&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Filesystem      Size  Used Avail Use% Mounted on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;udev            3.9G     0  3.9G   0% /dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           796M  680K  795M   1% /run&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sda1        29G  1.5G   28G   5% /&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           3.9G     0  3.9G   0% /dev/shm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           5.0M     0  5.0M   0% /run/lock&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sda15      105M  3.6M  101M   4% /boot/efi&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sdb1        16G   45M   15G   1% /mnt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tmpfs           796M     0  796M   0% /run/user/1000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/dev/sdc1       196G   61M  186G   1% /datadrive&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="docker" scheme="https://blog.smart-lifestyle.cn/categories/docker/"/>
    
    
      <category term="docker" scheme="https://blog.smart-lifestyle.cn/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>git commitè§„èŒƒ</title>
    <link href="https://blog.smart-lifestyle.cn/posts/76bd/"/>
    <id>https://blog.smart-lifestyle.cn/posts/76bd/</id>
    <published>2020-11-24T08:59:59.158Z</published>
    <updated>2020-11-24T08:59:59.158Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æäº¤git æ—¶ï¼Œå¦‚ä½•èƒ½å°†æäº¤çš„ä¿¡æ¯å†™æ¸…æ™°æ˜äº†ï¼Œé¿å…ä¸è§„èŒƒçš„ä»£ç æäº¤</p><p>git æ¯æ¬¡æäº¤éƒ½éœ€è¦å†™commit messageï¼Œå¦åˆ™å°±ä¸å…è®¸æäº¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œcommit messageåº”è¯¥æ¸…æ™°æ˜äº†ï¼Œè¯´æ˜æœ¬æ¬¡æäº¤çš„ç›®çš„ï¼Œå…·ä½“åšäº†ä»€ä¹ˆæ“ä½œï¼Œä½†æ˜¯åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¤§å®¶çš„commit messageåƒå¥‡ç™¾æ€ªï¼Œä¸­è‹±æ–‡æ··åˆä½¿ç”¨ï¼Œfix bugç­‰å„ç§ç¬¼ç»Ÿçš„messageå¸ç©ºè§æ€ªï¼Œè§„èŒƒgit commit messageå¾ˆé‡è¦</p></blockquote><p>æ¯”è¾ƒæµè¡Œçš„è§„èŒƒæ•´ç†å¦‚ä¸‹ã€‚</p><h2 id="commit-message-æ ¼å¼">commit message æ ¼å¼</h2><p>å»ºè®®æ¯è¡Œä¸è¶…è¿‡100ä¸ªå­—ç¬¦</p><p><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">&lt;BLANK LINE&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;BLANK LINE&gt;</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></figure><ul><li><p>type(å¿…é¡»)</p><p>ç”¨äºè¯´æ˜git commitçš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢çš„æ ‡è¯†ã€‚</p><p>feat: æ–°åŠŸèƒ½ï¼ˆfeatureï¼‰</p><p>fix: ä¿®å¤bugï¼Œå¯ä»¥æ˜¯QAå‘ç°çš„BUGï¼Œä¹Ÿå¯ä»¥æ˜¯ç ”å‘è‡ªå·±å‘ç°çš„BUG</p><p>docs: æ–‡æ¡£ï¼ˆdocumentï¼‰</p><p>style: æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨, æ¯”å¦‚åˆ é™¤å¤šä½™çš„ç©ºè¡Œï¼‰</p><p>refactor: é‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç è¿åŠ¨ï¼‰</p><p>perf: ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ</p><p>test: å¢åŠ æµ‹è¯•</p><p>chore: æ„å»ºè¿‡ç¨‹æˆ–è€…è¾…åŠ©å·¥å…·çš„å˜åŠ¨</p><p>revert: å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œéœ€è¦åœ¨bodyä¸­å†™ä¸Šä»å“ªä¸€ä¸ªç‰ˆæœ¬revertçš„</p><p>merge: ä»£ç åˆå¹¶</p><p>sync: åŒæ­¥ä¸»çº¿æˆ–è€…åˆ†å¸ƒçš„bug</p></li><li><p>scopeï¼ˆå¯é€‰ï¼‰</p><p>scopeç”¨äºè¯´æ˜å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®çš„ä¸åŒè€Œä¸åŒ</p><p>å¦‚æœä¿®æ”¹å½±å“äº†ä¸æ­¢ä¸€ä¸ªsocopeï¼Œä½ å¯ä»¥ä½¿ç”¨*ä»£æ›¿</p></li><li><p>subjectï¼ˆå¿…é¡»ï¼‰</p><p>subjectæ˜¯commitç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50å­—ç¬¦ã€‚</p><p>å»ºè®®ä½¿ç”¨ä¸­æ–‡ã€‚</p><p>ç»“å°¾ä¸åŠ å¥å·æˆ–è€…å…¶ä»–æ ‡ç‚¹ç¬¦å·</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä¸¾ä¾‹</span></span><br><span class="line">docs(api): æ¥å£è¯´æ˜å®Œå–„</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">feat($</span><span class="bash">browser): onUrlChange event (popstate/hashchange/polling)</span></span><br><span class="line"></span><br><span class="line">Added new event to $browser:</span><br><span class="line">- forward popstate event if available</span><br><span class="line">- forward hashchange event if popstate not available</span><br><span class="line">- do polling when neither popstate nor hashchange available</span><br><span class="line"></span><br><span class="line">Breaks $browser.onHashChange, which was removed (use onUrlChange instead)</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">fix($</span><span class="bash">compile): couple of unit tests <span class="keyword">for</span> IE9</span></span><br><span class="line"></span><br><span class="line">Older IEs serialize html uppercased, but IE9 does not...</span><br><span class="line">Would be better to expect case insensitive, unfortunately jasmine does</span><br><span class="line">not allow to user regexps for throw expectations.</span><br><span class="line"></span><br><span class="line">Closes #392</span><br><span class="line">Breaks foo.bar api, foo.baz should be used instead</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">feat($</span><span class="bash">compile): simplify isolate scope bindings</span></span><br><span class="line"></span><br><span class="line">Changed the isolate scope binding options to:</span><br><span class="line">  - @attr - attribute binding (including interpolation)</span><br><span class="line">  - =model - by-directional model binding</span><br><span class="line">  - &amp;expr - expression execution binding</span><br><span class="line"></span><br><span class="line">This change simplifies the terminology as well as</span><br><span class="line">number of choices available to the developer. It</span><br><span class="line">also supports local name aliasing from the parent.</span><br><span class="line"></span><br><span class="line">BREAKING CHANGE: isolate scope bindings definition has changed and</span><br><span class="line">the inject option for the directive controller injection was removed.</span><br><span class="line"></span><br><span class="line">To migrate the code follow the example below:</span><br><span class="line"></span><br><span class="line">Before:</span><br><span class="line"></span><br><span class="line">scope: &#123;</span><br><span class="line">  myAttr: 'attribute',</span><br><span class="line">  myBind: 'bind',</span><br><span class="line">  myExpression: 'expression',</span><br><span class="line">  myEval: 'evaluate',</span><br><span class="line">  myAccessor: 'accessor'</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">After:</span><br><span class="line"></span><br><span class="line">scope: &#123;</span><br><span class="line">  myAttr: '@',</span><br><span class="line">  myBind: '@',</span><br><span class="line">  myExpression: '&amp;',</span><br><span class="line">  // myEval - usually not useful, but in cases where the expression is assignable, you can use '='</span><br><span class="line">  myAccessor: '=' // in directive's template change myAccessor() to myAccessor</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">The removed `inject` wasn't generaly useful for directives so there should be no code using it.</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨git-commit-è§„èŒƒçš„å¥½å¤„">ä½¿ç”¨git commit è§„èŒƒçš„å¥½å¤„</h3><ol><li>ä¾¿äºè¿½æº¯æäº¤å†å²è¿›è¡Œè¿½æº¯</li><li>ä¸€æ—¦çº¦æŸäº†commit messageï¼Œå°±ä¸èƒ½å†ä¸€è‚¡è„‘çš„æŠŠå„ç§å„æ ·çš„æ”¹åŠ¨éƒ½æ”¾åœ¨ä¸€ä¸ªgit commité‡Œé¢</li><li>ä¾¿äºè‡ªåŠ¨åŒ–è¾“å‡ºchange log(<a href="http://CHANGELOG.md" target="_blank" rel="noopener">CHANGELOG.md</a>)</li></ol><p>[1] <a href="https://developer.aliyun.com/article/770277?accounttraceid=d4154093542c440aa51196b76d1ccbe3eyfz" target="_blank" rel="noopener">https://developer.aliyun.com/article/770277?accounttraceid=d4154093542c440aa51196b76d1ccbe3eyfz</a></p><p>[2] <a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#" target="_blank" rel="noopener">https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æäº¤git æ—¶ï¼Œå¦‚ä½•èƒ½å°†æäº¤çš„ä¿¡æ¯å†™æ¸…æ™°æ˜äº†ï¼Œé¿å…ä¸è§„èŒƒçš„ä»£ç æäº¤&lt;/p&gt;
&lt;p&gt;git æ¯æ¬¡æäº¤éƒ½éœ€è¦å†™commit messageï¼Œå¦åˆ™å°±ä¸å…è®¸æäº¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œcommit messageåº”è¯¥æ¸…æ™°æ˜äº†ï¼Œè¯´æ˜æœ¬æ¬¡æäº¤çš„ç›®çš„ï¼Œå…·ä½“åšäº†ä»€ä¹ˆæ“ä½œï¼Œä½†æ˜¯åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¤§å®¶çš„commit messageåƒå¥‡ç™¾æ€ªï¼Œä¸­è‹±æ–‡æ··åˆä½¿ç”¨ï¼Œfix bugç­‰å„ç§ç¬¼ç»Ÿçš„messageå¸ç©ºè§æ€ªï¼Œè§„èŒƒgit commit messageå¾ˆé‡è¦&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ¯”è¾ƒæµè¡Œçš„è§„èŒƒæ•´ç†å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;commit-message-æ ¼å¼&quot;&gt;commit message æ ¼å¼&lt;/h2&gt;
&lt;p&gt;å»ºè®®æ¯è¡Œä¸è¶…è¿‡100ä¸ªå­—ç¬¦&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;type&amp;gt;(&amp;lt;scope&amp;gt;): &amp;lt;subject&amp;gt;&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="git" scheme="https://blog.smart-lifestyle.cn/categories/git/"/>
    
    
      <category term="git commit" scheme="https://blog.smart-lifestyle.cn/tags/git-commit/"/>
    
  </entry>
  
  <entry>
    <title>.gitignoreæ¨¡å¼åŒ¹é…</title>
    <link href="https://blog.smart-lifestyle.cn/posts/4da0/"/>
    <id>https://blog.smart-lifestyle.cn/posts/4da0/</id>
    <published>2020-11-20T05:26:11.066Z</published>
    <updated>2020-11-20T05:26:11.066Z</updated>
    
    <content type="html"><![CDATA[<ul><li>åŒ¹é…æ¨¡å¼å‰ä½¿ç”¨ <code>/</code> è¡¨ç¤ºæ ¹ç›®å½•<br>/filename è¡¨ç¤ºåŒ¹é…æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶filename</li><li>åŒ¹é…æ¨¡å¼åä½¿ç”¨ <code>/</code> ä»£è¡¨æ˜¯ç›®å½•ï¼ˆä¸æ˜¯æ–‡ä»¶ï¼‰<br>dirname/ è¡¨ç¤ºåŒ¹é…çš„æ˜¯dirnameæ–‡ä»¶å¤¹</li><li>åŒ¹é…æ¨¡å¼å‰åŠ  <code>ï¼</code> è¡¨ç¤ºå–å</li><li><code>*</code> ä»£è¡¨ä»»æ„ä¸ªå­—ç¬¦<br>db*.json è¡¨ç¤ºåŒ¹é…ä»¥dbå¼€å¤´çš„jsonæ–‡ä»¶</li><li><code>?</code> åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦<br>db?.json è¡¨ç¤ºä»¥dbå¼€å¤´å¹¶ä¸”æ–‡ä»¶åä¸ºä¸‰ä¸ªå­—ç¬¦çš„jsonæ–‡ä»¶</li><li><code>**</code> åŒ¹é…ä»»æ„çº§ç›®å½•</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;åŒ¹é…æ¨¡å¼å‰ä½¿ç”¨ &lt;code&gt;/&lt;/code&gt; è¡¨ç¤ºæ ¹ç›®å½•&lt;br&gt;
/filename è¡¨ç¤ºåŒ¹é…æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶filename&lt;/li&gt;
&lt;li&gt;åŒ¹é…æ¨¡å¼åä½¿ç”¨ &lt;code&gt;/&lt;/code&gt; ä»£è¡¨æ˜¯ç›®å½•ï¼ˆä¸æ˜¯æ–‡ä»¶ï¼‰&lt;br&gt;
dirname/ è¡¨ç¤ºåŒ¹é…çš„æ˜¯dirna
      
    
    </summary>
    
    
      <category term="git" scheme="https://blog.smart-lifestyle.cn/categories/git/"/>
    
    
      <category term="git" scheme="https://blog.smart-lifestyle.cn/tags/git/"/>
    
      <category term="gitignore" scheme="https://blog.smart-lifestyle.cn/tags/gitignore/"/>
    
  </entry>
  
  <entry>
    <title>é€šè¿‡ftplibè·å–ftpæŒ‡å®šæ—¥æœŸé—´çš„æ–‡ä»¶</title>
    <link href="https://blog.smart-lifestyle.cn/posts/e530/"/>
    <id>https://blog.smart-lifestyle.cn/posts/e530/</id>
    <published>2020-05-20T13:46:14.347Z</published>
    <updated>2020-05-20T13:46:14.347Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä½¿ç”¨python-ftplib-åº“è·å–-æŸä¸€å¤©çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°">ä½¿ç”¨python ftplib åº“è·å– æŸä¸€å¤©çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ftp è®¾ç½®</span></span><br><span class="line">ftp_server = <span class="string">"******"</span></span><br><span class="line">ftp_user = <span class="string">"*****"</span></span><br><span class="line">ftp_password = <span class="string">"******"</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ftplib <span class="keyword">import</span> FTP</span><br><span class="line"></span><br><span class="line">ftp = FTP(host=ftp_server, user=ftp_user, passwd=ftp_password)</span><br><span class="line"><span class="comment"># é€šè¿‡nlstè·å–æ–‡ä»¶åˆ—è¡¨</span></span><br><span class="line">file_list = ftp.nlst()</span><br><span class="line"><span class="comment"># é€šè¿‡voidcmd è·å–æ–‡ä»¶æ›´æ–°ï¼ˆä¸Šä¼ ï¼‰æ—¶é—´</span></span><br><span class="line">date = ftp.voidcmd(<span class="string">f"MDTM 202002190502.csv"</span>)</span><br><span class="line">print(date)</span><br></pre></td></tr></table></figure><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">213</span> <span class="number">20200219170403</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–æ–‡ä»¶</span></span><br><span class="line">filter_date = <span class="string">'20200520'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨</span></span><br><span class="line">items = filter(<span class="keyword">lambda</span> x: ftp.voidcmd(<span class="string">f"MDTM <span class="subst">&#123;x&#125;</span>"</span>)[<span class="number">4</span>:<span class="number">12</span>] == filter_date, file_list)</span><br><span class="line"><span class="comment"># éå†è¿­ä»£å™¨, é€šè¿‡retrbinaryä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">    print(<span class="string">f"file name: <span class="subst">&#123;item&#125;</span>"</span>)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">f'temp/<span class="subst">&#123;item&#125;</span>'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        ftp.retrbinary(<span class="string">f'RETR <span class="subst">&#123;item&#125;</span>'</span>, fp.write)</span><br><span class="line"><span class="comment"># å…³é—­ftp</span></span><br><span class="line">ftp.quit()</span><br></pre></td></tr></table></figure><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200508.csv</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200509.csv</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200514.csv</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200520.csv</span><br><span class="line"></span><br><span class="line"><span class="string">'221 Goodbye.'</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“ftp æœåŠ¡å™¨å…³é—­æ˜¯ï¼Œå†éå†è¿‡æ»¤åçš„è¿­ä»£å™¨å°†ä¸ºç©º</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">    print(itme)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦å¤–è¿˜å¯ä»¥é€šè¿‡ftp.dirè·å–ï¼Œå…·ä½“å®ç°å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplib" target="_blank" rel="noopener">https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplib</a></p><p>å‚è€ƒï¼š</p><ol><li><a href="https://docs.python.org/3/library/ftplib.html" target="_blank" rel="noopener" title="ftplib">https://docs.python.org/3/library/ftplib.html</a></li><li><a href="https://stackoverflow.com/questions/8990598/python-ftp-get-the-most-recent-file-by-date?answertab=votes#tab-top" target="_blank" rel="noopener" title="Python FTP get the most recent file by date">https://stackoverflow.com/questions/8990598/python-ftp-get-the-most-recent-file-by-date?answertab=votes#tab-top</a></li><li><a href="https://stackoverflow.com/questions/29026709/how-to-get-ftp-files-modify-time-using-python-ftplib" target="_blank" rel="noopener" title="How to get FTP file's modify time using Python ftplib">https://stackoverflow.com/questions/29026709/how-to-get-ftp-files-modify-time-using-python-ftplib</a></li><li><a href="https://tools.ietf.org/html/rfc3659#section-3" target="_blank" rel="noopener" title="rfc3659">https://tools.ietf.org/html/rfc3659#section-3</a></li><li><a href="https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplib" target="_blank" rel="noopener">Â https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplibÂ </a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä½¿ç”¨python-ftplib-åº“è·å–-æŸä¸€å¤©çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°&quot;&gt;ä½¿ç”¨python ftplib åº“è·å– æŸä¸€å¤©çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°&lt;/h2&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ftp è®¾ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ftp_server = &lt;span class=&quot;string&quot;&gt;&quot;******&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ftp_user = &lt;span class=&quot;string&quot;&gt;&quot;*****&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ftp_password = &lt;span class=&quot;string&quot;&gt;&quot;******&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; ftplib &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; FTP&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ftp = FTP(host=ftp_server, user=ftp_user, passwd=ftp_password)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# é€šè¿‡nlstè·å–æ–‡ä»¶åˆ—è¡¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;file_list = ftp.nlst()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# é€šè¿‡voidcmd è·å–æ–‡ä»¶æ›´æ–°ï¼ˆä¸Šä¼ ï¼‰æ—¶é—´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;date = ftp.voidcmd(&lt;span class=&quot;string&quot;&gt;f&quot;MDTM 202002190502.csv&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;print(date)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight angelscript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# &lt;span class=&quot;number&quot;&gt;213&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;20200219170403&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# è·å–æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;filter_date = &lt;span class=&quot;string&quot;&gt;&#39;20200520&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# éå†æ‰€æœ‰æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;items = filter(&lt;span class=&quot;keyword&quot;&gt;lambda&lt;/span&gt; x: ftp.voidcmd(&lt;span class=&quot;string&quot;&gt;f&quot;MDTM &lt;span class=&quot;subst&quot;&gt;&amp;#123;x&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;] == filter_date, file_list)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# éå†è¿­ä»£å™¨, é€šè¿‡retrbinaryä¸‹è½½æ–‡ä»¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; items:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    print(&lt;span class=&quot;string&quot;&gt;f&quot;file name: &lt;span class=&quot;subst&quot;&gt;&amp;#123;item&amp;#125;&lt;/span&gt;&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; open(&lt;span class=&quot;string&quot;&gt;f&#39;temp/&lt;span class=&quot;subst&quot;&gt;&amp;#123;item&amp;#125;&lt;/span&gt;&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;wb&#39;&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; fp:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ftp.retrbinary(&lt;span class=&quot;string&quot;&gt;f&#39;RETR &lt;span class=&quot;subst&quot;&gt;&amp;#123;item&amp;#125;&lt;/span&gt;&#39;&lt;/span&gt;, fp.write)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# å…³é—­ftp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ftp.quit()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/tags/python/"/>
    
      <category term="ftplib" scheme="https://blog.smart-lifestyle.cn/tags/ftplib/"/>
    
  </entry>
  
  <entry>
    <title>ZSHä¸‹ä½¿ç”¨Anaconda</title>
    <link href="https://blog.smart-lifestyle.cn/posts/e37f/"/>
    <id>https://blog.smart-lifestyle.cn/posts/e37f/</id>
    <published>2020-05-20T13:25:04.204Z</published>
    <updated>2020-05-20T13:25:04.204Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>åœ¨zshä¸‹é¢æ‰¾ä¸åˆ°condaæˆ–è€…æŸ¥çœ‹pythonï¼Œå¹¶ä¸æ˜¯ç”¨çš„anacondaç‰ˆæœ¬çš„<br>anacondaçš„å®‰è£…å‚è€ƒï¼š<a href="https://docs.anaconda.com/anaconda/install/" target="_blank" rel="noopener">https://docs.anaconda.com/anaconda/install/</a></p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘zshrcæ–‡ä»¶ï¼Œå°†ä¸‹é¢è¿™å¥åŠ åˆ°zshrcä¸­ï¼›anaconda_homeä¸ºanacondaçš„å®‰è£…ç›®å½•</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"[anaconda_home]/bin:<span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><ol><li><a href="https://www.jianshu.com/p/74b1c60148e8" target="_blank" rel="noopener">https://www.jianshu.com/p/74b1c60148e8</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;åœ¨zshä¸‹é¢æ‰¾ä¸åˆ°condaæˆ–è€…æŸ¥çœ‹pythonï¼Œå¹¶ä¸æ˜¯ç”¨çš„anacondaç‰ˆæœ¬çš„&lt;br&gt;
anacondaçš„å®‰è£…å‚è€ƒï¼š&lt;a href=&quot;https://docs.anaconda.com/anaconda/install/&quot; target=&quot;_b
      
    
    </summary>
    
    
      <category term="python" scheme="https://blog.smart-lifestyle.cn/categories/python/"/>
    
    
      <category term="Anaconda" scheme="https://blog.smart-lifestyle.cn/tags/Anaconda/"/>
    
      <category term="ZSH" scheme="https://blog.smart-lifestyle.cn/tags/ZSH/"/>
    
  </entry>
  
</feed>
