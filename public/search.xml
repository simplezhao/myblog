<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Python</title>
    <url>/posts/aaa7/</url>
    <content><![CDATA[<blockquote>
<p>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://github.com/python-poetry/poetry" target="_blank" rel="noopener">https://github.com/python-poetry/poetry</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/110721747" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/110721747</a></li>
<li><a href="https://blog.csdn.net/daihaoxin/article/details/109262807" target="_blank" rel="noopener">https://blog.csdn.net/daihaoxin/article/details/109262807</a></li>
</ol>
</blockquote>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>dependency</tag>
      </tags>
  </entry>
  <entry>
    <title>Python Type Checking</title>
    <url>/posts/acc1/</url>
    <content><![CDATA[<blockquote>
<p>å‚è€ƒï¼š</p>
<ol>
<li>
<p><a href="https://testdriven.io/blog/python-type-checking/" target="_blank" rel="noopener">https://testdriven.io/blog/python-type-checking/</a></p>
</li>
<li>
<p><a href="https://testdriven.io/blog/python-code-quality/#running-code-quality-tools" target="_blank" rel="noopener">https://testdriven.io/blog/python-code-quality/#running-code-quality-tools</a></p>
</li>
</ol>
</blockquote>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>dockeréƒ¨ç½²è®°å½•</title>
    <url>/posts/c5ac/</url>
    <content><![CDATA[<ul>
<li><a href="">x</a> ç£ç›˜åˆå§‹åŒ–</li>
<li><a href="">x</a> ä¿®æ”¹ç³»ç»Ÿæ—¶åŒºä¸ºUTC+8</li>
<li><a href="">x</a> éƒ¨ç½²dockerç¯å¢ƒï¼Œä¿®æ”¹dockerå®‰è£…ä½ç½®</li>
<li><a href="">x</a> ä¼˜åŒ–dockerç¯å¢ƒï¼Œé€‚é…china</li>
<li><a href="">x</a> ä¿®æ”¹ä»£ç é…ç½®æ–‡ä»¶ï¼Œé€‚é…æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ</li>
<li><a href="">x</a> ä»£ç mergeåˆ°masteråˆ†æ”¯</li>
<li><a href="">x</a> å®‰è£…dockeré•œåƒ</li>
<li><a href="">x</a> ä»gitè·å–ä»£ç ï¼Œéƒ¨ç½²</li>
<li><a href="">Â </a> é…ç½®https</li>
<li><a href="">Â </a> æµ‹è¯•</li>
</ul>
<blockquote>
<p>æœ¬æ–‡è®°å½•åœ¨Azure ä¸Šéƒ¨ç½²dockeråº”ç”¨çš„è¿‡ç¨‹</p>
</blockquote>
<h2 id="ç£ç›˜åˆå§‹åŒ–">ç£ç›˜åˆå§‹åŒ–</h2>
<p>Azureæä¾›çš„ç£ç›˜ä¸ºç³»ç»Ÿç›˜+æ•°æ®ç›˜ï¼Œæ•°æ®ç›˜çš„å¤§å°åœ¨æ–°å»ºè™šæ‹Ÿæœºçš„æ—¶å€™å¯ä»¥é€‰ï¼Œé»˜è®¤æ•°æ®ç›˜æ˜¯æœªæŒ‚è½½åˆ°ç³»ç»Ÿä¸Šçš„ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‚è½½ï¼ŒæŒ‚è½½æ•°æ®ç›˜å¯ä»¥å‚è€ƒï¼š<br>
<a href="https://docs.azure.cn/zh-cn/virtual-machines/linux/add-disk" target="_blank" rel="noopener">https://docs.azure.cn/zh-cn/virtual-machines/linux/add-disk</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡dh -hå‘½ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿç£ç›˜çš„å¤§å°å’Œä½¿ç”¨æƒ…å†µï¼Œç›®å‰æ²¡æœ‰æ•°æ®ç›˜</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs           796M  676K  795M   1% /run</span><br><span class="line">/dev/sda1        29G  1.5G   28G   5% /</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /dev/shm</span><br><span class="line">tmpfs           5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda15      105M  3.6M  101M   4% /boot/efi</span><br><span class="line">/dev/sdb1        16G   45M   15G   1% /mnt</span><br><span class="line">tmpfs           796M     0  796M   0% /run/user/1000</span><br><span class="line">........</span><br><span class="line"><span class="comment"># æ“ä½œå®Œä¹‹åï¼Œ df -hï¼Œæœ€åä¸€è¡Œå·²ç»æŒ‚åœ¨åˆ°/datadriveä¸Š</span></span><br><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            3.9G     0  3.9G   0% /dev</span><br><span class="line">tmpfs           796M  680K  795M   1% /run</span><br><span class="line">/dev/sda1        29G  1.5G   28G   5% /</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /dev/shm</span><br><span class="line">tmpfs           5.0M     0  5.0M   0% /run/lock</span><br><span class="line">tmpfs           3.9G     0  3.9G   0% /sys/fs/cgroup</span><br><span class="line">/dev/sda15      105M  3.6M  101M   4% /boot/efi</span><br><span class="line">/dev/sdb1        16G   45M   15G   1% /mnt</span><br><span class="line">tmpfs           796M     0  796M   0% /run/user/1000</span><br><span class="line">/dev/sdc1       196G   61M  186G   1% /datadrive</span><br></pre></td></tr></table></figure>
<p><strong>ä¹‹åçš„æ‰€æœ‰æ–‡ä»¶æ“ä½œéƒ½æ˜¯åœ¨/datadriveä¸‹</strong><br>
é»˜è®¤datadriveçš„æƒé™ä¸ºrootæƒé™ï¼Œä¿®æ”¹æ‰€æœ‰è€…ä¸ºå½“å‰ç”¨æˆ·</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo chown -R cniabservice:cniabservice /datadrive/</span><br></pre></td></tr></table></figure>
<h2 id="ä¿®æ”¹ç³»ç»Ÿæ—¶åŒº">ä¿®æ”¹ç³»ç»Ÿæ—¶åŒº</h2>
<p>Azureæä¾›çš„linuxé»˜è®¤æ—¶åŒºä¸ºUTCï¼Œéœ€è¦æ”¹ä¸ºä¸­å›½UTC+8æ—¶åŒº<br>
ç®€å•æ“ä½œå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>
<p><strong>!docker å†…æ—¶åŒºé»˜è®¤ä¹Ÿä¸ºUTCï¼Œè·Ÿä¸»æœºå¹¶ä¸åŒæ­¥ï¼Œéœ€è¦ä¿®æ”¹ä¸ºUTC+8ï¼Œä¸‹é¢ä¼šè¯´æ˜ï¼Œä¸åœ¨è¿™é‡Œä»‹ç»</strong></p>
<h2 id="å®‰è£…docker">å®‰è£…docker</h2>
<h3 id="1-ä½¿ç”¨Ubuntu-æºè¿›è¡Œå®‰è£…">1. ä½¿ç”¨Ubuntu æºè¿›è¡Œå®‰è£…</h3>
<p>å‚è€ƒ <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove docker docker-engine docker.io containerd runc</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install \</span><br><span class="line">apt-transport-https \</span><br><span class="line">ca-certificates \</span><br><span class="line">curl \</span><br><span class="line">gnupg-agent \</span><br><span class="line">software-properties-common</span><br><span class="line"></span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo apt-key fingerprint 0EBFCD88</span><br><span class="line"></span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">   <span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string">   <span class="variable">$(lsb_release -cs)</span> \</span></span><br><span class="line"><span class="string">   stable"</span></span><br><span class="line"></span><br><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br><span class="line">sudo apt-get install docker-compose</span><br></pre></td></tr></table></figure>
<p><strong>apt-getæ˜¯ä»å›½å¤–ç½‘ç«™ä¸‹è½½ï¼Œå¯èƒ½é€Ÿåº¦ä¼šéå¸¸æ…¢</strong>ï¼Œå¯ä»¥ä¸‹è½½debç¦»çº¿åŒ…ï¼š<br>
<a href="https://download.docker.com/linux/ubuntu/dists/bionic/pool/stable/amd64/" target="_blank" rel="noopener" title="é’ˆå¯¹äºubuntu 18.04">https://download.docker.com/linux/ubuntu/dists/bionic/pool/stable/amd64/</a></p>
<blockquote>
<p>Go to <a href="https://download.docker.com/linux/ubuntu/dists/" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu/dists/</a>, choose your Ubuntu version, browse to pool/stable/, choose amd64, armhf, arm64, ppc64el, or s390x, and download the .deb file for the Docker Engine - Community version you want to install.<br>
ä½¿ç”¨dpkg -i *.deb å®‰è£…é¡ºåºä¸ºï¼š</p>
</blockquote>
<ol>
<li><a href="http://containerd.io" target="_blank" rel="noopener">containerd.io</a></li>
<li>docker-ce</li>
<li>docker-ce-cli</li>
<li>æœ€å apt-get install docker-compose</li>
</ol>
<p>dockeré»˜è®¤rootæƒé™æ“ä½œï¼Œå°†å½“å‰ç”¨æˆ·åŠ å…¥rootç»„ï¼Œå…æ¯æ¬¡æ“ä½œè¾“å…¥å¯†ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># If you would like to use Docker as a non-root user, you should now consider adding your user to the â€œdockerâ€ group with something like:</span></span><br><span class="line">sudo usermod -aG docker your-user</span><br></pre></td></tr></table></figure>
<h3 id="2-ä¿®æ”¹dockeré•œåƒå­˜å‚¨ç­‰å­˜å‚¨ä½ç½®">2. ä¿®æ”¹dockeré•œåƒå­˜å‚¨ç­‰å­˜å‚¨ä½ç½®</h3>
<p>é»˜è®¤å­˜å‚¨ä½ç½®åœ¨ç³»ç»Ÿç›˜ï¼Œè¦å°†å…¶è¿ç§»è‡³æ•°æ®ç›˜<br>
åœ¨æ§åˆ¶å°è¾“å…¥docker infoï¼ŒæŸ¥çœ‹å½“å‰docker å­˜å‚¨ä½ç½®<br>
<img src="https://oss.smart-lifestyle.cn/blog/qx062.jpg" alt=""><br>
åœ¨/etc/docker/ä¸‹æ–°å»ºdaemon.jsonæ–‡ä»¶, graphä¸ºå­˜å‚¨ä½ç½®</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"registry-mirrors"</span>: [<span class="string">"https://1x2ypu6h.mirror.aliyuncs.com"</span>],</span><br><span class="line">  <span class="attr">"hosts"</span>:[</span><br><span class="line">    <span class="string">"tcp://0.0.0.0:2375"</span>,</span><br><span class="line">    <span class="string">"unix:///var/run/docker.sock"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"graph"</span>: <span class="string">"/datadrive/dockerdata"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡å¯dockerï¼Œsudo service docker restartï¼Œå†æ¬¡docker infoæŸ¥çœ‹é…ç½®<br>
<img src="https://oss.smart-lifestyle.cn/blog/7rvdj.jpg" alt=""><br>
<strong>ä¿®æ”¹æˆåŠŸï¼</strong></p>
<h2 id="ä»ä»£ç ä»“åº“è·å–ä»£ç ">ä»ä»£ç ä»“åº“è·å–ä»£ç </h2>
<h3 id="1-pull-request-to-Master">1. pull request to Master</h3>
<p>é‡åˆ°é—®é¢˜ï¼Œæ²¡æœ‰æƒé™è¿›è¡Œåˆå¹¶æ“ä½œï¼Œåªæœ‰å®¡æ‰¹åŠŸèƒ½ï¼Œä¿®æ”¹å¦‚ä¸‹åœ°æ–¹<br>
<img src="https://oss.smart-lifestyle.cn/blog/98qaq.jpg" alt=""></p>
<h3 id="2-åœ¨è¿œç¨‹æœåŠ¡å™¨ä½¿ç”¨git-cloneè·å–ä»£ç ">2. åœ¨è¿œç¨‹æœåŠ¡å™¨ä½¿ç”¨git cloneè·å–ä»£ç </h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å¦‚ä¸‹ç”¨æˆ·åå¯†ç </span></span><br><span class="line"><span class="comment"># ç”¨æˆ·åï¼šjenkins å¯†ç ï¼š***************</span></span><br><span class="line">git <span class="built_in">clone</span> https://dev.azure.com/ds-rnd/*************</span><br></pre></td></tr></table></figure>
<h2 id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir redisdb</span><br><span class="line">mkdir mysqldb</span><br><span class="line">mkdir ssl_key</span><br><span class="line">mkdir conf</span><br><span class="line"><span class="comment"># ä¿®æ”¹nginx.confæ–‡ä»¶</span></span><br><span class="line">mkdir -p static/.well-known</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"1.0.0"</span> \&gt; version</span><br></pre></td></tr></table></figure>
<h3 id="1-æ„å»ºdocker">1. æ„å»ºdocker</h3>
<p>åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸‹æ‰§è¡Œ docker-compose up è¿›è¡Œé¦–æ¬¡ç¼–è¯‘é•œåƒå’Œå¯åŠ¨å®¹å™¨</p>
<h3 id="2-åˆå§‹åŒ–æ•°æ®åº“">2. åˆå§‹åŒ–æ•°æ®åº“</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºabbdriveæ•°æ®åº“</span></span><br><span class="line">python manage.py makemigrations abbdrivemodel</span><br><span class="line">python manage.py migrate</span><br><span class="line">æ‰§è¡Œ</span><br><span class="line">http://g*************.cloudapp.chinacloudapi.cn/**********</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title>git abc tutorial</title>
    <url>/posts/de34/</url>
    <content><![CDATA[<h1>git-abc</h1>
<p>ä¸‹é¢ä»‹ç»ç»å¸¸ç”¨åˆ°ä¸”æœ€åŸºæœ¬çš„git å‘½ä»¤</p>
<h2 id="ä»“åº“ç®¡ç†">ä»“åº“ç®¡ç†</h2>
<h3 id="åˆ›å»ºæœ¬åœ°ä»“åº“">åˆ›å»ºæœ¬åœ°ä»“åº“</h3>
<ul>
<li><code>git init</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir git-abc</span><br><span class="line"><span class="built_in">cd</span> git-abc</span><br><span class="line">git init</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/qm2vb.png" alt="image-20210331222402099"></p>
<h3 id="æ·»åŠ è¿œç¨‹åˆ†æ”¯">æ·»åŠ è¿œç¨‹åˆ†æ”¯</h3>
<ul>
<li><code>git remote add &lt;shortname&gt; &lt;url&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/simplezhao/git-abc.git</span><br></pre></td></tr></table></figure>
<h3 id="æŠ“å–è¿œç¨‹ä»£ç ">æŠ“å–è¿œç¨‹ä»£ç </h3>
<ul>
<li><code>git fetch &lt;remote&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git fetch origin</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/48gpy.png" alt="image-20210331223237496"></p>
<h3 id="æŸ¥çœ‹æŸä¸ªè¿œç¨‹ä»“åº“">æŸ¥çœ‹æŸä¸ªè¿œç¨‹ä»“åº“</h3>
<ul>
<li><code>git remote show &lt;remote&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git remote show origin</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/50dkt.png" alt="image-20210331223628444"></p>
<h3 id="åŒæ­¥è¿œç¨‹åˆ†æ”¯">åŒæ­¥è¿œç¨‹åˆ†æ”¯</h3>
<ul>
<li><code>git checkout -b &lt;branch&gt; &lt;remote&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout -b main origin/main</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/vkntn.png" alt="image-20210331224921389"></p>
<h2 id="ä»£ç ç®¡ç†">ä»£ç ç®¡ç†</h2>
<h3 id="æŸ¥çœ‹å½“å‰åˆ†æ”¯çŠ¶æ€">æŸ¥çœ‹å½“å‰åˆ†æ”¯çŠ¶æ€</h3>
<ul>
<li><code>git status</code></li>
</ul>
<ol>
<li>ä¿®æ”¹readme.mdæ–‡ä»¶</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>
<p>æç¤ºæ–‡ä»¶è¢«ä¿®æ”¹</p>
<p><img src="https://oss.smart-lifestyle.cn/file/jjthz.png" alt="image-20210331225856222"></p>
<ol start="2">
<li>æ–°å¢ä¸€ä¸ªreadme_en.mdæ–‡ä»¶</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure>
<p>æç¤ºæœ‰æœªè·Ÿè¸ªçš„æ–‡ä»¶</p>
<p><img src="https://oss.smart-lifestyle.cn/file/ttydm.png" alt="image-20210331230055526"></p>
<h3 id="æ·»åŠ æ–‡ä»¶">æ·»åŠ æ–‡ä»¶</h3>
<ul>
<li>
<p><code>git add .</code> æ·»åŠ æ‰€æœ‰æ–‡ä»¶</p>
</li>
<li>
<p><code>git add &lt;file&gt;</code>æ·»åŠ æŒ‡å®šæ–‡ä»¶</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">git add .</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ æˆåŠŸåï¼Œæ˜¾ç¤ºå‡†å¤‡æäº¤çš„æ–‡ä»¶</p>
<p><img src="https://oss.smart-lifestyle.cn/file/2m0ge.png" alt="image-20210331230400289"></p>
<h3 id="æäº¤æ–‡ä»¶">æäº¤æ–‡ä»¶</h3>
<ul>
<li><code>git commit -a</code> åœ¨é»˜è®¤ç¼–è¾‘å™¨å†…å¢åŠ æœ¬æ¬¡æäº¤å†…å®¹</li>
<li><code>git commit -m &lt;message&gt;</code>ç®€çŸ­æäº¤</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">git commit -m <span class="string">"update readme file and add new readme for english version"</span></span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/xkx4s.png" alt="image-20210331230900239"></p>
<h3 id="æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯">æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯</h3>
<ul>
<li><code>git push &lt;shortname&gt; &lt;branch&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push origin main</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/136q4.png" alt="image-20210331231029318"></p>
<h3 id="æŸ¥çœ‹æäº¤è®°å½•">æŸ¥çœ‹æäº¤è®°å½•</h3>
<ul>
<li><code>git log</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/wvarp.png" alt="image-20210331231130554"></p>
<h2 id="ä»£ç åˆå¹¶">ä»£ç åˆå¹¶</h2>
<p>å¤šäººå¼€å‘åŒä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦å…±åŒç»´æŠ¤åŒä¸€ä¸ªä»£ç åº“ï¼Œå‡å¦‚æ¯ä¸ªäººè´Ÿè´£ç‹¬ç«‹çš„æ¨¡å—ï¼Œä¸ä¼šæ¶‰åŠåˆ°ä»£ç å†²çª</p>
<p>æŸæ¬¡æäº¤æ—¶ï¼Œæç¤ºå¦‚ä¸‹é—®é¢˜</p>
<p><img src="https://oss.smart-lifestyle.cn/file/d62zw.png" alt="image-20210331232246543"></p>
<p>è¿™æ˜¯å› ä¸ºè¿œç¨‹åˆ†æ”¯è¦ä¼˜å…ˆæœ¬åœ°çš„åˆ†æ”¯ï¼Œéœ€è¦å…ˆæ‰§è¡Œgit pullï¼Œç„¶ååœ¨æ‰§è¡Œgit pushå‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git pull origin main</span><br><span class="line">git push origin main</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œpullæ—¶ä¼šæç¤ºMergeä¿¡æ¯</p>
<p><img src="https://oss.smart-lifestyle.cn/file/xq0ww.png" alt="image-20210331232418971"></p>
<p>å®Œæˆå¹¶é€€å‡ºç¼–è¾‘åï¼Œæç¤ºpullä¿¡æ¯</p>
<p><img src="https://oss.smart-lifestyle.cn/file/ct9wp.png" alt="image-20210331232514825"></p>
<p>å†æ¬¡æ‰§è¡Œgit push origin mainï¼Œæ˜¾ç¤ºæäº¤æˆåŠŸ</p>
<p><img src="https://oss.smart-lifestyle.cn/file/lwto3.png" alt="image-20210331232632195"></p>
<h2 id="åˆ†æ”¯ç®¡ç†">åˆ†æ”¯ç®¡ç†</h2>
<h3 id="åˆ›å»ºæ–°çš„åˆ†æ”¯">åˆ›å»ºæ–°çš„åˆ†æ”¯</h3>
<ul>
<li><code>git branch &lt;branch&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch hotfix</span><br><span class="line">git checkout hotfix</span><br></pre></td></tr></table></figure>
<h3 id="åˆ†æ”¯åˆå¹¶">åˆ†æ”¯åˆå¹¶</h3>
<p>åœ¨ä¸Šä¸€æ­¥æ“ä½œï¼Œå› ä¸ºç³»ç»Ÿå‡ºç°bugï¼Œç´§æ€¥åˆ›å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œç„¶ååœ¨è¿™ä¸ªåˆ†æ”¯ä¸Šè¿›è¡Œä¿®å¤ï¼Œä¿®æ”¹æµ‹è¯•éªŒè¯å®Œæ¯•åï¼Œä»hotfixåˆ†æ”¯åˆå¹¶åˆ°mainåˆ†æ”¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git checkout main</span><br><span class="line">git merge hotfix</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.smart-lifestyle.cn/file/8q60h.png" alt="image-20210331235235214"></p>
<h3 id="åˆ†æ”¯åˆ é™¤">åˆ†æ”¯åˆ é™¤</h3>
<ul>
<li><code>git branch -d &lt;branch&gt;</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git branch -d hotfix</span><br></pre></td></tr></table></figure>
<h3 id="æ‰“æ ‡ç­¾">æ‰“æ ‡ç­¾</h3>
<ul>
<li>
<p><code>git tag</code></p>
</li>
<li>
<p><code>git tag -a &lt;version&gt; -m &lt;message&gt;</code></p>
</li>
</ul>
<p>é€šè¿‡<code>git tag</code>æŸ¥çœ‹ä»“åº“å†…å·²ç»å­˜åœ¨çš„æ ‡ç­¾åˆ—è¡¨</p>
<h4 id="åˆ›å»ºæ ‡ç­¾">åˆ›å»ºæ ‡ç­¾</h4>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git tag -a <span class="string">'1.0'</span> -m <span class="string">"first version"</span></span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨è½»é‡çº§æ ‡ç­¾</p>
<p><code>git tag 1.0-a</code></p>
<h4 id="å…±äº«æ ‡ç­¾">å…±äº«æ ‡ç­¾</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ git pushå‘½ä»¤ä¸ä¼šæŠŠæ ‡ç­¾ä¼ é€åˆ°è¿œç¨‹ä»“åº“ï¼Œå¿…é¡»æ˜¾å¼åœ°æ¨é€æ ‡ç­¾åˆ°æœåŠ¡å™¨ï¼Œç±»ä¼¼äºæ¨é€ä»£ç </p>
<p><code>git push &lt;shortname&gt; &lt;tagname&gt;</code></p>
<p>å¦‚æœæƒ³ä¸€æ¬¡æ¨é€å¤šä¸ªæ ‡ç­¾ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤</p>
<p><code>git push &lt;shortname&gt; --tags</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git push origin 1.0</span><br><span class="line">git push origin --tags</span><br></pre></td></tr></table></figure>
<p>æ¨é€æŒ‡å®šæ ‡ç­¾</p>
<p><img src="https://oss.smart-lifestyle.cn/file/o6cju.png" alt="image-20210401001342160"></p>
<p>æ¨é€æ‰€æœ‰æ ‡ç­¾</p>
<p><img src="https://oss.smart-lifestyle.cn/file/fyqxl.png" alt="image-20210401001405265"></p>
<h2 id="git-é…ç½®">git é…ç½®</h2>
<p>ä½¿ç”¨<code>git config -l </code>æŸ¥çœ‹å½“å‰ä»“åº“é…ç½®</p>
<h3 id="é…ç½®å…¨å±€ä¿¡æ¯">é…ç½®å…¨å±€ä¿¡æ¯</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config --global user.name <span class="string">"yourname"</span></span><br><span class="line">git config --global user.email <span class="string">"youremail"</span></span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®å½“å‰ä»“åº“ä¿¡æ¯">é…ç½®å½“å‰ä»“åº“ä¿¡æ¯</h3>
<p>å’Œå…¨å±€åŒºåˆ«åœ¨äºå»æ‰â€“globalæ ‡è®°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git config user.name <span class="string">"yourname"</span></span><br><span class="line">git config user.email <span class="string">"youremail"</span></span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://git-scm.com/book/en/v2" target="_blank" rel="noopener">Book: Pro Git</a></p>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>git commitè§„èŒƒ</title>
    <url>/posts/76bd/</url>
    <content><![CDATA[<blockquote>
<p>æäº¤git æ—¶ï¼Œå¦‚ä½•èƒ½å°†æäº¤çš„ä¿¡æ¯å†™æ¸…æ™°æ˜äº†ï¼Œé¿å…ä¸è§„èŒƒçš„ä»£ç æäº¤</p>
<p>git æ¯æ¬¡æäº¤éƒ½éœ€è¦å†™commit messageï¼Œå¦åˆ™å°±ä¸å…è®¸æäº¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œcommit messageåº”è¯¥æ¸…æ™°æ˜äº†ï¼Œè¯´æ˜æœ¬æ¬¡æäº¤çš„ç›®çš„ï¼Œå…·ä½“åšäº†ä»€ä¹ˆæ“ä½œï¼Œä½†æ˜¯åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¤§å®¶çš„commit messageåƒå¥‡ç™¾æ€ªï¼Œä¸­è‹±æ–‡æ··åˆä½¿ç”¨ï¼Œfix bugç­‰å„ç§ç¬¼ç»Ÿçš„messageå¸ç©ºè§æ€ªï¼Œè§„èŒƒgit commit messageå¾ˆé‡è¦</p>
</blockquote>
<p>æ¯”è¾ƒæµè¡Œçš„è§„èŒƒæ•´ç†å¦‚ä¸‹ã€‚</p>
<h2 id="commit-message-æ ¼å¼">commit message æ ¼å¼</h2>
<p>å»ºè®®æ¯è¡Œä¸è¶…è¿‡100ä¸ªå­—ç¬¦</p>
<p><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">&lt;BLANK LINE&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;BLANK LINE&gt;</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>type(å¿…é¡»)</p>
<p>ç”¨äºè¯´æ˜git commitçš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢çš„æ ‡è¯†ã€‚</p>
<p>feat: æ–°åŠŸèƒ½ï¼ˆfeatureï¼‰</p>
<p>fix: ä¿®å¤bugï¼Œå¯ä»¥æ˜¯QAå‘ç°çš„BUGï¼Œä¹Ÿå¯ä»¥æ˜¯ç ”å‘è‡ªå·±å‘ç°çš„BUG</p>
<p>docs: æ–‡æ¡£ï¼ˆdocumentï¼‰</p>
<p>style: æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨, æ¯”å¦‚åˆ é™¤å¤šä½™çš„ç©ºè¡Œï¼‰</p>
<p>refactor: é‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç è¿åŠ¨ï¼‰</p>
<p>perf: ä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ</p>
<p>test: å¢åŠ æµ‹è¯•</p>
<p>chore: æ„å»ºè¿‡ç¨‹æˆ–è€…è¾…åŠ©å·¥å…·çš„å˜åŠ¨</p>
<p>revert: å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œéœ€è¦åœ¨bodyä¸­å†™ä¸Šä»å“ªä¸€ä¸ªç‰ˆæœ¬revertçš„</p>
<p>merge: ä»£ç åˆå¹¶</p>
<p>sync: åŒæ­¥ä¸»çº¿æˆ–è€…åˆ†å¸ƒçš„bug</p>
</li>
<li>
<p>scopeï¼ˆå¯é€‰ï¼‰</p>
<p>scopeç”¨äºè¯´æ˜å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®çš„ä¸åŒè€Œä¸åŒ</p>
<p>å¦‚æœä¿®æ”¹å½±å“äº†ä¸æ­¢ä¸€ä¸ªsocopeï¼Œä½ å¯ä»¥ä½¿ç”¨*ä»£æ›¿</p>
</li>
<li>
<p>subjectï¼ˆå¿…é¡»ï¼‰</p>
<p>subjectæ˜¯commitç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50å­—ç¬¦ã€‚</p>
<p>å»ºè®®ä½¿ç”¨ä¸­æ–‡ã€‚</p>
<p>ç»“å°¾ä¸åŠ å¥å·æˆ–è€…å…¶ä»–æ ‡ç‚¹ç¬¦å·</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ä¸¾ä¾‹</span></span><br><span class="line">docs(api): æ¥å£è¯´æ˜å®Œå–„</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">feat($</span><span class="bash">browser): onUrlChange event (popstate/hashchange/polling)</span></span><br><span class="line"></span><br><span class="line">Added new event to $browser:</span><br><span class="line">- forward popstate event if available</span><br><span class="line">- forward hashchange event if popstate not available</span><br><span class="line">- do polling when neither popstate nor hashchange available</span><br><span class="line"></span><br><span class="line">Breaks $browser.onHashChange, which was removed (use onUrlChange instead)</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">fix($</span><span class="bash">compile): couple of unit tests <span class="keyword">for</span> IE9</span></span><br><span class="line"></span><br><span class="line">Older IEs serialize html uppercased, but IE9 does not...</span><br><span class="line">Would be better to expect case insensitive, unfortunately jasmine does</span><br><span class="line">not allow to user regexps for throw expectations.</span><br><span class="line"></span><br><span class="line">Closes #392</span><br><span class="line">Breaks foo.bar api, foo.baz should be used instead</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">feat($</span><span class="bash">compile): simplify isolate scope bindings</span></span><br><span class="line"></span><br><span class="line">Changed the isolate scope binding options to:</span><br><span class="line">  - @attr - attribute binding (including interpolation)</span><br><span class="line">  - =model - by-directional model binding</span><br><span class="line">  - &amp;expr - expression execution binding</span><br><span class="line"></span><br><span class="line">This change simplifies the terminology as well as</span><br><span class="line">number of choices available to the developer. It</span><br><span class="line">also supports local name aliasing from the parent.</span><br><span class="line"></span><br><span class="line">BREAKING CHANGE: isolate scope bindings definition has changed and</span><br><span class="line">the inject option for the directive controller injection was removed.</span><br><span class="line"></span><br><span class="line">To migrate the code follow the example below:</span><br><span class="line"></span><br><span class="line">Before:</span><br><span class="line"></span><br><span class="line">scope: &#123;</span><br><span class="line">  myAttr: 'attribute',</span><br><span class="line">  myBind: 'bind',</span><br><span class="line">  myExpression: 'expression',</span><br><span class="line">  myEval: 'evaluate',</span><br><span class="line">  myAccessor: 'accessor'</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">After:</span><br><span class="line"></span><br><span class="line">scope: &#123;</span><br><span class="line">  myAttr: '@',</span><br><span class="line">  myBind: '@',</span><br><span class="line">  myExpression: '&amp;',</span><br><span class="line">  // myEval - usually not useful, but in cases where the expression is assignable, you can use '='</span><br><span class="line">  myAccessor: '=' // in directive's template change myAccessor() to myAccessor</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">The removed `inject` wasn't generaly useful for directives so there should be no code using it.</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨git-commit-è§„èŒƒçš„å¥½å¤„">ä½¿ç”¨git commit è§„èŒƒçš„å¥½å¤„</h3>
<ol>
<li>ä¾¿äºè¿½æº¯æäº¤å†å²è¿›è¡Œè¿½æº¯</li>
<li>ä¸€æ—¦çº¦æŸäº†commit messageï¼Œå°±ä¸èƒ½å†ä¸€è‚¡è„‘çš„æŠŠå„ç§å„æ ·çš„æ”¹åŠ¨éƒ½æ”¾åœ¨ä¸€ä¸ªgit commité‡Œé¢</li>
<li>ä¾¿äºè‡ªåŠ¨åŒ–è¾“å‡ºchange log(<a href="http://CHANGELOG.md" target="_blank" rel="noopener">CHANGELOG.md</a>)</li>
</ol>
<p>[1] <a href="https://developer.aliyun.com/article/770277?accounttraceid=d4154093542c440aa51196b76d1ccbe3eyfz" target="_blank" rel="noopener">https://developer.aliyun.com/article/770277?accounttraceid=d4154093542c440aa51196b76d1ccbe3eyfz</a></p>
<p>[2] <a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#" target="_blank" rel="noopener">https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#</a></p>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git commit</tag>
      </tags>
  </entry>
  <entry>
    <title>github actionsåˆè¯•ç‰›åˆ€</title>
    <url>/posts/9f77/</url>
    <content><![CDATA[<blockquote>
<p>æœ€è¿‘å°†hexåšå®¢éƒ¨ç½²ç”±æ‰‹åŠ¨æ‰§è¡Œï¼Œæ”¹ä¸ºé€šè¿‡github actionsè‡ªåŠ¨éƒ¨ç½²ï¼Œè¿™é‡Œåšä¸‹è®°å½•</p>
</blockquote>
<h3 id="è‡ªåŠ¨éƒ¨ç½²åŸç†">è‡ªåŠ¨éƒ¨ç½²åŸç†</h3>
<p>ä½¿ç”¨github actionsåŠŸèƒ½ï¼Œå°†hexoç”Ÿæˆçš„é™æ€æ–‡ä»¶åœ¨æ¯æ¬¡æäº¤ä»£ç æ—¶ï¼Œé€šè¿‡scpå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨</p>
<h3 id="ä½¿ç”¨æ­¥éª¤">ä½¿ç”¨æ­¥éª¤</h3>
<p><img src="https://oss.smart-lifestyle.cn/file/jl6ye.png" alt="image-20210326140634778"></p>
<p>åœ¨gitä»“åº“æ–°å¢actionsï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># This is a basic workflow to help you get started with Actions</span></span><br><span class="line"></span><br><span class="line"><span class="attr">name:</span> <span class="string">CI</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Controls when the action will run. </span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="comment"># Triggers the workflow on push or pull request events but only for the master branch</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> <span class="string">[</span> <span class="string">master</span> <span class="string">]</span></span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> <span class="string">[</span> <span class="string">master</span> <span class="string">]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Allows you to run this workflow manually from the Actions tab</span></span><br><span class="line">  <span class="attr">workflow_dispatch:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="comment"># This workflow contains a single job called "build"</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="comment"># The type of runner that the job will run on</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Steps represent a sequence of tasks that will be executed as part of the job</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="comment"># Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># Runs a single command using the runners shell</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">a</span> <span class="string">one-line</span> <span class="string">script</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">echo</span> <span class="string">Hello,</span> <span class="string">world!</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># Runs a set of commands using the runners shell</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">a</span> <span class="string">multi-line</span> <span class="string">script</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">Add</span> <span class="string">other</span> <span class="string">actions</span> <span class="string">to</span> <span class="string">build,</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">test,</span> <span class="string">and</span> <span class="string">deploy</span> <span class="string">your</span> <span class="string">project.</span></span><br><span class="line">          <span class="string">ls</span></span><br><span class="line">          <span class="string">pwd</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">copy</span> <span class="string">file</span> <span class="string">via</span> <span class="string">ssh</span> <span class="string">password</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">appleboy/scp-action@master</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">host:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HOST</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">username:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.USERNAME</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.PASSWORD</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">port:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.PORT</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">source:</span> <span class="string">"public/*,!public/robots.txt"</span></span><br><span class="line">          <span class="attr">target:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.TARGET_DIR</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>è¯´æ˜</p>
<ul>
<li>
<p>on è§¦å‘æ¡ä»¶</p>
<ul>
<li>push æ¨é€ç›®æ ‡ä»“åº“</li>
<li>pull_request åˆå¹¶åˆ†æ”¯ä»“åº“</li>
</ul>
</li>
<li>
<p>steps æ­¥éª¤</p>
<ul>
<li>uses: actions/checkout@v2 è·å–ä»£ç </li>
<li>uses: appleboy/scp-action@master ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œé€šè¿‡scp ä¼ è¾“æ–‡ä»¶
<ul>
<li>host: $</li>
<li>username: $</li>
<li>password: $</li>
<li>port: $</li>
<li>source: â€œpublic/*,!public/robots.txtâ€</li>
<li>target: $</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ä¸Šé¢çš„secretsä¿¡æ¯åœ¨githubä¸Šè¿›è¡Œé…ç½®</p>
<p><img src="https://oss.smart-lifestyle.cn/file/oydi5.png" alt="image-20210326141554880"></p>
<p>æ¯å½“pushä»£ç åˆ°ä»“åº“masteråˆ†æ”¯æ—¶ï¼Œä¼šè¿›è¡Œæ‰§è¡Œactionsï¼Œè¿›è¡Œåšå®¢éƒ¨ç½²</p>
<p><img src="https://oss.smart-lifestyle.cn/file/jbae5.png" alt="image-20210326141938875"></p>
<h3 id="ä¸è¶³">ä¸è¶³</h3>
<ol>
<li>ç›®å‰æ²¡æœ‰é€šè¿‡github actionsç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ¨é€ä¹‹å‰éœ€è¦æ‰‹åŠ¨æ‰§è¡Œhexo gï¼Œè¿™ä¸ªåœ¨è¿›ä¸€æ­¥ç ”ç©¶ä¹‹åå†å°è¯•</li>
<li>github æœ¬èº«å¯ä»¥æ·»åŠ Deploy keysï¼Œä¸ºäº†å®‰å…¨ï¼Œscpåº”è¯¥é¿å…ä½¿ç”¨å¯†ç è¿›è¡Œæ“ä½œï¼Œä¹Ÿåœ¨ç ”ç©¶æ˜ç™½ä¹‹åå†å°è¯•</li>
<li>ç”±äºé—®é¢˜1ï¼Œå°¤ä¸ºhexo gä¼šé‡æ–°ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œæ¯æ¬¡pushçš„æ—¶å€™ä¼šæœ‰å¤§é‡å¸¦æäº¤æ–‡ä»¶ã€‚ã€‚ã€‚</li>
</ol>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<p>[1] <a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html" target="_blank" rel="noopener">GitHub Actions å…¥é—¨æ•™ç¨‹</a></p>
<p>[2] <a href="https://github.com/appleboy/scp-action" target="_blank" rel="noopener">ğŸš€ SCP for GitHub Actions</a></p>
<p>[3] <a href="https://dev.to/miangame/how-to-automate-a-deploy-in-a-vps-with-github-actions-via-ssh-101e" target="_blank" rel="noopener">How to automate a deploy in a VPS with GitHub actions via SSH</a></p>
]]></content>
      <categories>
        <category>éƒ¨ç½²</category>
      </categories>
      <tags>
        <tag>github actions</tag>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>gitä»“åº“ç”¨æˆ·æƒé™é—®é¢˜</title>
    <url>/posts/f5f9/</url>
    <content><![CDATA[<blockquote>
<p>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªgithubè´¦å·è¿›è¡Œä»£ç çš„æ‹‰å»å’Œæ¨é€ï¼Œä½†å‡å¦‚ç°åœ¨æœ‰ä¸€ä¸ªç§æœ‰ä»“åº“ï¼Œè€Œä¸”éœ€è¦ä½¿ç”¨å¦å¤–ä¸€ä¸ªgithubè´¦å·ï¼Œå¯èƒ½ä¼šå‡ºç°authentication error</p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>git config user.email</code>æ˜¯æ²¡æœ‰åŠæ³•æ›´æ”¹è¿™ä¸ªä»“åº“çš„è®¤è¯ä¿¡æ¯çš„</p>
<p>è¿™æ˜¯å› ä¸ºï¼Œæˆ‘ä»¬é€šè¿‡httpsæ“ä½œä»“åº“æ—¶ï¼Œä¼šä½¿ç”¨ç¼“å­˜åœ¨æœ¬æœºçš„æˆæƒè®¤è¯ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¼šä½¿ç”¨ä¹‹å‰è´¦æˆ·çš„ä¿¡æ¯ã€‚</p>
<p>æ›´æ”¹æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œç»™ä»“åº“åœ°å€ä¸ŠåŠ ä¸Šä½ æ‰€è¦ä½¿ç”¨çš„ç”¨æˆ·å(username2)å³å¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> repo</span><br><span class="line">git remote <span class="built_in">set</span>-url origin https://username2@github.com/&lt;username&gt;/repo</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://stackoverflow.com/questions/65932601/how-to-change-user-for-git-repository" target="_blank" rel="noopener">How to change user for git repository</a></p>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>.gitignoreæ¨¡å¼åŒ¹é…</title>
    <url>/posts/4da0/</url>
    <content><![CDATA[<ul>
<li>åŒ¹é…æ¨¡å¼å‰ä½¿ç”¨ <code>/</code> è¡¨ç¤ºæ ¹ç›®å½•<br>
/filename è¡¨ç¤ºåŒ¹é…æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶filename</li>
<li>åŒ¹é…æ¨¡å¼åä½¿ç”¨ <code>/</code> ä»£è¡¨æ˜¯ç›®å½•ï¼ˆä¸æ˜¯æ–‡ä»¶ï¼‰<br>
dirname/ è¡¨ç¤ºåŒ¹é…çš„æ˜¯dirnameæ–‡ä»¶å¤¹</li>
<li>åŒ¹é…æ¨¡å¼å‰åŠ  <code>ï¼</code> è¡¨ç¤ºå–å</li>
<li><code>*</code> ä»£è¡¨ä»»æ„ä¸ªå­—ç¬¦<br>
db*.json è¡¨ç¤ºåŒ¹é…ä»¥dbå¼€å¤´çš„jsonæ–‡ä»¶</li>
<li><code>?</code> åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦<br>
db?.json è¡¨ç¤ºä»¥dbå¼€å¤´å¹¶ä¸”æ–‡ä»¶åä¸ºä¸‰ä¸ªå­—ç¬¦çš„jsonæ–‡ä»¶</li>
<li><code>**</code> åŒ¹é…ä»»æ„çº§ç›®å½•</li>
</ul>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>gitignore</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World 201903080551</title>
    <url>/posts/59f6/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start">Quick Start</h2>
<h3 id="Create-a-new-post">Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server">Run server</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files">Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
]]></content>
      <categories>
        <category>book</category>
      </categories>
      <tags>
        <tag>Testing</tag>
      </tags>
  </entry>
  <entry>
    <title>jupyterlab + jupyterhub + supervisor</title>
    <url>/posts/93be/</url>
    <content><![CDATA[<blockquote>
<p>è®°å½•åœ¨jupyterhub ä¸­ä½¿ç”¨jupyterlabï¼Œå¹¶ä¸”ä½¿ç”¨supervisorç®¡ç†è¿›ç¨‹è¿è¡Œ<br>
supervisor åœ¨érootç”¨æˆ·ä¸‹è¿è¡Œå’Œç®¡ç†è¿›ç¨‹</p>
</blockquote>
<h3 id="å®‰è£…jupyterhub">å®‰è£…jupyterhub</h3>
<blockquote>
<p>å‰ææ¡ä»¶</p>
<ol>
<li>python 3.5+</li>
<li>nodejs/npm</li>
</ol>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… http-proxyï¼Œå¹¶ä½¿ç”¨æ·˜å®é•œåƒ</span></span><br><span class="line">npm install -g configurable-http-proxy --registry=https://registry.npm.taobao.org</span><br><span class="line"><span class="comment"># å®‰è£… jupyterhubï¼Œå¹¶ä½¿ç”¨è±†ç“£é•œåƒ</span></span><br><span class="line">python3 -m pip install jupyterhub -i https://pypi.douban.com/simple/</span><br><span class="line"><span class="comment"># åœ¨ç»ˆç«¯ä¸­è¾“å…¥jupyterhub çœ‹æ˜¯å¦è¿è¡Œ</span></span><br><span class="line">jupyterhub</span><br><span class="line"><span class="comment"># Visit https://localhost:8000 in your browser, and sign in with your unix PAM credentials.</span></span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…-jupyterlabï¼Œå¹¶é…ç½®åˆ°-jupyterhubä¸­">å®‰è£… jupyterlabï¼Œå¹¶é…ç½®åˆ° jupyterhubä¸­</h3>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… jupyterlab</span></span><br><span class="line">python3 -m pip install jupyterlab -i https://pypi.douban.com/simple/</span><br><span class="line"><span class="comment"># é€šè¿‡ jupyterhubç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œå¹¶å­˜æ”¾åœ¨ $HOME/jupyterhubä¸­</span></span><br><span class="line">jupyterhub --generate-config</span><br><span class="line"><span class="comment"># ç¼–è¾‘ jupyterhub_config.py</span></span><br><span class="line"><span class="comment"># è®¾å®šä½ çš„å¯åŠ¨æ‰“å¼€ç›®å½•</span></span><br><span class="line">c.Spawner.notebook_dir = <span class="string">'/home/simple/develop/jupyter_home'</span></span><br><span class="line"><span class="comment"># è®¾å®šä»¥ jupyterlabè¿è¡Œ</span></span><br><span class="line">c.Spawner.default_url = <span class="string">'/lab'</span></span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…supervisorï¼Œå¹¶å°†-jupyterhubç®¡ç†åŠ å…¥å…¶ä¸­">å®‰è£…supervisorï¼Œå¹¶å°† jupyterhubç®¡ç†åŠ å…¥å…¶ä¸­</h3>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…supervisor</span></span><br><span class="line">python -m pip install supervisor</span><br><span class="line"><span class="comment"># ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œæ”¾åœ¨/etc/ ä¸­</span></span><br><span class="line">echo_supervisord_conf &gt; /etc/supervisord.conf </span><br><span class="line"><span class="comment"># åˆ›å»ºé…ç½®æ–‡ä»¶å¤¹</span></span><br><span class="line">sudo mkdir -p /etc/supervisor/conf.d/</span><br><span class="line"><span class="comment"># ç¼–è¾‘ supervisord.conf ï¼Œåœ¨æœ€åå–æ¶ˆæ³¨é‡Šï¼ŒåŠ å…¥f iles = /etc/supervisor/conf.d/*.conf</span></span><br><span class="line">[include]</span><br><span class="line">;files = relative/directory/*.ini</span><br><span class="line">files = /etc/supervisor/conf.d/*.conf</span><br><span class="line"><span class="comment"># ä¿®æ”¹å¯åŠ¨ç”¨æˆ·ä¸ºå½“å‰ç”¨æˆ·ï¼Œå¦‚æœæ˜¯rootï¼Œè¯·å¿½ç•¥</span></span><br><span class="line">[supervisord]</span><br><span class="line">user=simple</span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"># åœ¨ /etc/supervisor/<span class="keyword">conf</span>.d/ æ–°å»º jupyterhub.<span class="keyword">conf</span>ï¼Œ å†…å®¹å¦‚ä¸‹</span><br><span class="line">[program:jupyterhub]</span><br><span class="line"><span class="keyword">command</span>=jupyterhub -<span class="keyword">f</span> /home/simple/jupyterhub/jupyterhub_config.<span class="keyword">py</span></span><br><span class="line">directory=/home/simple/jupyterhub</span><br><span class="line">autostart=true</span><br><span class="line">autorestart=true</span><br><span class="line">startretries=<span class="number">3</span></span><br><span class="line">exitcodes=<span class="number">0</span>,<span class="number">2</span></span><br><span class="line">stopsignal=TERM</span><br><span class="line">redirect_stderr=true</span><br><span class="line">stdout_logfile=/home/simple/jupyterhub/<span class="built_in">log</span>/jupyterhub.<span class="built_in">log</span></span><br><span class="line">stdout_logfile_maxbytes=<span class="number">1</span>MB</span><br><span class="line">stdout_logfile_backups=<span class="number">10</span></span><br><span class="line">user=simple</span><br></pre></td></tr></table></figure>
<h3 id="è¿è¡Œ">è¿è¡Œ</h3>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åœ¨ä»»æ„ä½ç½®è¿è¡Œ supervisordï¼Œå¯åŠ¨ supervisor ä¸»è¿›ç¨‹</span></span><br><span class="line">supervisord</span><br><span class="line"><span class="comment"># é€šè¿‡supervisorctl status æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">supervisorctl status</span><br><span class="line">$ jupyterhub                       RUNNING   pid 16161, uptime 0:24:15</span><br></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®ip:8000ï¼Œè¾“å…¥ç³»ç»Ÿçš„è®¾ç½®çš„ç”¨æˆ·åå¯†ç è¿›è¡Œç™»å½•</p>
<h3 id="é…ç½®https">é…ç½®https</h3>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘ jupyterhub_config.pyï¼Œ é…ç½®ssl_cert å’Œ ssl_key</span></span><br><span class="line">c.JupyterHub.ssl_cert = <span class="string">'/****/*****/ssl_file/full_chain.pem'</span></span><br><span class="line">c.JupyterHub.ssl_key = <span class="string">'/****/****/ssl_file/private.key'</span></span><br><span class="line"><span class="comment"># ä¿å­˜åé‡å¯supervisor</span></span><br><span class="line">supervisorctl restart jupyterhub</span><br></pre></td></tr></table></figure>
<p><em>ssl è¯ä¹¦ç”³è¯·å¯ä»¥å‚è€ƒï¼š<a href="https://freessl.cn/" target="_blank" rel="noopener">https://freessl.cn/</a></em><br>
æœ€ç»ˆæ•ˆæœï¼š<br>
<img src="https://oss.smart-lifestyle.cn/blog/mrwzk.png" alt="æ•ˆæœ"></p>
<h3 id="Tips">Tips</h3>
<ul>
<li>å¯ç”¨jupyterlab æ’ä»¶ç®¡ç†</li>
</ul>
<ul>
<li>Settings --&gt; Enable Extension Manager å¯ç”¨</li>
<li>åœ¨ Extension Managerä¸­æœç´¢managerï¼Œé€‰æ‹©@jupyter-widgets/jupyterlab-managerï¼Œç‚¹å‡»å®‰è£…</li>
</ul>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<ol>
<li><a href="https://juejin.im/post/5d80da83e51d45620c1c5471" target="_blank" rel="noopener">å¦‚ä½•å®‰è£…supervisor</a></li>
<li><a href="https://developer.aliyun.com/mirror/NPM" target="_blank" rel="noopener">npmæ·˜å®é•œåƒ</a></li>
<li><a href="https://www.jianshu.com/p/c5b7c619dd0b" target="_blank" rel="noopener">è±†ç“£pythonæº</a></li>
<li><a href="https://github.com/jupyterhub/jupyterhub-tutorial/tree/master/supervisor" target="_blank" rel="noopener">jupyterhubå®˜ç½‘ supervisorå‚è€ƒ</a></li>
<li><a href="https://jupyterlab.readthedocs.io/en/latest/user/jupyterhub.html" target="_blank" rel="noopener">é…ç½®jupyterhub ä½¿ç”¨jupyterlab</a></li>
<li><a href="https://jupyter.org/install" target="_blank" rel="noopener">jupyterlabå®‰è£…</a></li>
<li><a href="https://github.com/jupyterhub/jupyterhub" target="_blank" rel="noopener">jupyterhubå®‰è£…</a></li>
<li><a href="https://jupyterhub.readthedocs.io/en/stable/getting-started/security-basics.html" target="_blank" rel="noopener">ssl åŠ å¯† httpsåŒ–</a></li>
</ol>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>jupyterlab</tag>
      </tags>
  </entry>
  <entry>
    <title>kombu.exceptions.EncodeError XXXX is not JSON serializable</title>
    <url>/posts/3277/</url>
    <content><![CDATA[<p>æœ¬æ–‡è®°å½•åœ¨ä½¿ç”¨celeryæ—¶ï¼Œä»»åŠ¡å‡½æ•°å‚æ•°åºåˆ—åŒ–é—®é¢˜</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@celery_app.task(name="create_subscription")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_subscription_file</span><span class="params">(req: SubscriptionRequest)</span>:</span></span><br><span class="line"></span><br><span class="line">    req = SubscriptionRequest(**kwargs)</span><br><span class="line">    subscription_count = req.count</span><br><span class="line">    run_times = math.ceil(subscription_count / <span class="number">200</span>)</span><br><span class="line">    results = &#123;</span><br><span class="line">        <span class="string">"count"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"validDateTime"</span>: <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionRequest</span><span class="params">(BaseModel)</span>:</span></span><br><span class="line">    bearer_token: str = <span class="literal">None</span></span><br><span class="line">    validDateTime: datetime = <span class="literal">None</span></span><br><span class="line">    validPeriodTime: int = <span class="number">12</span></span><br><span class="line">    count: int = <span class="number">200</span></span><br><span class="line">    deviceTypeId: int = <span class="number">2</span></span><br><span class="line">    subscriptionLevelId: int = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">data_json</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.json(exclude=&#123;<span class="string">'bearer_token'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @validator('validDateTime')</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_default_date</span><span class="params">(cls, v)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            v = get_default_valid_datetime()</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">default</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.json()</span><br></pre></td></tr></table></figure>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå‡†å¤‡ä½¿ç”¨pydanticä½œä¸ºå‚æ•°æ ¡éªŒï¼Œå› æ­¤åœ¨ä¼ é€’ç»™celery taskæ—¶ï¼Œä¼ é€’äº†ä¸€ä¸ªclass Instanceï¼›æ¥ç€åœ¨ä»»åŠ¡è°ƒåº¦æ—¶æŠ¥é”™ï¼š</p>
<p><code>kombu.exceptions.EncodeError: SubscriptionRequest is not JSON serializable</code></p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œcelery ä½¿ç”¨JSONè¿›è¡Œåºåˆ—åŒ–æ•°æ®ï¼Œå› æ­¤æ ¹æœ¬åŸå› åœ¨äºé»˜è®¤æƒ…å†µä¸‹classå®ä¾‹æ— æ³•è¢«jsonåºåˆ—åŒ–</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt; json.dumps(SubscriptionRequest)</span><br><span class="line">TypeError: Object of type SubscriptionRequest <span class="keyword">is</span> <span class="keyword">not</span> JSON serializable</span><br></pre></td></tr></table></figure>
<p>json.dumpsæœ‰ä¸€ä¸ªå‚æ•°defaultï¼Œåœ¨python docsæ–‡æ¡£ä¸­æè¿°å¦‚ä¸‹</p>
<blockquote>
<p>å½“ <em>default</em> è¢«æŒ‡å®šæ—¶ï¼Œå…¶åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¯å½“æŸä¸ªå¯¹è±¡æ— æ³•è¢«åºåˆ—åŒ–æ—¶å®ƒä¼šè¢«è°ƒç”¨ã€‚å®ƒåº”è¯¥è¿”å›è¯¥å¯¹è±¡çš„ä¸€ä¸ªå¯ä»¥è¢« JSON ç¼–ç çš„ç‰ˆæœ¬æˆ–è€…å¼•å‘ä¸€ä¸ª <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#TypeError" target="_blank" rel="noopener"><code>TypeError</code></a>ã€‚å¦‚æœæ²¡æœ‰è¢«æŒ‡å®šï¼Œåˆ™ä¼šç›´æ¥å¼•å‘ <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#TypeError" target="_blank" rel="noopener"><code>TypeError</code></a>ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©defaultå‡½æ•°æ¥ä¸ºclasså®ä¾‹åˆ›å»ºä¸€ä¸ªæ–¹æ³•å®ç°å¯¹å…¶jsonåºåˆ—åŒ–ã€‚</p>
<p>è¿™é‡Œæ²¡æœ‰å¯¹ç±»è¿›è¡Œæ”¹é€ ï¼Œè€Œæ˜¯ä¼˜åŒ–å‡½æ•°çš„å…¥å‚</p>
<p>æœ€åæ”¹æˆï¼Œå…ˆä¼ é€’å‚æ•°åˆ°taskï¼Œç„¶ååœ¨taskå†…å¯¹æ‰€æœ‰å‚æ•°è¿›è¡Œpydantic æ ¡éªŒ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@celery_app.task(name="create_subscription")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_subscription_file</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">		<span class="comment"># å¯¹kvå‚æ•°ä½¿ç”¨pydanticæ ¡éªŒ</span></span><br><span class="line">    req = SubscriptionRequest(**kwargs)</span><br><span class="line">    subscription_count = req.count</span><br><span class="line">    run_times = math.ceil(subscription_count / <span class="number">200</span>)</span><br><span class="line">    results = &#123;</span><br><span class="line">        <span class="string">"count"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">"validDateTime"</span>: <span class="literal">None</span></span><br><span class="line">    &#125;</span><br><span class="line">    result_queue = Queue()</span><br><span class="line">		...</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://stackoverflow.com/questions/10252010/serializing-class-instance-to-json" target="_blank" rel="noopener">class serialize</a></p>
<p>[2] <a href="https://github.com/celery/celery/issues/5922" target="_blank" rel="noopener">github issue</a></p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>celery</tag>
      </tags>
  </entry>
  <entry>
    <title>ZSHä¸‹ä½¿ç”¨Anaconda</title>
    <url>/posts/e37f/</url>
    <content><![CDATA[<blockquote>
<p>åœ¨zshä¸‹é¢æ‰¾ä¸åˆ°condaæˆ–è€…æŸ¥çœ‹pythonï¼Œå¹¶ä¸æ˜¯ç”¨çš„anacondaç‰ˆæœ¬çš„<br>
anacondaçš„å®‰è£…å‚è€ƒï¼š<a href="https://docs.anaconda.com/anaconda/install/" target="_blank" rel="noopener">https://docs.anaconda.com/anaconda/install/</a></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘zshrcæ–‡ä»¶ï¼Œå°†ä¸‹é¢è¿™å¥åŠ åˆ°zshrcä¸­ï¼›anaconda_homeä¸ºanacondaçš„å®‰è£…ç›®å½•</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="string">"[anaconda_home]/bin:<span class="variable">$PATH</span>"</span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://www.jianshu.com/p/74b1c60148e8" target="_blank" rel="noopener">https://www.jianshu.com/p/74b1c60148e8</a></li>
</ol>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>Anaconda</tag>
        <tag>ZSH</tag>
      </tags>
  </entry>
  <entry>
    <title>python json.dumps unicode</title>
    <url>/posts/b1/</url>
    <content><![CDATA[<blockquote>
<p>åœ¨dumps/dumpä¸­ä½¿ç”¨ensure_ascii=Falseï¼Œæ¥æ‰‹åŠ¨ç¼–ç ä¸ºUTF8æ ¼å¼</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># è¾“å‡ºä¸ºUnicodeç¼–ç ï¼Œä¸ä¾¿äºå¯è§†åŒ–</span></span><br><span class="line">&gt; json.dumps(<span class="string">"æˆ‘çˆ±ChinağŸ‡¨ğŸ‡³"</span>)</span><br><span class="line"><span class="string">'"\\u6211\\u7231China\\ud83c\\udde8\\ud83c\\uddf3"'</span></span><br><span class="line"></span><br><span class="line">&gt; json.dumps(<span class="string">"æˆ‘çˆ±ChinağŸ‡¨ğŸ‡³"</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"><span class="string">'"æˆ‘çˆ±ChinağŸ‡¨ğŸ‡³"'</span></span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://stackoverflow.com/questions/18337407/saving-utf-8-texts-with-json-dumps-as-utf8-not-as-u-escape-sequence" target="_blank" rel="noopener">json dumps unicode</a></p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>json</tag>
      </tags>
  </entry>
  <entry>
    <title>python library package</title>
    <url>/posts/205e/</url>
    <content><![CDATA[<h2 id="è§†è§‰">è§†è§‰</h2>
<ol>
<li></li>
</ol>
<img src="https://oss.smart-lifestyle.cn/blog/cc19h.jpg" />
<blockquote>
<p>[<a href="https://github.com/bokeh/bokeh" target="_blank" rel="noopener">https://github.com/bokeh/bokeh</a>][1]<br>
Bokeh is an interactive visualization library for modern web browsers. It provides elegant, concise construction of versatile graphics, and affords high-performance interactivity over large or streaming datasets. Bokeh can help anyone who would like to quickly and easily make interactive plots, dashboards, and data applications.</p>
</blockquote>
<p>![][image-2]![][image-3]![][image-4]![][image-5]</p>
<h3 id="install">install</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install bokeh</span><br></pre></td></tr></table></figure>
<h2 id="ç”Ÿäº§åŠ›">ç”Ÿäº§åŠ›</h2>
<ol>
<li><img src="https://oss.smart-lifestyle.cn/file/r7d0g.jpg" alt=""></li>
</ol>
<blockquote>
<p>[<a href="https://github.com/PyCQA/isort" target="_blank" rel="noopener">https://github.com/PyCQA/isort</a>][2]<br>
isort your imports, so you donâ€™t have to.<br>
isort is a Python utility / library to sort imports alphabetically, and automatically separated into sections and by type. It provides a command line utility, Python library and plugins for various editors to quickly sort all your imports. It requires Python 3.6+ to run but supports formatting Python 2 code too.</p>
</blockquote>
<h3 id="install-2">install</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install isort</span><br></pre></td></tr></table></figure>
<h3 id="use">use</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">isort file.py</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><img src="https://oss.smart-lifestyle.cn/file/4dv6l.jpg" alt=""></li>
</ol>
<blockquote>
<p>[<a href="https://github.com/pypyr/pypyr" target="_blank" rel="noopener">https://github.com/pypyr/pypyr</a>][3]<br>
pypyr is a free &amp; open-source task-runner that lets you define and run sequential steps in a pipeline.</p>
</blockquote>
<h3 id="install-3">install</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install --upgrade pypyr</span><br></pre></td></tr></table></figure>
<h2 id="æ¡†æ¶">æ¡†æ¶</h2>
<h3 id="äº‹ä»¶é©±åŠ¨ï¼Œè§‚å¯Ÿè€…æ¨¡å¼">äº‹ä»¶é©±åŠ¨ï¼Œè§‚å¯Ÿè€…æ¨¡å¼</h3>
<ol>
<li>RxPY v3.0</li>
</ol>
<blockquote>
<p>[<a href="https://github.com/ReactiveX/RxPY" target="_blank" rel="noopener">https://github.com/ReactiveX/RxPY</a>][4]<br>
A library for composing asynchronous and event-based programs using observable collections and query operator functions in Python</p>
</blockquote>
<h3 id="install-4">install</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip3 install rx</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python library</tag>
      </tags>
  </entry>
  <entry>
    <title>python web--flask jsonify unicode</title>
    <url>/posts/9b/</url>
    <content><![CDATA[<blockquote>
<p>ç±»ä¼¼äºjson.dumpsä¸­ensure_asciiçš„é…ç½®ï¼Œåœ¨flaskä¸­ä¹Ÿæœ‰ç±»ä¼¼é…ç½®ï¼Œæ¥é¿å…jsonifyæ—¶ï¼Œè¿”å›unicodeç¼–ç å­—ç¬¦</p>
</blockquote>
<p>åœ¨flask configä¸­åŠ å…¥<code>app.config['JSON_AS_ASCII'] = False</code>æ¥é¿å…jsonifyå¯¹éasciiå­—ç¬¦è¿›è¡Œunicodeç¼–ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(app_config)</span><br><span class="line">app.config.from_mapping(</span><br><span class="line">    SQLALCHEMY_DATABASE_URI=<span class="string">f"postgresql+psycopg2://<span class="subst">&#123;app_config.DB_USER&#125;</span>:<span class="subst">&#123;app_config.DB_PASSWORD&#125;</span>"</span></span><br><span class="line">                            <span class="string">f"@<span class="subst">&#123;app_config.DB_HOST&#125;</span>:<span class="subst">&#123;app_config.DB_PORT&#125;</span>/<span class="subst">&#123;app_config.DB_NAME&#125;</span>"</span>,</span><br><span class="line">    SQLALCHEMY_TRACK_MODIFICATIONS=<span class="literal">False</span>,</span><br><span class="line">    <span class="comment"># SQLALCHEMY_ECHO=True</span></span><br><span class="line">)</span><br><span class="line">app.config[<span class="string">'JSON_AS_ASCII'</span>] = <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] [<a href="https://stackoverflow.com/questions/37531067/how-to-prevent-unicode-representation-for-latin1-characters" target="_blank" rel="noopener">How to prevent Unicode representation for Latin1 characters?</a>]</p>
]]></content>
      <categories>
        <category>flask</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>flask</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonåŸºç¡€ç¯‡--Exception</title>
    <url>/posts/f1e8/</url>
    <content><![CDATA[<p>ä»¥ä¸‹æ€»ç»“ä¸€ä¸‹pythonçš„å¼‚å¸¸å¤„ç†</p>
<h2 id="åŸºç±»">åŸºç±»</h2>
<h3 id="BaseException">BaseException</h3>
<blockquote>
<p>æ‰€æœ‰å†…ç½®å¼‚å¸¸çš„åŸºç±»ã€‚ å®ƒä¸åº”è¯¥è¢«ç”¨æˆ·è‡ªå®šä¹‰ç±»ç›´æ¥ç»§æ‰¿ (è¿™ç§æƒ…å†µè¯·ä½¿ç”¨ <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#Exception" target="_blank" rel="noopener"><code>Exception</code></a>)ã€‚ å¦‚æœåœ¨æ­¤ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨ <a href="https://docs.python.org/zh-cn/3/library/stdtypes.html#str" target="_blank" rel="noopener"><code>str()</code></a>ï¼Œåˆ™ä¼šè¿”å›å®ä¾‹çš„å‚æ•°è¡¨ç¤ºï¼Œæˆ–è€…å½“æ²¡æœ‰å‚æ•°æ—¶è¿”å›ç©ºå­—ç¬¦ä¸²</p>
</blockquote>
<h3 id="Exception">Exception</h3>
<blockquote>
<p>æ‰€æœ‰å†…ç½®çš„éç³»ç»Ÿé€€å‡ºç±»å¼‚å¸¸éƒ½æ´¾ç”Ÿè‡ªæ­¤ç±»ã€‚ æ‰€æœ‰ç”¨æˆ·è‡ªå®šä¹‰å¼‚å¸¸ä¹Ÿåº”å½“æ´¾ç”Ÿè‡ªæ­¤ç±»</p>
</blockquote>
<h3 id="ArithmeticError">ArithmeticError</h3>
<blockquote>
<p>æ­¤åŸºç±»ç”¨äºæ´¾ç”Ÿé’ˆå¯¹å„ç§ç®—æœ¯ç±»é”™è¯¯è€Œå¼•å‘çš„å†…ç½®å¼‚å¸¸: <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#OverflowError" target="_blank" rel="noopener"><code>OverflowError</code></a>, <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#ZeroDivisionError" target="_blank" rel="noopener"><code>ZeroDivisionError</code></a>, <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#FloatingPointError" target="_blank" rel="noopener"><code>FloatingPointError</code></a></p>
</blockquote>
<h3 id="BufferError">BufferError</h3>
<blockquote>
<p>å½“ä¸ <a href="https://docs.python.org/zh-cn/3/c-api/buffer.html#bufferobjects" target="_blank" rel="noopener">ç¼“å†²åŒº</a> ç›¸å…³çš„æ“ä½œæ— æ³•æ‰§è¡Œæ—¶å°†è¢«å¼•å‘</p>
</blockquote>
<h3 id="LookupError">LookupError</h3>
<blockquote>
<p>æ­¤åŸºç±»ç”¨äºæ´¾ç”Ÿå½“æ˜ å°„æˆ–åºåˆ—æ‰€ä½¿ç”¨çš„é”®æˆ–ç´¢å¼•æ— æ•ˆæ—¶å¼•å‘çš„å¼‚å¸¸: <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#IndexError" target="_blank" rel="noopener"><code>IndexError</code></a>, <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#KeyError" target="_blank" rel="noopener"><code>KeyError</code></a>ã€‚ è¿™å¯ä»¥é€šè¿‡ <a href="https://docs.python.org/zh-cn/3/library/codecs.html#codecs.lookup" target="_blank" rel="noopener"><code>codecs.lookup()</code></a> æ¥ç›´æ¥å¼•å‘</p>
</blockquote>
<h3 id="å…·ä½“å¼‚å¸¸">å…·ä½“å¼‚å¸¸</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">BaseException</span><br><span class="line"> +-- SystemExit</span><br><span class="line"> +-- KeyboardInterrupt</span><br><span class="line"> +-- GeneratorExit</span><br><span class="line"> +-- Exception</span><br><span class="line">      +-- StopIteration</span><br><span class="line">      +-- StopAsyncIteration</span><br><span class="line">      +-- ArithmeticError</span><br><span class="line">      |    +-- FloatingPointError</span><br><span class="line">      |    +-- OverflowError</span><br><span class="line">      |    +-- ZeroDivisionError</span><br><span class="line">      +-- AssertionError</span><br><span class="line">      +-- AttributeError</span><br><span class="line">      +-- BufferError</span><br><span class="line">      +-- EOFError</span><br><span class="line">      +-- ImportError</span><br><span class="line">      |    +-- ModuleNotFoundError</span><br><span class="line">      +-- LookupError</span><br><span class="line">      |    +-- IndexError</span><br><span class="line">      |    +-- KeyError</span><br><span class="line">      +-- MemoryError</span><br><span class="line">      +-- NameError</span><br><span class="line">      |    +-- UnboundLocalError</span><br><span class="line">      +-- OSError</span><br><span class="line">      |    +-- BlockingIOError</span><br><span class="line">      |    +-- ChildProcessError</span><br><span class="line">      |    +-- ConnectionError</span><br><span class="line">      |    |    +-- BrokenPipeError</span><br><span class="line">      |    |    +-- ConnectionAbortedError</span><br><span class="line">      |    |    +-- ConnectionRefusedError</span><br><span class="line">      |    |    +-- ConnectionResetError</span><br><span class="line">      |    +-- FileExistsError</span><br><span class="line">      |    +-- FileNotFoundError</span><br><span class="line">      |    +-- InterruptedError</span><br><span class="line">      |    +-- IsADirectoryError</span><br><span class="line">      |    +-- NotADirectoryError</span><br><span class="line">      |    +-- PermissionError</span><br><span class="line">      |    +-- ProcessLookupError</span><br><span class="line">      |    +-- TimeoutError</span><br><span class="line">      +-- ReferenceError</span><br><span class="line">      +-- RuntimeError</span><br><span class="line">      |    +-- NotImplementedError</span><br><span class="line">      |    +-- RecursionError</span><br><span class="line">      +-- SyntaxError</span><br><span class="line">      |    +-- IndentationError</span><br><span class="line">      |         +-- TabError</span><br><span class="line">      +-- SystemError</span><br><span class="line">      +-- TypeError</span><br><span class="line">      +-- ValueError</span><br><span class="line">      |    +-- UnicodeError</span><br><span class="line">      |         +-- UnicodeDecodeError</span><br><span class="line">      |         +-- UnicodeEncodeError</span><br><span class="line">      |         +-- UnicodeTranslateError</span><br><span class="line">      +-- Warning</span><br><span class="line">           +-- DeprecationWarning</span><br><span class="line">           +-- PendingDeprecationWarning</span><br><span class="line">           +-- RuntimeWarning</span><br><span class="line">           +-- SyntaxWarning</span><br><span class="line">           +-- UserWarning</span><br><span class="line">           +-- FutureWarning</span><br><span class="line">           +-- ImportWarning</span><br><span class="line">           +-- UnicodeWarning</span><br><span class="line">           +-- BytesWarning</span><br><span class="line">           +-- ResourceWarning</span><br></pre></td></tr></table></figure>
<h2 id="å…·ä½“ç”¨æ³•">å…·ä½“ç”¨æ³•</h2>
<p>å…¸å‹çš„å¼‚å¸¸å¤„ç†ç»“æ„</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">  (your code)</span><br><span class="line"><span class="keyword">except</span> YourException <span class="keyword">as</span> e:</span><br><span class="line">  (your code)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">  (your code)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">  (your code)</span><br></pre></td></tr></table></figure>
<ul>
<li>finally è¯­å¥ æ— è®ºæ˜¯å¦æœ‰å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œï¼Œå¦å¤–å¦‚æœfinallyä¸­æœ‰returnè¯­å¥ï¼Œé‚£ä¹ˆå§‹ç»ˆè¿”å›finallyä¸­çš„returnè¯­å¥</li>
<li>else  è¯­å¥åœ¨æ²¡æœ‰å¼‚å¸¸æ—¶æ‰§è¡Œ</li>
<li>except å¯ä»¥åŒæ—¶å¡«å†™å¤šä¸ªException</li>
</ul>
<h3 id="å¤„ç†å¤šä¸ªå¼‚å¸¸">å¤„ç†å¤šä¸ªå¼‚å¸¸</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pow</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(n1, n2)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> pow(n1, n2) / n2</span><br><span class="line">    <span class="keyword">except</span> (TypeError,ZeroDivisionError) <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line"></span><br><span class="line">&gt; test(<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="number">1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•è·åˆ° ZeroDivisionError</span></span><br><span class="line">&gt; test(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">float division by zero</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•è·åˆ°TypeError</span></span><br><span class="line">&gt; test(<span class="string">'0'</span>, <span class="number">0</span>)</span><br><span class="line">must be real number, <span class="keyword">not</span> str</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ²¡æœ‰æ•è·åˆ°ï¼Œç¨‹åºå¼‚å¸¸è§¦å‘ValueError</span></span><br><span class="line">&gt; test(<span class="number">-1</span>, <span class="number">0.1</span>)</span><br><span class="line">ValueError: math domain error</span><br></pre></td></tr></table></figure>
<h3 id="æ•è·æ‰€æœ‰å¼‚å¸¸">æ•è·æ‰€æœ‰å¼‚å¸¸</h3>
<p>ä½¿ç”¨<code>except Exception as e:</code>æ¥æ•è·å…¶ä»–æ‰€æœ‰å¼‚å¸¸ï¼ˆæ³¨ï¼šè¿™ä¸ªå°†ä¼šæ•è·é™¤äº† <code>SystemExit</code> ã€ <code>KeyboardInterrupt</code> å’Œ <code>GeneratorExit</code> ä¹‹å¤–çš„æ‰€æœ‰å¼‚å¸¸ï¼‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pow</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(n1, n2)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> pow(n1, n2) / n2</span><br><span class="line">    <span class="keyword">except</span> (TypeError,ZeroDivisionError) <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">      	print(<span class="string">'Exception: '</span>, e)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># å¦‚æœä¸ç¡®å®šå¼‚å¸¸ç±»å‹ï¼Œå¯ä»¥å†™Exceptionï¼Œæ•è·é€šç”¨Exception   </span></span><br><span class="line">&gt; test(<span class="number">-1</span>, <span class="number">0.1</span>)</span><br><span class="line">Exception:  math domain error</span><br></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸">åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸</h3>
<p>è‡ªå®šä¹‰å¼‚å¸¸ï¼Œç»§æ‰¿äº<code>Exception</code> æˆ–è€…å…¶ä»–ä»»ä½•ä¸€ä¸ªå·²å­˜åœ¨çš„å¼‚å¸¸ç±»å‹ï¼Œå‡å¦‚åœ¨å¤„ç†æµï¼Œéœ€è¦æ¶‰åŠåˆ°ç½‘ç»œæµã€æ–‡ä»¶æµã€å†…å­˜æµï¼Œé‚£ä¹ˆå¯ä»¥æ¶‰åŠåˆ°å¦‚ä¸‹å¼‚å¸¸</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StreamError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NetWorkStreamError</span><span class="params">(StreamError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileStreamError</span><span class="params">(StreamError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MemoryStreamError</span><span class="params">(StreamError)</span>:</span></span><br><span class="line">  <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦ç”¨åˆ°æ—¶ï¼Œå¯ä»¥æŒ‰ç…§Exceptionæ–¹å¼ï¼Œä¼ é€’å‚æ•°å³å¯ï¼ŒExceptionå°†æ‰€æœ‰ä¼ é€’çš„å‚æ•°ä»¥å…ƒç»„çš„å½¢å¼ï¼Œå­˜åœ¨<code>args</code>é‡Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">'name error'</span>, <span class="string">'IO error'</span>, <span class="string">'EOF error'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e.args)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">(<span class="string">'name error'</span>, <span class="string">'IO error'</span>, <span class="string">'EOF error'</span>)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦é‡å†™<code>__init__()</code>æ–¹æ³•ï¼Œéœ€è¦ç¡®ä¿æ‰€æœ‰å‚æ•°éƒ½ç»™èµ‹å€¼åˆ°çˆ¶ç±»<code>Exception.__init__()</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomError</span><span class="params">(Exception)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, message, status)</span>:</span></span><br><span class="line">    super().__init__(message, status)</span><br><span class="line">    self.msg = message</span><br><span class="line">    self.sta = status</span><br></pre></td></tr></table></figure>
<h3 id="æ•è·å¼‚å¸¸åæŠ›å‡ºå¦å¤–å¼‚å¸¸">æ•è·å¼‚å¸¸åæŠ›å‡ºå¦å¤–å¼‚å¸¸</h3>
<p>ä½¿ç”¨<code>raise Error from e</code>æ¥å½¢æˆå¼‚å¸¸é“¾ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä¿¡æ¯ï¼š</p>
<p>The above exception was the direct cause of the following exception</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">'EOF'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'need str'</span>) <span class="keyword">from</span> e</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-80-e2122a02c1f3&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      1 try:</span><br><span class="line">----&gt; 2     raise ValueError(<span class="string">'EOF'</span>)</span><br><span class="line">      3 except Exception as e:</span><br><span class="line"></span><br><span class="line">ValueError: EOF</span><br><span class="line"></span><br><span class="line">The above exception was the direct cause of the following exception:</span><br><span class="line"></span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-80-e2122a02c1f3&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      2     raise ValueError(<span class="string">'EOF'</span>)</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">----&gt; 4     raise TypeError(<span class="string">'need str'</span>) from e</span><br><span class="line">      5     <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">TypeError: need str</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ²¡æœ‰ä½¿ç”¨<code>from e</code>ï¼Œè®¤ä¸ºåŒæ—¶å‘ç”Ÿäº†ä¸¤ä¸ªException</p>
<p>During handling of the above exception, another exception occurred</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">     x = <span class="number">3</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'need str'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ZeroDivisionError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-93-7ae0db540006&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      1 try:</span><br><span class="line">----&gt; 2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line"></span><br><span class="line">ZeroDivisionError: division by zero</span><br><span class="line"></span><br><span class="line">During handling of the above exception, another exception occurred:</span><br><span class="line"></span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-93-7ae0db540006&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">----&gt; 4     raise TypeError(<span class="string">'need str'</span>)</span><br><span class="line"></span><br><span class="line">TypeError: need str</span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¦å¿½ç•¥æ‰å¼‚å¸¸é“¾ï¼Œå¯ä»¥ä½¿ç”¨<code>raise from None</code>, åªæœ€åçš„å¼‚å¸¸æŠ›å‡º</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">     x = <span class="number">3</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">'need str'</span>) <span class="keyword">from</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-94-3858a6e7a744&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">----&gt; 4     raise TypeError(<span class="string">'need str'</span>) from None</span><br><span class="line"></span><br><span class="line">TypeError: need str</span><br></pre></td></tr></table></figure>
<h3 id="é‡æ–°æŠ›å‡ºè¢«æ•è·çš„å¼‚å¸¸">é‡æ–°æŠ›å‡ºè¢«æ•è·çš„å¼‚å¸¸</h3>
<p>å¦‚æœæƒ³å°†å¼‚å¸¸é‡æ–°è¢«ä¸Šä¸€çº§æ•è·ï¼Œå¯ä»¥åœ¨exceptä¸­å•ç‹¬åŠ ä¸€ä¸ª<code>raise</code>è¯­å¥ï¼Œè¿™æ ·å¯ä»¥åœ¨å¼‚å¸¸ä¸­è®°å½•æ—¥å¿—ç­‰æ“ä½œåå°†å¼‚å¸¸ä¼ æ’­å‡ºå»</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">     x = <span class="number">3</span> / <span class="number">0</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="comment"># other code</span></span><br><span class="line">    <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ZeroDivisionError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-95-1519a0755ccc&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      1 try:</span><br><span class="line">----&gt; 2      x = 3 / 0</span><br><span class="line">      3 except Exception as e:</span><br><span class="line">      4     raise</span><br><span class="line"></span><br><span class="line">ZeroDivisionError: division by zero</span><br></pre></td></tr></table></figure>
<h2 id="æ€§èƒ½">æ€§èƒ½</h2>
<p>å¼•å…¥å¼‚å¸¸å¤„ç†ï¼Œä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½æŸè€—ï¼Œå¯¹äºå¯¹æ€§èƒ½æœ‰è¦æ±‚çš„ç¨‹åºï¼Œåº”è¯¥å¯¹å¯é¢„æµ‹çš„ç»“æœåšé€»è¾‘å¤„ç†ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ç”¨å¼‚å¸¸å¤„ç†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timer</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">       st = time.perf_counter()</span><br><span class="line">       func(*args, **kwargs)</span><br><span class="line">       end = time.perf_counter()</span><br><span class="line">       print(<span class="string">f'using <span class="subst">&#123;end - st&#125;</span>s'</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">div1</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span> / num</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">   </span><br><span class="line"><span class="meta">@timer</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">div2</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span> / num</span><br><span class="line">      </span><br><span class="line">&gt; div1(<span class="number">0</span>)</span><br><span class="line">using <span class="number">4.4405460357666016e-06</span>s</span><br><span class="line"></span><br><span class="line">&gt; div2(<span class="number">0</span>)</span><br><span class="line">using <span class="number">1.341104507446289e-06</span>s</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿè®¸ä¼šæœ‰äººè¯´ï¼Œæ—¢ç„¶ç”¨pythonäº†ï¼Œè¿˜åœ¨ä¹é‚£ç‚¹æ€§èƒ½ï¼Œæˆ‘æƒ³è¯´pythonæ€§èƒ½è°ƒä¼˜ä¹Ÿæ˜¯ä¸€ç§è¿½æ±‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://docs.python.org/zh-cn/3/library/exceptions.html#bltin-exceptions" target="_blank" rel="noopener">pythonå†…ç½®å¼‚å¸¸</a></p>
<p>[2] <a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/" target="_blank" rel="noopener">python cookbook</a></p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>exception</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonåŸºç¡€ç¯‡--function</title>
    <url>/posts/2f69/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>function</tag>
      </tags>
  </entry>
  <entry>
    <title>python web -- pydanticåŸºç¡€ç”¨æ³•-1</title>
    <url>/posts/e075/</url>
    <content><![CDATA[<blockquote>
<p>ä½¿ç”¨pydanticæ ¡éªŒè¾“å…¥å‚æ•°ï¼Œå¯ä»¥çœå»åç»­å‡½æ•°ä½“å†…çš„æ ¡éªŒï¼Œå¹¶å¯ä»¥ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ ¡éªŒå™¨æ–¹ä¾¿å…¶ä»–æ–¹æ³•è°ƒç”¨ï¼Œåšçš„å…¥å‚æ ¡éªŒä¸å…¥å‚è°ƒç”¨çš„è§£è€¦</p>
<p>è‘—åçš„FastAPIæ¡†æ¶ï¼Œä¹Ÿæ˜¯ä½¿ç”¨çš„pydanticä½œä¸ºhttpè¯·æ±‚ä¸­å‚æ•°çš„æ ¡éªŒ</p>
</blockquote>
<h3 id="å®‰è£…">å®‰è£…</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># need python3.6+</span></span><br><span class="line">pip install pydantic -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬æ¨¡å‹ç”¨æ³•">åŸºæœ¬æ¨¡å‹ç”¨æ³•</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># model.py</span></span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, validator</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ¨¡å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionRequest</span><span class="params">(BaseModel)</span>:</span></span><br><span class="line">    bearer_token: str = <span class="literal">None</span></span><br><span class="line">    validDateTime: str = <span class="literal">None</span></span><br><span class="line">    validPeriodTime: int = <span class="number">12</span></span><br><span class="line">    count: int = <span class="number">200</span></span><br><span class="line">    deviceTypeId: int = <span class="number">2</span></span><br><span class="line">    subscriptionLevelId: int = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å¾—jsonæ ¼å¼å†…å®¹ï¼Œä¸è¿”è¿˜bearer_token</span></span><br><span class="line">    <span class="comment"># def data_json(self):</span></span><br><span class="line">    <span class="comment">#    return self.json(exclude=&#123;'bearer_token'&#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ¡éªŒå‚æ•°</span></span><br><span class="line">    <span class="comment"># @validator('validDateTime')</span></span><br><span class="line">    <span class="comment"># def create_default_date(cls, v):</span></span><br><span class="line">    <span class="comment">#    if v is None:</span></span><br><span class="line">    <span class="comment">#        v = get_default_valid_datetime().strftime("%Y-%m-%dT23:59:59.000Z")</span></span><br><span class="line">    <span class="comment">#    return v</span></span><br></pre></td></tr></table></figure>
<p>å› ä¸ºç»™æ¨¡å‹ä¸­æ¯ä¸ªå­—æ®µéƒ½è®¾ç½®äº†é»˜è®¤å€¼ï¼Œåœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°æ—¶ä¹Ÿä¸ä¼šæŠ¥é”™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt; <span class="keyword">from</span> model <span class="keyword">import</span> SubscriptionRequest</span><br><span class="line">&gt;&gt; m = SubscriptionRequest()</span><br><span class="line">&gt;&gt; print(m)</span><br><span class="line">bearer_token=<span class="literal">None</span> validDateTime=<span class="literal">None</span> validPeriodTime=<span class="number">12</span> count=<span class="number">200</span> deviceTypeId=<span class="number">2</span> subscriptionLevelId=<span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å°†æ¨¡å‹æ–‡ä»¶ä¸­ä¸€äº›å‚æ•°é»˜è®¤å€¼å»æ‰</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># model.py</span></span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, validator</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ¨¡å‹</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionRequest</span><span class="params">(BaseModel)</span>:</span></span><br><span class="line">    bearer_token: str</span><br><span class="line">    validDateTime: str</span><br><span class="line">    validPeriodTime: int = <span class="number">12</span></span><br><span class="line">    count: int = <span class="number">200</span></span><br><span class="line">    deviceTypeId: int = <span class="number">2</span></span><br><span class="line">    subscriptionLevelId: int = <span class="number">2</span></span><br><span class="line">		...</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­æ‰§è¡Œï¼Œå°†ä¼šæç¤ºå‚æ•°ç¼ºå¤±</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt; <span class="keyword">from</span> model <span class="keyword">import</span> SubscriptionRequest</span><br><span class="line">&gt;&gt; m = SubscriptionRequest()</span><br><span class="line">&gt;&gt; print(m)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"/Users/simple/workspace/Columbus/admin_tools/serializer.py"</span>, line <span class="number">60</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    m = SubscriptionRequest()</span><br><span class="line">  File <span class="string">"pydantic/main.py"</span>, line <span class="number">391</span>, <span class="keyword">in</span> pydantic.main.BaseModel.__init__</span><br><span class="line">pydantic.error_wrappers.ValidationError: <span class="number">2</span> validation errors <span class="keyword">for</span> SubscriptionRequest</span><br><span class="line">bearer_token</span><br><span class="line">  field required (type=value_error.missing)</span><br><span class="line">validDateTime</span><br><span class="line">  field required (type=value_error.missing)</span><br></pre></td></tr></table></figure>
<p>æ­£å¸¸ç”¨æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt; data= &#123;</span><br><span class="line"><span class="meta">... </span>       <span class="string">'bearer_token'</span>: <span class="string">'1234567=='</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'validDateTime'</span>: <span class="literal">None</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'validPeriodTime'</span>: <span class="number">12</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'count'</span>: <span class="number">12</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'deviceTypeId'</span>: <span class="number">2</span>,</span><br><span class="line"><span class="meta">... </span>       <span class="string">'subscriptionLevelId'</span>: <span class="number">2</span></span><br><span class="line"><span class="meta">... </span>   &#125;</span><br><span class="line">&gt;&gt; m = SubscriptionRequest(**data)</span><br><span class="line">&gt;&gt; print(m)</span><br><span class="line">bearer_token=<span class="string">'1234567=='</span> validDateTime=<span class="string">'2022-09-01T23:59:59.000Z'</span> validPeriodTime=<span class="number">12</span> count=<span class="number">12</span> deviceTypeId=<span class="number">2</span> subscriptionLevelId=<span class="number">2</span></span><br><span class="line"><span class="comment"># è¾“å‡ºjsonæ ¼å¼</span></span><br><span class="line">&gt;&gt; m.json()</span><br><span class="line">&#123;<span class="string">"bearer_token"</span>: <span class="string">"1234567=="</span>, <span class="string">"validDateTime"</span>: <span class="string">"2022-09-01T23:59:59.000Z"</span>, <span class="string">"validPeriodTime"</span>: <span class="number">12</span>, <span class="string">"count"</span>: <span class="number">12</span>, <span class="string">"deviceTypeId"</span>: <span class="number">2</span>, <span class="string">"subscriptionLevelId"</span>: <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢è¿”å›jsonç»“æœä¸­ï¼Œé™¤äº†bearer_tokenï¼Œå…¶ä»–éƒ½æ˜¯è¦èµ‹å€¼ç»™body jsonï¼Œå› æ­¤æƒ³åœ¨jsonè¾“å‡ºä¸­å»é™¤</p>
<p><code>bearer_token</code></p>
<p>åœ¨æ¨¡å‹ç±»ä¸­å¢åŠ å¦‚ä¸‹æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">è·å¾—jsonæ ¼å¼å†…å®¹ï¼Œä¸è¿”è¿˜bearer_token</span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">data_json</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.json(exclude=&#123;<span class="string">'bearer_token'</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>åŒæ ·å¦‚æœæƒ³å¯¹è¾“å…¥çš„å‚æ•°åšå…·ä½“æ ¡éªŒï¼ŒvalidDateTimeå¦‚æœä¸ºNoneï¼Œå°±ä¸ºå®ƒèµ‹å€¼ä¸€ä¸ªæ—¶é—´æˆ³</p>
<p>åœ¨æ¨¡å‹ç±»ä¸­å¢åŠ ä¸€ä¸ªvalidator</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#æ ¡éªŒå‚æ•°</span></span><br><span class="line"><span class="meta">     @validator('validDateTime')</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">create_default_date</span><span class="params">(cls, v)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            v = get_default_valid_datetime().strftime(<span class="string">"%Y-%m-%dT23:59:59.000Z"</span>)</span><br><span class="line">        <span class="keyword">return</span> v</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_default_valid_datetime</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    é»˜è®¤æœ‰æ•ˆæœŸæ—¶é—´ä¸ºå½“å‰æ—¶é—´+1å¹´åŠ</span></span><br><span class="line"><span class="string">    :return: æ—¶é—´æˆ³å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    diff = <span class="number">365</span> + int(<span class="number">365</span>/<span class="number">2</span>)</span><br><span class="line">    valid_datetime = datetime.utcnow() + timedelta(days=diff)</span><br><span class="line">    <span class="comment"># return valid_datetime.strftime("%Y-%m-%dT23:59:59.000Z")</span></span><br><span class="line">    <span class="keyword">return</span> valid_datetime</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯validatorè£…é¥°çš„ä¸ºç±»å‡½æ•°ï¼Œå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºclsï¼Œä¸æ˜¯selfï¼Œå¦å¤–è¿™ä¸ªå‡½æ•°è¿˜æœ‰å…¶ä»–å‚æ•°</p>
<ul>
<li>
<p>v ä¸ºå½“å‰å‚æ•°çš„å€¼</p>
</li>
<li>
<p>valuesä¸ºå½“å‰ä¼ é€’åˆ°æ¨¡å‹æ‰€æœ‰å‚æ•°çš„å­—å…¸é›†åˆï¼Œæ¯”å¦‚é€šè¿‡values[â€˜countâ€™] æ¥è·å–countçš„å€¼</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@validator('validDateTime')</span></span><br><span class="line">     <span class="function"><span class="keyword">def</span> <span class="title">create_default_date</span><span class="params">(cls, v, values, **kwargs)</span>:</span></span><br><span class="line">    		<span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p><strong>å¦å¤–å¦‚æœæ ¡éªŒçš„å‚æ•°æ²¡æœ‰ä¼ é€’ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªé»˜è®¤å€¼ï¼Œä¸ä¼šè°ƒç”¨æ ¡éªŒæ–¹æ³•</strong></p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<p>[1] <a href="https://pydantic-docs.helpmanual.io/usage/validators/" target="_blank" rel="noopener">pydantic validators</a></p>
<p>[2] <a href="https://pydantic-docs.helpmanual.io/usage/exporting_models/#json_encoders" target="_blank" rel="noopener">export json</a></p>
<p>[3] <a href="https://pydantic-docs.helpmanual.io/install/" target="_blank" rel="noopener">install</a></p>
<p>[4] <a href="https://pydantic-docs.helpmanual.io/usage/models/" target="_blank" rel="noopener">basic models</a></p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>pydantic</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonåŸºç¡€ -- timeä¸datetimeå¸¸è§ç”¨æ³•</title>
    <url>/posts/3a95/</url>
    <content><![CDATA[<p>åœ¨HTTP APIæ¥å£ï¼Œä»¥åŠè·Ÿæ•°æ®åº“äº¤äº’æ—¶ç»å¸¸ç”¨åˆ°æ—¶é—´æˆ³ï¼ˆæ—¶é—´ï¼‰ï¼Œè¿™é‡Œæ•´ç†pythonä¸­å¸¸è§çš„timeã€datetimeç”¨æ³•ï¼Œä»¥åŠä¹‹é—´çš„ç›¸äº’è½¬åŒ–æ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timezone</span><br></pre></td></tr></table></figure>
<h2 id="timeåŸºæœ¬ç”¨æ³•">timeåŸºæœ¬ç”¨æ³•</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰unixæ—¶é—´æˆ³ï¼Œè¿”å›å€¼ä¸ºfloat</span></span><br><span class="line">&gt; time.time()</span><br><span class="line"><span class="number">1615178606.6729627</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æœ¬åœ°æ—¶é—´ï¼ˆstruct timeï¼‰</span></span><br><span class="line">&gt; time.localtime()</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">8</span>, tm_hour=<span class="number">12</span>, tm_min=<span class="number">47</span>, tm_sec=<span class="number">12</span>, tm_wday=<span class="number">0</span>, tm_yday=<span class="number">67</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–UTCæ—¶é—´ï¼ˆstruct timeï¼‰</span></span><br><span class="line">&gt; time.gmtime()</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">8</span>, tm_hour=<span class="number">4</span>, tm_min=<span class="number">47</span>, tm_sec=<span class="number">25</span>, tm_wday=<span class="number">0</span>, tm_yday=<span class="number">67</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æ¯«ç§’çº§Unix æ—¶é—´æˆ³ int</span></span><br><span class="line">&gt; int(time.time()*<span class="number">1000</span>)</span><br><span class="line"><span class="number">1615178896227</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–ç§’çº§Unix æ—¶é—´æˆ³ int</span></span><br><span class="line">&gt; int(time.time())</span><br><span class="line"><span class="number">1615178924</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Unix æ—¶é—´æˆ³ï¼ˆint/floatï¼‰è½¬åŒ–ä¸º struct time</span></span><br><span class="line">&gt; time.localtime(time.time())</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">21</span>, tm_min=<span class="number">44</span>, tm_sec=<span class="number">6</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># strcut time è½¬åŒ–ä¸º Unixæ—¶é—´æˆ³ï¼ˆfloatï¼‰</span></span><br><span class="line"><span class="comment"># ä¸»è¦mktimeçš„å‚æ•°åº”è¯¥æ˜¯localtimeï¼Œä¸èƒ½æ˜¯UTCtime</span></span><br><span class="line">&gt; time.mktime(time.localtime())</span><br><span class="line"><span class="number">1616680137.0</span></span><br></pre></td></tr></table></figure>
<h2 id="datetimeåŸºæœ¬ç”¨æ³•">datetimeåŸºæœ¬ç”¨æ³•</h2>
<ul>
<li>datetime(year, month, day[, hour[, minute[, second[, microsecond[,tzinfo]]]]])</li>
</ul>
<p><em>æ³¨æ„ï¼šç§’åé¢æ˜¯å¾®ç§’ï¼Œä¸æ˜¯æ¯«ç§’</em></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰æ—¶åˆ»çš„datetime</span></span><br><span class="line">&gt; datetime.now()</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">21</span>, <span class="number">59</span>, <span class="number">29</span>, <span class="number">534163</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰æ—¶åˆ»çš„UTC datetime</span></span><br><span class="line">&gt; datetime.utcnow()</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">803165</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å½“å‰æ—¶åˆ»çš„Unix æ—¶é—´æˆ³, å‚æ•°ä¸º datetime</span></span><br><span class="line">&gt; datatime.timestamp(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">803165</span>))</span><br><span class="line"><span class="number">1616651979.803165</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°datetime,replace(year, month, day, hour, minute, second, microsecond...)</span></span><br><span class="line">&gt; datetime.now().replace(year=<span class="number">2022</span>)</span><br><span class="line">datetime.datetime(<span class="number">2022</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">21</span>, <span class="number">59</span>, <span class="number">29</span>, <span class="number">534163</span>)</span><br></pre></td></tr></table></figure>
<h3 id="iosformatç”¨æ³•">iosformatç”¨æ³•</h3>
<ul>
<li>isoformat(sep=â€˜Tâ€™, timespec=â€˜autoâ€™)</li>
</ul>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå¾®ç§’å­˜åœ¨ï¼Œåˆ™è¾“å‡ºå¾®ç§’ï¼Œå¦‚æœå¾®ç§’ä¸º0ï¼Œåˆ™å¾®ç§’ä¼šè¢«å¿½ç•¥ï¼Œè€Œä¸æ˜¯è¾“å‡º0</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¸ä¿®æ”¹é»˜è®¤å‚æ•°æ—¶ï¼Œè¿”å›æ ¼å¼åŒ–å­—ç¬¦ä¸²</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">803165</span>))</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.803165'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”¯æŒä¸¤ä¸ªå‚æ•°ï¼Œsepï¼Œ timespec</span></span><br><span class="line"><span class="comment"># sep é»˜è®¤ä¸º'T'ï¼Œå³ç”¨Tåšåˆ†éš”ç¬¦</span></span><br><span class="line"><span class="comment"># timespecé»˜è®¤ä¸º'auto', å¯ä»¥ä¸º'hours', 'seconds', 'milliseconds', 'microseconds'</span></span><br><span class="line"><span class="comment"># è¾“å‡ºå¸¦å¾®ç§’</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1</span>))</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000001'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¾®ç§’è¢«å¿½ç•¥</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">0</span>))</span><br><span class="line"><span class="string">'2021-03-25T13:59:39'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœtimespecä¸ºmillisecondsï¼Œå°äº1msä¼šè¾“å‡º000</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">2</span>), timespec=<span class="string">'milliseconds'</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰äº0æ—¶ï¼Œä¹Ÿä¼šè¾“å‡º000</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>), timespec=<span class="string">'milliseconds'</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ç©ºæ ¼ä½œä¸ºåˆ†éš”ç¬¦</span></span><br><span class="line">&gt; datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>), timespec=<span class="string">'milliseconds'</span>, sep=<span class="string">' '</span>)</span><br><span class="line"><span class="string">'2021-03-25 13:59:39.001'</span></span><br></pre></td></tr></table></figure>
<h3 id="timedelta">timedelta</h3>
<ul>
<li>datetime.timedelta(days, seconds, microseconds, minutes, hours, weeks)</li>
</ul>
<p>ä¸¤ä¸ªdatetimeç›´æ¥çš„æ—¶é—´é—´éš”</p>
<blockquote>
<p>åªæœ‰ <em>days</em>,<em>seconds</em> å’Œ <em>microseconds</em> ä¼šå­˜å‚¨åœ¨å†…éƒ¨ï¼Œå³pythonå†…éƒ¨ä»¥ <em>days</em>,<em>seconds</em> å’Œ <em>microseconds</em> ä¸‰ä¸ªå•ä½ä½œä¸ºå­˜å‚¨çš„åŸºæœ¬å•ä½ã€‚å‚æ•°å•ä½è½¬æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li>1æ¯«ç§’ä¼šè½¬æ¢æˆ1000å¾®ç§’ã€‚</li>
<li>1åˆ†é’Ÿä¼šè½¬æ¢æˆ60ç§’ã€‚</li>
<li>1å°æ—¶ä¼šè½¬æ¢æˆ3600ç§’ã€‚</li>
<li>1æ˜ŸæœŸä¼šè½¬æ¢æˆ7å¤©ã€‚</li>
</ul>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ¯”å½“å‰æ—¶åˆ»å°‘1å¤©5åˆ†é’Ÿ</span></span><br><span class="line">&gt; datetime.now() + timedelta(days=<span class="number">-1</span>, minutes=<span class="number">-5</span>)</span><br><span class="line">&gt; datetime.now() - timedelta(days=<span class="number">1</span>, minutes=<span class="number">5</span>)</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">41</span>, <span class="number">10</span>, <span class="number">557550</span>)</span><br></pre></td></tr></table></figure>
<h3 id="timezone-astimezone">timezone/astimezone</h3>
<p>å°†UTCæ—¶é—´è½¬åŒ–ä¸ºæœ¬åœ°æ—¶é—´</p>
<blockquote>
<p>å‡å¦‚æ•°æ®åº“å­˜å‚¨çš„æ—¶é—´æˆ³éƒ½æ˜¯UTCæ—¶é—´ï¼Œå¦‚æœå®¢æˆ·ç«¯è·å–åˆ°åï¼Œè½¬åŒ–ä¸ºæœ¬åœ°æ—¶é—´ï¼Œå¯ä»¥å€ŸåŠ©timezoneå’Œastimezone</p>
<p>ç®€å•å¯ä»¥ä½¿ç”¨timedelta(hours=Â±8)è¿›è¡ŒåŒ—äº¬æ—¶é—´å’ŒUTCæ—¶é—´è½¬æ¢</p>
</blockquote>
<p>å…·ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–ä¸€ä¸ªUTCæ—¶é—´</span></span><br><span class="line">&gt; date = datetime.utcnow()</span><br><span class="line">&gt; date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">240199</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœ‰è¶£çš„æ—¶ï¼Œå¦‚æœæ­¤æ—¶è·å–tzinfoï¼Œä¸æ˜¯utcï¼Œè€Œæ˜¯None</span></span><br><span class="line">&gt; date.tzinfo</span><br><span class="line"><span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å› æ­¤å…ˆç»™å®ƒèµ‹å€¼ä¸€ä¸ªUTC timezone</span></span><br><span class="line">&gt; new = date.replace(tzinfo=timezone.utc)</span><br><span class="line">&gt; new</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">7</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">240199</span>, tzinfo=datetime.timezone.utc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># astimezone æ¥å—ä¸€ä¸ªtzå‚æ•°ï¼Œé»˜è®¤ä¸ºNoneï¼Œä¸ºNoneæ—¶ï¼Œè½¬åŒ–ä¸ºæœ¬åœ°æ—¶é—´</span></span><br><span class="line"><span class="comment"># 28800 = 8h * 3600</span></span><br><span class="line">&gt; new.astimezone()</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">15</span>, <span class="number">22</span>, <span class="number">21</span>, <span class="number">240199</span>, tzinfo=datetime.timezone(datetime.timedelta(seconds=<span class="number">28800</span>), <span class="string">'CST'</span>))</span><br></pre></td></tr></table></figure>
<p>æœ¬åœ°æ—¶é—´è½¬åŒ–ä¸ºutcæ—¶é—´</p>
<blockquote>
<p>å†™å…¥åˆ°æ•°æ®åº“æ—¶ï¼Œéœ€è¦å°†å®é™…è½¬åŒ–ä¸ºUTCæ—¶é—´</p>
<p>æ–¹æ³•ä¸€ï¼šé€šè¿‡astimezoneè½¬æ¢ï¼Œ<a href="http://%E6%AD%A4%E6%97%B6tz=timezone.info" target="_blank" rel="noopener">æ­¤æ—¶tz=timezone.info</a></p>
<p>æ–¹æ³•äºŒï¼šå€ŸåŠ©äºfromtimestamp/utcfromtimestampè½¬æ¢</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–ä¸€ä¸ªæœ¬åœ°æ—¶é—´</span></span><br><span class="line">&gt; localdate = datetime.now()</span><br><span class="line">&gt; localdate</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•1ï¼Œç»™datetimeåŠ ä¸Šæ—¶åŒºä¿¡æ¯ï¼Œç„¶åé€šè¿‡astimezoneè½¬æ¢</span></span><br><span class="line">&gt; new_localdate = localdate.replace(tzinfo=timezone(timedelta(seconds=<span class="number">28800</span>)))</span><br><span class="line">&gt; new_localdate</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">16</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>, tzinfo=datetime.timezone(datetime.timedelta(seconds=<span class="number">28800</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬åŒ–æ—¶åŒº</span></span><br><span class="line">&gt; utc_date = new_localdate.astimezone(tz=timezone.utc)</span><br><span class="line">&gt; utc_date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>, tzinfo=datetime.timezone.utc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•2ï¼Œå€ŸåŠ©äºtimestampè½¬æ¢</span></span><br><span class="line">&gt; timestamp = localdate.timestamp()</span><br><span class="line">&gt; utc_date = datetime.utcfromtimestamp(timestamp)</span><br><span class="line">&gt; utc_date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>)</span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨fromtimestamp åŠ ä¸Šæ—¶åŒºå‚æ•°</span></span><br><span class="line">&gt; utc_date = datetime.fromtimestamp(timestamp, tz=timezone.utc)</span><br><span class="line">&gt; utc_date</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">29</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">33</span>, <span class="number">974434</span>, tzinfo=datetime.timezone.utc)</span><br></pre></td></tr></table></figure>
<h2 id="strä¸datetimeäº’è½¬">strä¸datetimeäº’è½¬</h2>
<ul>
<li>
<p>datetime.strptime(string, format) å°†å­—ç¬¦ä¸²æ—¶é—´è½¬ä¸ºdatetime</p>
</li>
<li>
<p>datetime.strftime(format) å°†datetimeè½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ—¶é—´</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># str --&gt; datetime</span></span><br><span class="line"><span class="comment"># '2021-03-25T13:59:39.001'</span></span><br><span class="line">&gt; datetime_str = datetime.isoformat(datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>), timespec=<span class="string">'milliseconds'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># %f ç”¨äºæ ¼å¼åŒ–å¾®ç§’</span></span><br><span class="line">&gt; datetime.strptime(datetime_str, <span class="string">"%Y-%m-%dT%H:%M:%S.%f"</span>)</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># datetime --&gt; str</span></span><br><span class="line"><span class="comment"># æ¨èç¬¬ä¸€ç§ç”¨ä¸Šé¢æåˆ°çš„isoformat</span></span><br><span class="line"><span class="comment"># ç¬¬äºŒç§ä½¿ç”¨strftime</span></span><br><span class="line">&gt; datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>).strftime(format=<span class="string">"%Y-%m-%dT%H:%M:%S.%f"</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.001000'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†å¾®ç§’è¾“å‡ºä¸º000</span></span><br><span class="line">&gt; datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">13</span>, <span class="number">59</span>, <span class="number">39</span>, <span class="number">1000</span>).strftime(format=<span class="string">"%Y-%m-%dT%H:%M:%S.000"</span>)</span><br><span class="line"><span class="string">'2021-03-25T13:59:39.000'</span></span><br></pre></td></tr></table></figure>
<h2 id="strä¸timeäº’è½¬">strä¸timeäº’è½¬</h2>
<ul>
<li>
<p>time.strftime(format[,t]) å°†timeæ¢ä½ä¸ºå­—ç¬¦ä¸²æ—¶é—´ï¼Œå¦‚æœt(time)æœªæä¾›ï¼Œåˆ™ä½¿ç”¨locatime()è·å–å½“å‰æ—¶é—´</p>
</li>
<li>
<p>time.strptime(string[,format]) å°†å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢ä¸º struct time</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># local time</span></span><br><span class="line"><span class="comment"># time.struct_time(tm_year=2021, tm_mon=3, tm_mday=25, tm_hour=23, tm_min=12, tm_sec=10, tm_wday=3, tm_yday=84, tm_isdst=0)</span></span><br><span class="line">&gt; now = time.localtime()</span><br><span class="line"></span><br><span class="line"><span class="comment"># time --&gt; str</span></span><br><span class="line"><span class="comment"># è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ—¶é—´, ä¸æ”¯æŒå¾®ç§’</span></span><br><span class="line">&gt; time.strftime( <span class="string">"%Y-%m-%dT%H:%M:%S"</span>, now)</span><br><span class="line"><span class="string">'2021-03-25T23:12:10'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># str --&gt; time</span></span><br><span class="line"><span class="comment"># å°†å­—ç¬¦ä¸²æ—¶é—´è½¬æ¢ä¸º struct time</span></span><br><span class="line">&gt; time.strptime(time.strftime( <span class="string">"%Y-%m-%dT%H:%M:%S"</span>, now), <span class="string">"%Y-%m-%dT%H:%M:%S"</span>)</span><br><span class="line"></span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">23</span>, tm_min=<span class="number">12</span>, tm_sec=<span class="number">10</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">-1</span>)</span><br></pre></td></tr></table></figure>
<h2 id="timeä¸datetimeäº’è½¬">timeä¸datetimeäº’è½¬</h2>
<ul>
<li>
<p>datetime.timetuple(datetime) å°†datetimeè½¬åŒ–ä¸º struct time</p>
</li>
<li>
<p>datetime.fromtimestamp(unixæ—¶é—´æˆ³) å°†unixæ—¶é—´æˆ³è½¬åŒ–ä¸ºdatetime</p>
</li>
<li>
<p>datetime.timestamp() å°†datetimeè½¬åŒ–ä¸ºunix æ—¶é—´æˆ³</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># time --&gt; datetime</span></span><br><span class="line"><span class="comment"># ç¬¬ä¸€ç§ unix æ—¶é—´æˆ³ è½¬åŒ–ä¸º datetime</span></span><br><span class="line">&gt; datetime.fromtimestamp(time.time())</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">33</span>, <span class="number">548042</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒç§ struct timeè½¬åŒ–ä¸º datetime</span></span><br><span class="line">&gt; datetime.fromtimestamp(time.mktime(time.localtime()))</span><br><span class="line">datetime.datetime(<span class="number">2021</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="number">30</span>, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># datetime --&gt; time</span></span><br><span class="line"><span class="comment"># ç¬¬ä¸€ç§ä½¿ç”¨timetuple</span></span><br><span class="line">&gt; datetime.timetuple(datetime.now())</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">23</span>, tm_min=<span class="number">33</span>, tm_sec=<span class="number">9</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒç§ä½¿ç”¨Unixæ—¶é—´æˆ³</span></span><br><span class="line">&gt; time.localtime(datetime.timestamp(datetime.now()))</span><br><span class="line">time.struct_time(tm_year=<span class="number">2021</span>, tm_mon=<span class="number">3</span>, tm_mday=<span class="number">25</span>, tm_hour=<span class="number">23</span>, tm_min=<span class="number">34</span>, tm_sec=<span class="number">6</span>, tm_wday=<span class="number">3</span>, tm_yday=<span class="number">84</span>, tm_isdst=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h1>å‚è€ƒ</h1>
<p>[1] <a href="https://pythontic.com/datetime/datetime/isoformat" target="_blank" rel="noopener">Isoformat() Method Of Datetime Class In Python</a></p>
<p>[2] <a href="https://docs.python.org/zh-cn/3.7/library/datetime.html" target="_blank" rel="noopener">datetime â€” åŸºæœ¬çš„æ—¥æœŸå’Œæ—¶é—´ç±»å‹</a></p>
<p>[3] <a href="https://docs.python.org/zh-cn/3/library/time.html" target="_blank" rel="noopener">time â€” æ—¶é—´çš„è®¿é—®å’Œè½¬æ¢</a></p>
<p>[4] <a href="https://docs.python.org/zh-cn/3.7/library/datetime.html#strftime-and-strptime-behavior" target="_blank" rel="noopener">strftime() å’Œ strptime()çš„è¡Œä¸º</a></p>
<p>[5] <a href="https://stackoverflow.com/questions/4563272/convert-a-python-utc-datetime-to-a-local-datetime-using-only-python-standard-lib/13287083#13287083" target="_blank" rel="noopener">Convert a python UTC datetime to a local datetime</a></p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>virtualenvwrapperçš„å®‰è£…å’Œä½¿ç”¨</title>
    <url>/posts/9fc5/</url>
    <content><![CDATA[<blockquote>
<p>virtualenvwrapper æ˜¯pythonè™šæ‹Ÿè¿è¡Œç¯å¢ƒçš„ç®¡ç†å·¥å…·ï¼Œåœ¨å¤šä¸ªé¡¹ç›®æ—¶ï¼Œé˜²æ­¢åŒ…ç‰ˆæœ¬ä¸åŒé€ æˆå†²çªç­‰éº»çƒ¦<br>
ä¹Ÿå¯ä»¥åœ¨å…±äº«é¡¹ç›®æ—¶ï¼Œä¸å¼•å…¥ä¸å¿…è¦çš„pythonåŒ…<br>
â€‹</p>
</blockquote>
<h3 id="å®‰è£…">å®‰è£…</h3>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">python -m pip install virtualenvwrapper</span><br><span class="line"><span class="comment"># æ‰§è¡Œ</span></span><br><span class="line"><span class="built_in">source</span> /usr/<span class="built_in">local</span>/bin/virtualenvwrapper.sh</span><br><span class="line">â€‹</span><br></pre></td></tr></table></figure>
<h3 id="é…ç½®">é…ç½®</h3>
<p>å®‰è£…å®Œ virtualenvwrapperï¼Œé»˜è®¤æ²¡æœ‰ç”Ÿæ•ˆï¼Œéœ€è¦åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œ <code>source /usr/local/bin/virtualenvwrapper.sh</code> æ‰èƒ½ç”Ÿæ•ˆï¼Œè€Œä¸”æ¯æ¬¡è¿è¡Œå‰éƒ½éœ€è¦æ‰§è¡Œè¯¥å‘½ä»¤ï¼Œå› æ­¤éœ€è¦å°†å…¶é…ç½®åˆ° ç»ˆç«¯çš„.* shrc æ–‡ä»¶ä¸­</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®ç»ˆç«¯ç±»å‹ï¼Œä¿®æ”¹ å¯¹åº”çš„.zshrc .bashrcæ–‡ä»¶ï¼ŒåŠ å…¥ä¸‹é¢è¿™å¥è¯</span></span><br><span class="line"><span class="built_in">source</span> /usr/<span class="built_in">local</span>/bin/virtualenvwrapper.sh</span><br><span class="line"><span class="comment"># åº”ç”¨æ–°çš„é…ç½®æ–‡ä»¶ï¼Œä»¥zshrcä¸ºä¾‹</span></span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>â€‹</p>
<h3 id="ä½¿ç”¨">ä½¿ç”¨</h3>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç³»ç»Ÿè™šæ‹Ÿç¯å¢ƒåˆ—è¡¨</span></span><br><span class="line">lsvirtualenv</span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°çš„è™šæ‹Ÿç¯å¢ƒ, [name] ä¸ºè™šæ‹Ÿç¯å¢ƒåå­—</span></span><br><span class="line">mkvirtualenv [name]</span><br><span class="line"><span class="comment"># åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">rmvirtualenv [name]</span><br><span class="line"><span class="comment"># åº”ç”¨æŸä¸ªè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line">workon [name]</span><br></pre></td></tr></table></figure>
<p>â€‹</p>
<h3 id="å‚è€ƒ">å‚è€ƒ</h3>
<ol>
<li><a href="https://virtualenvwrapper.readthedocs.io/en/latest/install.html" target="_blank" rel="noopener">virtualenvwrapper.readthedocs.io</a><br>
â€‹</li>
</ol>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>virtualenv</tag>
      </tags>
  </entry>
  <entry>
    <title>shellå˜é‡ä¸ç¯å¢ƒå˜é‡</title>
    <url>/posts/77ae/</url>
    <content><![CDATA[<blockquote>
<p>Shell å˜é‡åªåœ¨ä¸»shellæœ‰æ•ˆï¼Œå­è¿›ç¨‹æ— æ•ˆï¼Œç¯å¢ƒå˜é‡åœ¨ä¸»shellå’Œå­è¿›ç¨‹éƒ½æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡exportå‘½ä»¤å°†shellå˜é‡å˜ä¸ºç¯å¢ƒå˜é‡</p>
<p>ä½¿ç”¨setå‘½ä»¤æŸ¥çœ‹shellå˜é‡</p>
<p>ä½¿ç”¨printenvå‘½ä»¤æŸ¥çœ‹ç¯å¢ƒå˜é‡</p>
</blockquote>
<a id="more"></a>
<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>åœ¨pythonå·¥ç¨‹ä¸­ï¼Œæƒ³é€šè¿‡ç¯å¢ƒå˜é‡è·å–å‚æ•°å€¼ï¼Œå¹¶èµ‹å€¼ç»™pythonå˜é‡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">print(<span class="string">f"PID: <span class="subst">&#123;os.getpid()&#125;</span>, PPID: <span class="subst">&#123;os.getppid()&#125;</span>"</span>)</span><br><span class="line">host = os.getenv(<span class="string">'REDIS_HOST'</span>)</span><br><span class="line">port = os.getenv(<span class="string">'REDIS_PORT'</span>)</span><br><span class="line">password = os.getenv(<span class="string">'REDIS_PASSWORD'</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">f"<span class="subst">&#123;password&#125;</span>@<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>
<p>è€Œå‚æ•°å€¼æ”¾åœ¨ä¸€ä¸ªenvæ–‡ä»¶é‡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">REDIS_HOST=example.com</span><br><span class="line">REDIS_PORT=5432</span><br><span class="line">REDIS_PASSWORD=123456</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡æ‰§è¡Œ<code>source .env</code> ååœ¨ç»ˆç«¯æŸ¥çœ‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$REDIS_HOST</span> <span class="variable">$REDIS_PORT</span> <span class="variable">$REDIS_PASSWORD</span></span><br><span class="line">&gt; example.com 5432 123456</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰shell pid</span></span><br><span class="line"><span class="built_in">echo</span> $$</span><br><span class="line">&gt; 22650</span><br><span class="line"><span class="comment"># è¿è¡Œpython æ–‡ä»¶</span></span><br><span class="line">python variables.py</span><br><span class="line">&gt; PID: 23034, PPID: 22650</span><br><span class="line">&gt; None@None:None</span><br></pre></td></tr></table></figure>
<p>å‘ç°pythonå¹¶æœªè·å–åˆ°å­˜åœ¨shellç¯å¢ƒå˜é‡ä¸­çš„å€¼ï¼Œpythonè¿è¡Œçš„çˆ¶è¿›ç¨‹å·ä¸ºå½“å‰shellçš„è¿›ç¨‹å·ï¼Œè€Œå½“æ—¶pythonè¿è¡Œæ˜¯åœ¨å­è¿›ç¨‹ä¸­è¿è¡Œ</p>
<p>ä»¥ä¸Šçš„<code>souce .env</code>æ“ä½œæ˜¯å°†å˜é‡å­˜å…¥åˆ°shellå˜é‡ä¸­ï¼Œä½†æœªåœ¨ç¯å¢ƒå˜é‡ä¸­</p>
<h2 id="shellå˜é‡å’Œç¯å¢ƒå˜é‡">shellå˜é‡å’Œç¯å¢ƒå˜é‡</h2>
<p>For <a href="http://www.ee.surrey.ac.uk/Teaching/Unix/unix8.html" target="_blank" rel="noopener">Standard UNIX variables</a> , says:</p>
<blockquote>
<p>Standard UNIX variables are split into two categories, environment variables and shell variables. In broad terms, shell variables apply only to the current instance of the shell and are used to set short-term working conditions; environment variables have a farther reaching significance, and those set at login are valid for the duration of the session. By convention, environment variables have UPPER CASE and shell variables have lower case names.</p>
<p>æ ‡å‡†UNIXå˜é‡åˆ†ä¸ºä¸¤ç±»ï¼šç¯å¢ƒå˜é‡å’Œshellå˜é‡ï¼Œshellå˜é‡ä»…åœ¨å½“å‰shellï¼ˆä¸»è¿›ç¨‹ï¼‰æœ‰æ•ˆï¼Œç¯å¢ƒå˜é‡å¯ä»¥åœ¨å­è¿›ç¨‹æœ‰æ•ˆï¼Œé€šå¸¸ç¯å¢ƒå˜é‡ä¸ºå¤§å†™ï¼Œshellå˜é‡ä¸ºå°å†™</p>
</blockquote>
<p>For <a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_05_03" target="_blank" rel="noopener">POSIX-compatible shells</a> (including Bash), the standard says:</p>
<blockquote>
<p><strong>2.5.3 Shell Variables</strong><br>
Variables shall be initialized from the environment <em>[â€¦]</em> If a variable is initialized from the environment, it shall be marked for export immediately; see the export special built-in. New variables can be defined and initialized with variable assignments, <em>[etc.]</em></p>
<p>å¦‚æœshellå˜é‡è¦è½¬åŒ–ä¸ºç¯å¢ƒå˜é‡ï¼Œæ‰§è¡Œexport å‘½ä»¤</p>
</blockquote>
<h3 id="æŸ¥çœ‹shellå˜é‡å’Œç¯å¢ƒå˜é‡">æŸ¥çœ‹shellå˜é‡å’Œç¯å¢ƒå˜é‡</h3>
<ul>
<li>æŸ¥çœ‹shellå˜é‡ä½¿ç”¨<code>set</code>å‘½ä»¤</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span></span><br><span class="line"><span class="comment"># æˆªå–éƒ¨åˆ†</span></span><br><span class="line">&gt; ...</span><br><span class="line">&gt; status=0</span><br><span class="line">&gt; termcap</span><br><span class="line">&gt; terminfo</span><br><span class="line">&gt; userdirs</span><br><span class="line">&gt; usergroups</span><br><span class="line">&gt; watch=(  )</span><br><span class="line">&gt; widgets</span><br><span class="line">&gt; zle_bracketed_paste=( $<span class="string">'\C-[[?2004h'</span> $<span class="string">'\C-[[?2004l'</span> )</span><br><span class="line">&gt; zsh_eval_context=( toplevel )</span><br><span class="line">&gt; zsh_scheduled_events</span><br><span class="line">&gt; ...</span><br></pre></td></tr></table></figure>
<p>å¦å¤–å¯ä»¥é€šè¿‡set/unset æ¥è®¾ç½®/åˆ é™¤shellå˜é‡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span></span><br><span class="line"></span><br><span class="line">  Display, <span class="built_in">set</span> or <span class="built_in">unset</span> values of shell attributes and positional parameters.</span><br><span class="line"></span><br><span class="line">  - Display the names and values of shell variables:</span><br><span class="line">    <span class="built_in">set</span></span><br><span class="line"></span><br><span class="line">  - Mark variables that are modified or created <span class="keyword">for</span> <span class="built_in">export</span>:</span><br><span class="line">    <span class="built_in">set</span> -a</span><br><span class="line"></span><br><span class="line">  - Notify of job termination immediately:</span><br><span class="line">    <span class="built_in">set</span> -b</span><br><span class="line"></span><br><span class="line">  - Set various options, e.g. <span class="built_in">enable</span> vi style line editing:</span><br><span class="line">    <span class="built_in">set</span> -o vi</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">unset</span></span><br><span class="line"></span><br><span class="line">  Remove shell variables or <span class="built_in">functions</span>.</span><br><span class="line"></span><br><span class="line">  - Remove the variable foo, or <span class="keyword">if</span> the variable doesn<span class="string">'t exist, remove the function foo:</span></span><br><span class="line"><span class="string">    unset foo</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  - Remove the variables foo and bar:</span></span><br><span class="line"><span class="string">    unset -v foo bar</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  - Remove the function my_func:</span></span><br><span class="line"><span class="string">    unset -f my_func</span></span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹ç¯å¢ƒå˜é‡ä½¿ç”¨envæˆ–è€…printenv</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">printenv</span><br><span class="line">&gt; VIRTUALENVWRAPPER_WORKON_CD=1</span><br><span class="line">&gt; VIRTUALENVWRAPPER_SCRIPT=/opt/anaconda3/bin/virtualenvwrapper.sh</span><br><span class="line">&gt; WORKON_HOME=/Users/simple/.virtualenvs</span><br><span class="line">&gt; VIRTUALENVWRAPPER_HOOK_DIR=/Users/simple/.virtualenvs</span><br><span class="line">&gt; ANDROID_HOME=/Users/simple/Library/Android/sdk</span><br><span class="line">&gt; _=/usr/bin/printenv</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">env</span><br><span class="line"></span><br><span class="line">  Show the environment or run a program <span class="keyword">in</span> a modified environment.</span><br><span class="line"></span><br><span class="line">  - Show the environment:</span><br><span class="line">    env</span><br><span class="line"></span><br><span class="line">  - Run a program. Often used <span class="keyword">in</span> scripts after the shebang (<span class="comment">#!) for looking up the path to the program:</span></span><br><span class="line">    env program</span><br><span class="line"></span><br><span class="line">  - Clear the environment and run a program:</span><br><span class="line">    env -i program</span><br><span class="line"></span><br><span class="line">  - Remove variable from the environment and run a program:</span><br><span class="line">    env -u variable program</span><br><span class="line"></span><br><span class="line">  - Set a variable and run a program:</span><br><span class="line">    env variable=value program</span><br><span class="line"></span><br><span class="line">  - Set multiple variables and run a program:</span><br><span class="line">    env variable1=value variable2=value variable3=value program</span><br></pre></td></tr></table></figure>
<h2 id="è§£å†³">è§£å†³</h2>
<p>æ–¹æ³•å°±æ¯”è¾ƒæ˜æ˜¾äº†</p>
<p>ç¬¬ä¸€ç§ï¼Œä¿®æ”¹.envæ–‡ä»¶ï¼ŒåŠ å…¥exportï¼Œç„¶åæ‰§è¡Œ<code>source .env</code>ï¼Œæœ€åè¿è¡Œpythonå‘½ä»¤</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> REDIS_HOST=example.com</span><br><span class="line"><span class="built_in">export</span> REDIS_PORT=5432</span><br><span class="line"><span class="built_in">export</span> REDIS_PASSWORD=123456</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§ï¼Œåœ¨è¿è¡Œpython å‘½ä»¤å‰é¢åŠ ä¸Šenvæ“ä½œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">env REDIS_HOST=example.com REDIS_PORT=5432 REDIS_PASSWORD=123456 python variables.py</span><br><span class="line">&gt; PID: 23517, PPID: 22650</span><br><span class="line">&gt; 123456@example.com:5432</span><br></pre></td></tr></table></figure>
<h2 id="Tips">Tips</h2>
<p>åœ¨shellä¸­è·å–å½“å‰è¿›ç¨‹IDï¼Œçˆ¶è¿›ç¨‹IDä»¥åŠUID</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">"PID of this script: $$"</span></span><br><span class="line">&gt; 22650</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"PPID of this script: <span class="variable">$PPID</span>"</span></span><br><span class="line">&gt; 22649</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"UID of this script: <span class="variable">$UID</span>"</span></span><br><span class="line">&gt; 501</span><br></pre></td></tr></table></figure>
<p>åœ¨pythonè„šæœ¬ä¸­è·å–å½“å‰è¿›ç¨‹IDä»¥åŠçˆ¶è¿›ç¨‹ID</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print(<span class="string">f"PID: <span class="subst">&#123;os.getpid()&#125;</span>, PPID: <span class="subst">&#123;os.getppid()&#125;</span>"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="http://www.ee.surrey.ac.uk/Teaching/Unix/unix8.html" target="_blank" rel="noopener">UNIX Tutorial Eight</a></p>
<p>[2] <a href="https://stackoverflow.com/questions/3341372/difference-between-shell-and-environment-variables" target="_blank" rel="noopener">difference-between-shell-and-environment-variables</a></p>
<p>[3] <a href="https://unix.stackexchange.com/questions/364655/shell-variable-vs-environment-variable-which-one-is-preferred-if-both-have-the" target="_blank" rel="noopener">shell-variable-vs-environment-variable-which-one-is-preferred-if-both-have-the-same-name</a></p>
<p>[4] <a href="https://linuxize.com/post/how-to-set-and-list-environment-variables-in-linux/" target="_blank" rel="noopener">How to Set and List Environment Variables in Linux</a></p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨Ubuntuä¸­åˆ›å»ºsudo user</title>
    <url>/posts/c222/</url>
    <content><![CDATA[<ul>
<li>åˆ›å»ºç”¨æˆ·</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·ä¸ºusernameçš„ç”¨æˆ·ï¼Œå¹¶æŒ‡å®šä¸»ç›®å½•home</span></span><br><span class="line">sudo user add [username] --home [home]</span><br><span class="line"><span class="comment"># ä¸ºåˆ›å»ºçš„ç”¨æˆ·è®¾å®šå¯†ç </span></span><br><span class="line">passwd [username]</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡usermodå‘½ä»¤å°†ç”¨æˆ·æ·»åŠ åˆ°sudo groupï¼ˆéƒ¨ç½²rootç»„ï¼‰</li>
</ul>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">sudo usermode -aG sudo [username]</span><br><span class="line"><span class="comment"># ä¹‹åå°±å¯ä»¥ä½¿ç”¨sudo å°†å½“å‰ç”¨æˆ·æƒé™æå‡åˆ°ç®¡ç†å‘˜æƒé™</span></span><br><span class="line">su [username]</span><br><span class="line"><span class="comment"># è¾“å…¥å¯†ç </span></span><br><span class="line"><span class="comment"># sudo + command æ‰§è¡Œå‘½ä»¤</span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š</p>
<ol>
<li>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-sudo-user-on-ubuntu-quickstart" target="_blank" rel="noopener">https://www.digitalocean.com/community/tutorials/how-to-create-a-sudo-user-on-ubuntu-quickstart</a></p>
</li>
<li>
<p><a href="https://ohmyz.sh/" target="_blank" rel="noopener">https://ohmyz.sh/</a></p>
</li>
</ol>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>ubuntu</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨linuxä¸­å®‰è£…oh-my-zsh</title>
    <url>/posts/ea0a/</url>
    <content><![CDATA[<blockquote>
<p>oh-my-zsh æ˜¯zshçš„ç®¡ç†é…ç½®å·¥å…·ï¼Œå› æ­¤åœ¨ä½¿ç”¨oh-my-zshä¹‹å‰å®‰è£…zsh</p>
</blockquote>
<p><img src="https://oss.smart-lifestyle.cn/blog/w5ahz.jpg" alt="zsh"></p>
<ol>
<li>åˆ¤æ–­å½“å‰ç³»ç»Ÿä½¿ç”¨çš„shell</li>
</ol>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰“å°å½“å‰ç³»ç»Ÿä½¿ç”¨çš„shell</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line"><span class="comment"># å¯èƒ½ä¼šè¾“å‡º</span></span><br><span class="line"><span class="comment"># /bin/bash</span></span><br><span class="line"><span class="comment"># /bin/sh</span></span><br><span class="line"><span class="comment"># /bin/zsh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ”¯æŒçš„shell</span></span><br><span class="line">cat /etc/shells</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å®‰è£…zsh</li>
</ol>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæœªå®‰è£…zsh</span></span><br><span class="line">sudo apt-get install zsh</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>åˆ‡æ¢shellä¸ºzsh</li>
</ol>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># éœ€è¦é‡å¯</span></span><br><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>å®‰è£… oh my zsh</li>
</ol>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># via curl</span></span><br><span class="line">sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>"</span></span><br><span class="line"><span class="comment"># via wget</span></span><br><span class="line">sh -c <span class="string">"<span class="variable">$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>"</span></span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://www.jianshu.com/p/d194d29e488c" target="_blank" rel="noopener">https://www.jianshu.com/p/d194d29e488c</a></li>
</ol>
]]></content>
      <categories>
        <category>zsh</category>
      </categories>
      <tags>
        <tag>oh-my-zsh</tag>
      </tags>
  </entry>
  <entry>
    <title>å°ç¨‹åºä¸‹æ‹‰åˆ·æ–°æ“ä½œ</title>
    <url>/posts/1ea1/</url>
    <content><![CDATA[<ul>
<li>åŠŸèƒ½ï¼š å®ç°æ‰‹åŠ¨ä¸‹æ‹‰åˆ·æ–°è§¦å‘äº‹ä»¶</li>
</ul>
<ul>
<li>åœ¨éœ€è¦åŠ è½½ä¸‹æ‹‰åˆ·æ–°é¡µé¢çš„jsonæ–‡ä»¶ä¸­åŠ å…¥ <strong>â€œenablePullDownRefreshâ€: true, â€œbackgroundTextStyleâ€: â€œdarkâ€</strong>,</li>
</ul>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"enablePullDownRefresh"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"backgroundTextStyle"</span>: <span class="string">"dark"</span>,</span><br><span class="line">    <span class="attr">"usingComponents"</span>: &#123;</span><br><span class="line">    <span class="attr">"mp-dialog"</span>: <span class="string">"../../weui-miniprogram/dialog/dialog"</span>,</span><br><span class="line">    <span class="attr">"mp-navigation-bar"</span>: <span class="string">"../../weui-miniprogram/navigation-bar/navigation-bar"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>åœ¨å¯¹åº”çš„jsæ–‡ä»¶ä¸­é…ç½®æ–¹æ³•</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">onPullDownRefresh: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      wx.showNavigationBarLoading();</span><br><span class="line">      <span class="comment">// ä½ è¦è§¦å‘çš„å‡½æ•°</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'refresh'</span>);</span><br><span class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// æ ‡é¢˜æ éšè—åˆ·æ–°è½¬åœˆåœˆå›¾æ ‡</span></span><br><span class="line">        wx.hideNavigationBarLoading();</span><br><span class="line">        wx.stopPullDownRefresh(&#123;</span><br><span class="line">          complete: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;&#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">  </span><br><span class="line">        &#125;, <span class="number">500</span>);</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>åœ¨onShowä¸­åŠ å…¥startPullDownRefreshï¼Œä¼šæ¯æ¬¡show é¡µé¢æ—¶è°ƒç”¨åˆ·æ–°å‡½æ•°</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">onShow: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      wx.startPullDownRefresh(&#123;</span><br><span class="line">         complete: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">           <span class="built_in">console</span>.log(<span class="string">'===============onshow resfrsh use info'</span>)</span><br><span class="line">         &#125;,</span><br><span class="line">       &#125;)</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://blog.csdn.net/weichen913/article/details/79360658" target="_blank" rel="noopener">å°ç¨‹åºä¸Šæ‹‰åŠ è½½å’Œä¸‹æ‹‰åˆ·æ–°é—®é¢˜æ€»ç»“</a></li>
</ol>
<hr>
<p>æœ€åæ•ˆæœ<br>
<img src="https://oss.smart-lifestyle.cn/blog/yqv6s.gif" alt="image"></p>
]]></content>
      <categories>
        <category>å°ç¨‹åº</category>
      </categories>
      <tags>
        <tag>å°ç¨‹åº</tag>
      </tags>
  </entry>
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºå…¨å±€å˜é‡</title>
    <url>/posts/b9a0/</url>
    <content><![CDATA[<blockquote>
<p>é€šè¿‡åœ¨app.jsä¸­å£°æ˜globalDataï¼Œå°†æ‰€éœ€è¦çš„å˜é‡åŠå…¶å€¼æ”¾åœ¨è¿™é‡Œ</p>
</blockquote>
<ol>
<li>å®šä¹‰å£°æ˜</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">globalData: &#123;</span><br><span class="line">    userInfo: <span class="literal">null</span>,</span><br><span class="line">    <span class="comment">// dev or prod</span></span><br><span class="line">    platform: <span class="string">"dev"</span>,</span><br><span class="line">    dev_server: <span class="string">"xxxx"</span>,</span><br><span class="line">    prod_server: <span class="string">"xxxxxx"</span>,</span><br><span class="line">    feedback_server: <span class="string">"xxxxx"</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>å¼•ç”¨</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœ¨éœ€è¦ä½¿ç”¨å…¨å±€å˜é‡çš„åœ°æ–¹ï¼Œå£°æ˜å˜é‡</span></span><br><span class="line"><span class="keyword">const</span> app = getApp();</span><br><span class="line"><span class="comment">// å¼•ç”¨</span></span><br><span class="line"><span class="keyword">var</span> paltform = app.globalData.platform</span><br><span class="line">...</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://www.jianshu.com/p/925aad432874" target="_blank" rel="noopener">å¾®ä¿¡å°ç¨‹åº å…¨å±€å˜é‡</a></li>
</ol>
]]></content>
      <categories>
        <category>å°ç¨‹åº</category>
      </categories>
      <tags>
        <tag>å°ç¨‹åº</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»„ä»¶åŒ–å®æˆ˜</title>
    <url>/posts/9b54/</url>
    <content><![CDATA[<p>ç›®å‰å‰ç«¯ä¸‰å¤§æ¡†æ¶ï¼ˆVue.js, Angular.js, React.jsï¼‰éƒ½åœ¨å¼•é¢†ç€å‰ç«¯çš„ç»„ä»¶åŒ–å¼€å‘æ–¹å‘ï¼Œç»„ä»¶åŒ–çš„å‰ç«¯å¼€å‘æ–¹å¼çš„ç¡®ä¸ºä¸šåŠ¡å®ç°å¸¦æ¥äº†å‰æ‰€æœªæœ‰çš„æ–¹ä¾¿ï¼Œä½†å¦‚ä½•å°è£…ä¸€ä¸ªä¼˜ç§€çš„ç»„ä»¶ï¼Œå¯èƒ½å¹¶ä¸æ˜¯æ¯ä½å‰ç«¯å¼€å‘è€…éƒ½èƒ½å¤Ÿåšå¥½çš„ã€‚</p>
<h2 id="ç»„ä»¶åŒ–çš„ç‰¹ç‚¹">ç»„ä»¶åŒ–çš„ç‰¹ç‚¹</h2>
<ul>
<li>ç»„ä»¶åŒ–æ˜¯å¯¹å®ç°çš„åˆ†å±‚ï¼Œæ˜¯æ›´æœ‰æ•ˆåœ°ä»£ç ç»„åˆæ–¹å¼</li>
<li>ç»„ä»¶åŒ–æ˜¯å¯¹èµ„æºçš„é‡ç»„å’Œä¼˜åŒ–ï¼Œä»è€Œä½¿é¡¹ç›®èµ„æºç®¡ç†æ›´åˆç†</li>
<li>ç»„ä»¶åŒ–æœ‰åˆ©äºå•å…ƒæµ‹è¯•</li>
<li>ç»„ä»¶åŒ–å¯¹é‡æ„è¾ƒå‹å¥½</li>
</ul>
<h3 id="ç»„ä»¶ä¸æ¨¡å—">ç»„ä»¶ä¸æ¨¡å—</h3>
<p>æ¨¡å—(Module)é€šå¸¸å¼ºè°ƒçš„æ˜¯èŒè´£ï¼ˆåˆ†ç¦»ã€å†…èšï¼‰ï¼Œç»„ä»¶æ˜¯å¯å¤ç”¨æ¨¡å—å’Œç›¸å…³ä¾èµ–çš„å°è£…ã€‚</p>
<blockquote>
<p>In my view, Module and Component are all just a couple of functions and assets.<br>
And the different between them is:<br>
<strong>Component has business logical and module not.</strong><br>
For example,this text input area is just a Module, but when there was some post api called,it become a Component. you can put a module everywhere and it will work fine, but Componet just can be used in a specific page or view(coz it has a specific api call)</p>
</blockquote>
<h3 id="ç»„ä»¶åŒ–ç»“æ„">ç»„ä»¶åŒ–ç»“æ„</h3>
<p>ä¸€ä¸ªç»„ä»¶åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼š</p>
<ul>
<li>Attribute</li>
<li>Config &amp; State</li>
<li>Event</li>
<li>Lifecycle</li>
<li>Children</li>
<li>Properties</li>
<li>Methods</li>
<li>Inherit<br>
<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-170957.png" alt=""></li>
</ul>
<h2 id="Webpackèµ„æºç»„ä»¶åŒ–">Webpackèµ„æºç»„ä»¶åŒ–</h2>
<blockquote>
<p>webpack æ˜¯ä¸€ä¸ªç°ä»£ JavaScript åº”ç”¨ç¨‹åºçš„é™æ€æ¨¡å—æ‰“åŒ…å™¨(module bundler)ã€‚å½“ webpack å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šé€’å½’åœ°æ„å»ºä¸€ä¸ªä¾èµ–å…³ç³»å›¾(dependency graph)ï¼Œå…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºéœ€è¦çš„æ¯ä¸ªæ¨¡å—ï¼Œç„¶åå°†æ‰€æœ‰è¿™äº›æ¨¡å—æ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ª bundle<br>
<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-160837.jpg" alt=""><br>
ä»å›¾ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œwebpackå°†å¤šç§é™æ€èµ„æºjsã€cssã€lessç­‰è½¬åŒ–æˆä¸€ä¸ªé™æ€æ–‡ä»¶ï¼Œå‡å°‘é¡µé¢çš„è¯·æ±‚<br>
WebpackåŒ…æ‹¬å››ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼šå…¥å£ã€è¾“å‡ºã€loaderã€æ’ä»¶</p>
</blockquote>
<h3 id="å…¥å£">å…¥å£</h3>
<p>å…¥å£èµ·ç‚¹(entry point)æŒ‡ç¤º webpack åº”è¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å—ï¼Œæ¥ä½œä¸ºæ„å»ºå…¶å†…éƒ¨ä¾èµ–å›¾çš„å¼€å§‹ã€‚è¿›å…¥å…¥å£èµ·ç‚¹åï¼Œwebpack ä¼šæ‰¾å‡ºæœ‰å“ªäº›æ¨¡å—å’Œåº“æ˜¯å…¥å£èµ·ç‚¹ï¼ˆç›´æ¥å’Œé—´æ¥ï¼‰ä¾èµ–çš„ï¼Œå¯ä»¥é€šè¿‡åœ¨ webpack é…ç½®ä¸­é…ç½® entry å±æ€§ï¼Œæ¥æŒ‡å®šä¸€ä¸ªå…¥å£èµ·ç‚¹ï¼ˆæˆ–å¤šä¸ªå…¥å£èµ·ç‚¹ï¼‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mode: <span class="string">'development'</span>,</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'main.js'</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="å‡ºå£">å‡ºå£</h3>
<p>output å±æ€§å‘Šè¯‰ webpack åœ¨å“ªé‡Œè¾“å‡ºå®ƒæ‰€åˆ›å»ºçš„ bundlesï¼Œä»¥åŠå¦‚ä½•å‘½åè¿™äº›æ–‡ä»¶ï¼Œé»˜è®¤å€¼ä¸º ./distã€‚ä½ å¯ä»¥é€šè¿‡åœ¨é…ç½®ä¸­æŒ‡å®šä¸€ä¸ª output å­—æ®µï¼Œæ¥é…ç½®è¿™äº›å¤„ç†è¿‡ç¨‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mode: <span class="string">'development'</span>,</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'main.js'</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="LOADER">LOADER</h3>
<p>loader è®© webpack èƒ½å¤Ÿå»å¤„ç†é‚£äº›é JavaScript æ–‡ä»¶ï¼ˆwebpack è‡ªèº«åªç†è§£ JavaScriptï¼‰ã€‚loader å¯ä»¥å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶è½¬æ¢ä¸º webpack èƒ½å¤Ÿå¤„ç†çš„æœ‰æ•ˆæ¨¡å—ï¼Œç„¶åä½ å°±å¯ä»¥åˆ©ç”¨ webpack çš„æ‰“åŒ…èƒ½åŠ›ï¼Œå¯¹å®ƒä»¬è¿›è¡Œå¤„ç†ã€‚<br>
æœ¬è´¨ä¸Šï¼Œwebpack loader å°†æ‰€æœ‰ç±»å‹çš„æ–‡ä»¶ï¼Œè½¬æ¢ä¸ºåº”ç”¨ç¨‹åºçš„ä¾èµ–å›¾ï¼ˆå’Œæœ€ç»ˆçš„ bundleï¼‰å¯ä»¥ç›´æ¥å¼•ç”¨çš„æ¨¡å—ã€‚<br>
åœ¨æ›´é«˜å±‚é¢ï¼Œåœ¨ webpack çš„é…ç½®ä¸­ loader æœ‰ä¸¤ä¸ªç›®æ ‡ï¼š</p>
<ol>
<li>test å±æ€§ï¼Œç”¨äºæ ‡è¯†å‡ºåº”è¯¥è¢«å¯¹åº”çš„ loader è¿›è¡Œè½¬æ¢çš„æŸä¸ªæˆ–æŸäº›æ–‡ä»¶ã€‚</li>
<li>use å±æ€§ï¼Œè¡¨ç¤ºè¿›è¡Œè½¬æ¢æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å“ªä¸ª loaderã€‚</li>
</ol>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>, <span class="attr">loader</span>: <span class="string">"babel-loader"</span> &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'sass-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              <span class="comment">// Prefer `dart-sass`</span></span><br><span class="line">              implementation: <span class="built_in">require</span>(<span class="string">'sass'</span>),</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">     </span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="æ’ä»¶">æ’ä»¶</h3>
<p>loader è¢«ç”¨äºè½¬æ¢æŸäº›ç±»å‹çš„æ¨¡å—ï¼Œè€Œæ’ä»¶åˆ™å¯ä»¥ç”¨äºæ‰§è¡ŒèŒƒå›´æ›´å¹¿çš„ä»»åŠ¡ã€‚æƒ³è¦ä½¿ç”¨ä¸€ä¸ªæ’ä»¶ï¼Œä½ åªéœ€è¦ require() å®ƒï¼Œç„¶åæŠŠå®ƒæ·»åŠ åˆ° plugins æ•°ç»„ä¸­ã€‚å¤šæ•°æ’ä»¶å¯ä»¥é€šè¿‡é€‰é¡¹(option)è‡ªå®šä¹‰ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­å› ä¸ºä¸åŒç›®çš„è€Œå¤šæ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ’ä»¶ï¼Œè¿™æ—¶éœ€è¦é€šè¿‡ä½¿ç”¨ new æ“ä½œç¬¦æ¥åˆ›å»ºå®ƒçš„ä¸€ä¸ªå®ä¾‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> CopyPlugin([</span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'./static/'</span>, <span class="attr">to</span>: <span class="string">'static/'</span>, <span class="attr">force</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'./index.html'</span>, <span class="attr">to</span>: <span class="string">'index.html'</span>, <span class="attr">force</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    ]),</span><br><span class="line">  ],</span><br></pre></td></tr></table></figure>
<p>æœ¬é¡¹ç›®ä¸­å®Œæ•´webpackå®ä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># webpack.config.js</span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> CopyPlugin = <span class="built_in">require</span>(<span class="string">'copy-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'main.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>, <span class="attr">loader</span>: <span class="string">"babel-loader"</span> &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.s[ac]ss$/i</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'sass-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              <span class="comment">// Prefer `dart-sass`</span></span><br><span class="line">              implementation: <span class="built_in">require</span>(<span class="string">'sass'</span>),</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">     </span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CopyPlugin([</span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'./static/'</span>, <span class="attr">to</span>: <span class="string">'static/'</span>, <span class="attr">force</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">from</span>: <span class="string">'./index.html'</span>, <span class="attr">to</span>: <span class="string">'index.html'</span>, <span class="attr">force</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    ]),</span><br><span class="line">  ],</span><br><span class="line">  devtool: <span class="string">'inline-source-map'</span>,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: <span class="string">'./dist'</span>,</span><br><span class="line">    host: <span class="string">'0.0.0.0'</span>,</span><br><span class="line">    port: <span class="string">'8000'</span>,</span><br><span class="line">    hot: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    minimize: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="ç»„ä»¶å®æˆ˜">ç»„ä»¶å®æˆ˜</h2>
<h3 id="Tabç»„ä»¶">Tabç»„ä»¶</h3>
<h4 id="é€šè¿‡ç‚¹å‡»Tab-Headerå®ç°">é€šè¿‡ç‚¹å‡»Tab Headerå®ç°</h4>
<ol>
<li>Display åˆ‡æ¢<br>
<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-165152.png" alt=""></li>
<li>Animationåˆ‡æ¢<br>
ï¿¼<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-165231.png" alt=""></li>
</ol>
<h4 id="é€šè¿‡æ‰‹åŠ¿åˆ‡æ¢">é€šè¿‡æ‰‹åŠ¿åˆ‡æ¢</h4>
<p>è·Ÿ Carousel åŒä¸€åŸç†<br>
<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-165814.png" alt=""></p>
<h4 id="Scrollç»„ä»¶">Scrollç»„ä»¶</h4>
<ol>
<li>ScrollTop<br>
ï¿¼<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-165949.png" alt=""></li>
<li>é€šè¿‡ç«™ä½å…ƒç´ å®ç°<br>
<img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-170030.png" alt=""></li>
</ol>
<h2 id="æœ€ç»ˆæ•ˆæœ">æœ€ç»ˆæ•ˆæœ</h2>
<p><img src="https://oss.smart-lifestyle.cn/blog/2019-11-16-2019-11-17%2001.21.51.gif" alt=""></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>é€šè¿‡ä¸‰ä¸ªæœˆè·Ÿç€æå®¢å¤§å­¦å‰ç«¯è®­ç»ƒè¥å’Œwinterè€å¸ˆçš„å­¦ä¹ ï¼Œä»åŸºæœ¬åŠŸèƒ½å®ç°ä¸€ä¸ªç®€å•çš„æœ‰å¥½è´§é¡µé¢ã€‚<br>
ç»„ä»¶åŒ–åŒ–æ€æƒ³å¾ˆé‡è¦ï¼Œé¿å…äº†é‡å¤é€ è½®å­ï¼Œä½¿è‡ªå·±çš„ä»£ç æ›´åŠ å¥å…¨ï¼Œéœ€è¦ä¹‹åçš„å·¥ä½œä¸­å¤šå¤šå®è·µï¼Œæ·±åˆ»ä½“ä¼šç»„ä»¶åŒ–æ€æƒ³ï¼Œç›®å‰æˆ‘è¿˜éœ€è¦å¤šç»ƒå¤šä½“ä¼šã€‚<br>
é©å‘½å°šæœªæˆåŠŸï¼ŒåŒå¿—è¿˜éœ€åŠªåŠ›ã€‚<br>
<strong>æœªå®Œç»“</strong><br>
å®Œæ•´ä»£ç åœ°å€ï¼š<br>
<a href="https://github.com/simplezhao/Front-end" target="_blank" rel="noopener" title="å‰æ®µè®­ç»ƒè¥"></a></p>
]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡ftplibè·å–ftpæŒ‡å®šæ—¥æœŸé—´çš„æ–‡ä»¶</title>
    <url>/posts/e530/</url>
    <content><![CDATA[<h2 id="ä½¿ç”¨python-ftplib-åº“è·å–-æŸä¸€å¤©çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°">ä½¿ç”¨python ftplib åº“è·å– æŸä¸€å¤©çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸‹è½½åˆ°æœ¬åœ°</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ftp è®¾ç½®</span></span><br><span class="line">ftp_server = <span class="string">"******"</span></span><br><span class="line">ftp_user = <span class="string">"*****"</span></span><br><span class="line">ftp_password = <span class="string">"******"</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ftplib <span class="keyword">import</span> FTP</span><br><span class="line"></span><br><span class="line">ftp = FTP(host=ftp_server, user=ftp_user, passwd=ftp_password)</span><br><span class="line"><span class="comment"># é€šè¿‡nlstè·å–æ–‡ä»¶åˆ—è¡¨</span></span><br><span class="line">file_list = ftp.nlst()</span><br><span class="line"><span class="comment"># é€šè¿‡voidcmd è·å–æ–‡ä»¶æ›´æ–°ï¼ˆä¸Šä¼ ï¼‰æ—¶é—´</span></span><br><span class="line">date = ftp.voidcmd(<span class="string">f"MDTM 202002190502.csv"</span>)</span><br><span class="line">print(date)</span><br></pre></td></tr></table></figure>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"># <span class="number">213</span> <span class="number">20200219170403</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–æ–‡ä»¶</span></span><br><span class="line">filter_date = <span class="string">'20200520'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨</span></span><br><span class="line">items = filter(<span class="keyword">lambda</span> x: ftp.voidcmd(<span class="string">f"MDTM <span class="subst">&#123;x&#125;</span>"</span>)[<span class="number">4</span>:<span class="number">12</span>] == filter_date, file_list)</span><br><span class="line"><span class="comment"># éå†è¿­ä»£å™¨, é€šè¿‡retrbinaryä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">    print(<span class="string">f"file name: <span class="subst">&#123;item&#125;</span>"</span>)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">f'temp/<span class="subst">&#123;item&#125;</span>'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        ftp.retrbinary(<span class="string">f'RETR <span class="subst">&#123;item&#125;</span>'</span>, fp.write)</span><br><span class="line"><span class="comment"># å…³é—­ftp</span></span><br><span class="line">ftp.quit()</span><br></pre></td></tr></table></figure>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200508.csv</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200509.csv</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200514.csv</span><br><span class="line"><span class="keyword">file</span> <span class="keyword">name</span>: HMI123456789_20200520.csv</span><br><span class="line"></span><br><span class="line"><span class="string">'221 Goodbye.'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å½“ftp æœåŠ¡å™¨å…³é—­æ˜¯ï¼Œå†éå†è¿‡æ»¤åçš„è¿­ä»£å™¨å°†ä¸ºç©º</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> items:</span><br><span class="line">    print(itme)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å¦å¤–è¿˜å¯ä»¥é€šè¿‡ftp.dirè·å–ï¼Œå…·ä½“å®ç°å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplib" target="_blank" rel="noopener">https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplib</a></p>
<p>å‚è€ƒï¼š</p>
<ol>
<li><a href="https://docs.python.org/3/library/ftplib.html" target="_blank" rel="noopener" title="ftplib">https://docs.python.org/3/library/ftplib.html</a></li>
<li><a href="https://stackoverflow.com/questions/8990598/python-ftp-get-the-most-recent-file-by-date?answertab=votes#tab-top" target="_blank" rel="noopener" title="Python FTP get the most recent file by date">https://stackoverflow.com/questions/8990598/python-ftp-get-the-most-recent-file-by-date?answertab=votes#tab-top</a></li>
<li><a href="https://stackoverflow.com/questions/29026709/how-to-get-ftp-files-modify-time-using-python-ftplib" target="_blank" rel="noopener" title="How to get FTP file's modify time using Python ftplib">https://stackoverflow.com/questions/29026709/how-to-get-ftp-files-modify-time-using-python-ftplib</a></li>
<li><a href="https://tools.ietf.org/html/rfc3659#section-3" target="_blank" rel="noopener" title="rfc3659">https://tools.ietf.org/html/rfc3659#section-3</a></li>
<li><a href="https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplib" target="_blank" rel="noopener">Â https://www.semicolonworld.com/question/57790/how-to-get-ftp-file-39-s-modify-time-using-python-ftplibÂ </a></li>
</ol>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>ftplib</tag>
      </tags>
  </entry>
  <entry>
    <title>è°·æ­Œå·¥ç¨‹å®è·µ â€” code review å¼€å‘è€…æŒ‡å—</title>
    <url>/posts/3c88/</url>
    <content><![CDATA[<blockquote>
<p>æ›´å¥½çš„é€šè¿‡Code review<br>
å‚è€ƒåœ°å€ï¼š<a href="https://xindoo.github.io/eng-practices-cn/" target="_blank" rel="noopener" title="è°·æ­Œå·¥ç¨‹å®è·µ">https://xindoo.github.io/eng-practices-cn/</a></p>
</blockquote>
<h2 id="å†™ä¸€ä¸ªå¥½çš„CL-1-æè¿°">å†™ä¸€ä¸ªå¥½çš„CL[^1]æè¿°</h2>
<blockquote>
<p>ä¸€ä¸ªCLæè¿°è®°å½•äº†åšäº†ä»€ä¹ˆæ›´æ”¹ä»¥åŠä¸ºä»€ä¹ˆåšè¿™ä¸ªæ›´æ”¹</p>
</blockquote>
<h3 id="ç¬¬ä¸€è¡Œ">ç¬¬ä¸€è¡Œ</h3>
<p>CLæè¿°çš„ç¬¬ä¸€è¡Œï¼Œåº”è¯¥æ˜¯å¯¹CLæ­£åœ¨åšçš„å…·ä½“å·¥ä½œçš„çŸ­ç®€æ€»ç»“ï¼Œè¦åšåˆ°ï¼š</p>
<ul>
<li>è¨€ç®€æ„èµ…</li>
<li>è¯­ä¹‰å®Œæ•´</li>
<li>ç©ºè¡Œéš”å¼€</li>
</ul>
<h3 id="æ­£æ–‡å†…å®¹ä¸°å¯Œ">æ­£æ–‡å†…å®¹ä¸°å¯Œ</h3>
<p>å…¶ä½™æè¿°åº”è¯¥å…·ä½“ä¸°å¯Œï¼Œå¯èƒ½åŒ…æ‹¬æ­£åœ¨è§£å†³é—®é¢˜çš„ç®€è¦æ¦‚è¿°ã€ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå¦‚æœå­˜åœ¨ç¼ºç‚¹ï¼Œåº”è¯¥æåŠåˆ°ã€‚ä¹Ÿåº”è¯¥åŒ…æ‹¬ç›¸å…³çš„èƒŒæ™¯ä¿¡æ¯</p>
<h3 id="ä¸¾ä¾‹">ä¸¾ä¾‹</h3>
<h4 id="åä¾‹">åä¾‹</h4>
<ul>
<li>ä¿®å¤bug</li>
<li>æ·»åŠ è¡¥ä¸</li>
<li>é˜¶æ®µ1<br>
ä»¥ä¸Šæè¿°ä¸å¤Ÿå……åˆ†ï¼Œä¸çŸ¥é“ç©¶ç«Ÿåœ¨å¹²ä»€ä¹ˆ</li>
</ul>
<h4 id="å¥½çš„CLæè¿°">å¥½çš„CLæè¿°</h4>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">é‡æ„ï¼Œå°†modbusé‡‡é›†ç”±åŒæ­¥æ–¹å¼æ”¹ä¸ºå¼‚æ­¥æ–¹å¼</span><br><span class="line"></span><br><span class="line">å¤šè·¯modbusé‡‡é›†æ—¶ï¼ŒåŒæ­¥æ–¹å¼å¯¼è‡´é‡‡é›†æ—¶é—´è¿‡é•¿ï¼Œå½±å“åç»­çš„æ•°æ®å¤„ç†ï¼Œæ”¹ä¸ºå¼‚æ­¥æ–¹å¼åï¼Œå¢åŠ å¹¶å‘æ•°ï¼Œæé«˜é‡‡é›†é€Ÿåº¦ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="CLåº”è¯¥å°½å¯èƒ½ç®€çŸ­">CLåº”è¯¥å°½å¯èƒ½ç®€çŸ­</h2>
<blockquote>
<p>ç®€çŸ­çš„CLæŒ‡çš„æ˜¯å°½å¯èƒ½åœ¨ä¸€æ¬¡å‡å°‘æäº¤å˜æ›´ï¼Œé¿å…å·¨å¤§æ”¹åŠ¨<br>
å¦‚æœä½ æä¾›ä¸äº†ç®€çŸ­çš„CLï¼Œè¯´æ˜ä½ çš„ä»£ç å¯èƒ½éœ€è¦é‡æ„äº†<br>
CLæ›´ç®€çŸ­ï¼Œæœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š</p>
</blockquote>
<ul>
<li>code review æ›´å¿«</li>
<li>å‡å°‘å¯¼è‡´bugçš„å¯èƒ½æ€§</li>
<li>è¾ƒå°‘ä¸å¿…è¦çš„å·¥ä½œ</li>
<li>æ›´æ–¹ä¾¿çš„åˆå¹¶ä»£ç </li>
<li>æœ‰åŠ©äºåšå‡ºæ›´å¥½çš„è®¾è®¡</li>
<li>é™ä½å®¡æŸ¥è€…çš„éš¾åº¦</li>
</ul>
<h3 id="æ€ä¹ˆç®—ç®€çŸ­">æ€ä¹ˆç®—ç®€çŸ­</h3>
<p>é€šå¸¸CLçš„æ­£ç¡®å¤§å°æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ›´æ”¹ï¼Œè¿™æ„å‘³ç€ï¼šCLæ‰€åšçš„æœ€å°æ›´æ”¹ä»…è§£å†³äº†ä¸€ä»¶äº‹æƒ…ï¼Œæ¯”å¦‚ä½ éœ€è¦å¢åŠ ä¸¤ä¸ªç‹¬ç«‹çš„APIæ¥å£ï¼Œåº”è¯¥åˆ†åˆ«æäº¤APIã€‚</p>
<h3 id="æŠŠä»£ç é‡æ„åˆ†ç¦»å‡ºæ¥">æŠŠä»£ç é‡æ„åˆ†ç¦»å‡ºæ¥</h3>
<p>é‡æ„æœ€å¥½ä¸è¦å’ŒåŠŸèƒ½ä¿®æ”¹æˆ–è€…bug fixä¸€èµ·æCLï¼Œæ¯”å¦‚é‡å‘½åä¸€ä¸ªClassï¼Œæœ€å¥½å’Œè¿™ä¸ªCLassçš„bug fixåˆ†å¼€æCLï¼Œè¿™æ ·å¯¹äºè¯„å®¡è€…æ¥è¯´ï¼Œæ›´å®¹æ˜“ç†è§£</p>
<h3 id="å°†ç›¸å…³æµ‹è¯•ä»£ç ä¿å­˜åœ¨åŒä¸€CLä¸­">å°†ç›¸å…³æµ‹è¯•ä»£ç ä¿å­˜åœ¨åŒä¸€CLä¸­</h3>
<p>åº”è¯¥é¿å…å°†æµ‹è¯•ä»£ç æ‹†åˆ†ä¸ºå•ç‹¬çš„CLï¼ŒéªŒè¯ä»£ç ä¿®æ”¹çš„æµ‹è¯•ä¹Ÿåº”è¯¥è¿›å…¥ç›¸åŒçš„CL</p>
<p>[^1]:	CL is ChangeList</p>
]]></content>
      <categories>
        <category>book</category>
      </categories>
      <tags>
        <tag>code review</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonåŸºç¡€ -- pythonä¸excel-1</title>
    <url>/posts/df7e/</url>
    <content><![CDATA[<blockquote>
<p>ä½¿ç”¨openpyxlå¯¹excelæ–‡ä»¶è¿›è¡Œè¯»å†™</p>
<p><a href="https://openpyxl.readthedocs.io/en/stable/tutorial.html" target="_blank" rel="noopener">å®˜æ–¹æŒ‡å¯¼æ–‡æ¡£</a></p>
</blockquote>
<h2 id="å‡†å¤‡">å‡†å¤‡</h2>
<h3 id="excelåŸºæœ¬æœ¯è¯­">excelåŸºæœ¬æœ¯è¯­</h3>
<table>
<thead>
<tr>
<th>æœ¯è¯­</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody>
<tr>
<td>Spreadsheet or Workbook</td>
<td>excelæ–‡ä»¶</td>
</tr>
<tr>
<td>Worksheet or Sheet</td>
<td>è¡¨ï¼Œä¸€ä¸ªworkbook/spreadsheetå¯ä»¥æœ‰å¤šä¸ªsheet</td>
</tr>
<tr>
<td>Column</td>
<td>è¡¨æ ¼åˆ—Aâ€¦Zâ€¦</td>
</tr>
<tr>
<td>Row</td>
<td>è¡¨æ ¼è¡Œ1â€¦10â€¦</td>
</tr>
<tr>
<td>Cell</td>
<td>å•å…ƒæ ¼A1â€¦A2â€¦</td>
</tr>
</tbody>
</table>
<h3 id="å®‰è£…openpyxl">å®‰è£…openpyxl</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install openpyxl -i https://pypi.douban.com/simple/</span><br></pre></td></tr></table></figure>
<h2 id="åŸºæœ¬æ“ä½œ">åŸºæœ¬æ“ä½œ</h2>
<h3 id="æ–°å»ºworkbook">æ–°å»ºworkbook</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line">wb = Workbook()</span><br></pre></td></tr></table></figure>
<h3 id="åŠ è½½å·²ç»å­˜åœ¨çš„å·¥ä½œç°¿">åŠ è½½å·²ç»å­˜åœ¨çš„å·¥ä½œç°¿</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook</span><br><span class="line">wb = load_workbook(<span class="string">'File Name'</span>)</span><br></pre></td></tr></table></figure>
<h3 id="é€‰æ‹©sheet">é€‰æ‹©sheet</h3>
<p>é»˜è®¤Workbookåˆ›å»ºæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªsheetï¼Œé€šè¿‡<code>ws = wb.active</code> é€‰æ‹©å¹¶ä½¿ç”¨å®ƒ</p>
<p>å­˜åœ¨å¤šä¸ªsheetæ—¶ï¼Œå¯ä»¥é€šè¿‡<code>ws = wb[Sheet Name]</code> é€‰æ‹©æ‰€æœ‰æ“ä½œçš„sheetï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹æ“ä½œé€‰æ‹©</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰æ‰€æœ‰sheetname</span></span><br><span class="line">sheetlist = wb.sheetnames</span><br><span class="line"><span class="comment"># &gt;&gt; ['1st Sheet', 'æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic', 'æ ‡ç­¾å†…å®¹ä¿¡æ¯ -Standard', 'Readme', 'Add your sheets and content...']</span></span><br><span class="line">ws = wb[sheetlist[<span class="number">2</span>]] <span class="comment"># æˆ–è€…</span></span><br><span class="line">ws.active = <span class="number">2</span></span><br><span class="line">ws = wb.active</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰sheetåå­—</span></span><br><span class="line">ws.title</span><br><span class="line">&gt;&gt; æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic</span><br></pre></td></tr></table></figure>
<p><code>ws = wb[Sheet Name]</code> æ–¹æ³•æ²¡æœ‰æ”¹å˜å½“å‰æ´»è·ƒçš„è¡¨æ ¼å</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">wb.active</span><br><span class="line">&gt;&gt; &lt;Worksheet <span class="string">"æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic"</span>&gt;</span><br><span class="line">ws = wb[<span class="string">'æ ‡ç­¾å†…å®¹ä¿¡æ¯ -Standard'</span>]</span><br><span class="line">wb.active <span class="comment"># è¿˜æ˜¯è¿æ¥çš„å•å…ƒæ ¼</span></span><br><span class="line">&gt;&gt; &lt;Worksheet <span class="string">"æ ‡ç­¾å†…å®¹ä¿¡æ¯- Basic"</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="æ–°å»ºsheet">æ–°å»ºsheet</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤æ’åœ¨æœ€åä½ç½®</span></span><br><span class="line">ws = wb.create_sheet(<span class="string">'Sheet Name'</span>)</span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥åœ¨sheet nameå‚æ•°åå¢åŠ ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºåˆ›å»ºä½ç½®</span></span><br><span class="line">ws = wb.create_sheet(<span class="string">'Sheet Name'</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®æ”¹sheet-tittle">ä¿®æ”¹sheet tittle</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ws.title = New Title</span><br></pre></td></tr></table></figure>
<h3 id="å†™å…¥å•å…ƒæ ¼">å†™å…¥å•å…ƒæ ¼</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ws[<span class="string">'A1'</span>] = <span class="string">'Name'</span></span><br><span class="line">ws[<span class="string">'B1'</span>] = <span class="string">'Age'</span></span><br><span class="line">ws[<span class="string">'C1'</span>] = <span class="string">'score'</span></span><br><span class="line">ws[<span class="string">'A2'</span>] = <span class="string">'å¼ ä¸‰'</span></span><br><span class="line">ws[<span class="string">'B2'</span>] = <span class="number">18</span></span><br><span class="line">ws[<span class="string">'C3'</span>] = <span class="number">95</span></span><br></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹å•å…ƒæ ¼å†…å®¹">æŸ¥çœ‹å•å…ƒæ ¼å†…å®¹</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ws[<span class="string">'A2'</span>].value</span><br><span class="line">&gt;&gt; <span class="string">'å¼ ä¸‰'</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¿å­˜æ–‡ä»¶-å·¥ä½œç°¿">ä¿å­˜æ–‡ä»¶/å·¥ä½œç°¿</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœfilenameå·²ç»å­˜åœ¨ï¼Œä¼šæ²¡æœ‰ç¡®è®¤çš„ä¿®æ”¹è¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line">wb.save(filename)</span><br></pre></td></tr></table></figure>
<h3 id="å…³é—­å·¥ä½œç°¿">å…³é—­å·¥ä½œç°¿</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯èƒ½æ²¡æœ‰ç”¨ï¼Ÿ</span></span><br><span class="line">wb.close()</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://openpyxl.readthedocs.io/en/stable/tutorial.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a></p>
<p>[2] <a href="https://stackoverflow.com/questions/41556378/openpyxl-set-active-sheet/50117733" target="_blank" rel="noopener">é€‰æ‹©sheet</a></p>
<p>[3] <a href="https://realpython.com/openpyxl-excel-spreadsheets-python/" target="_blank" rel="noopener">realpython openpyxl guide</a></p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>excel</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptæ·±åº¦æ‹·è´</title>
    <url>/posts/b60b/</url>
    <content><![CDATA[]]></content>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>nvmç”¨æ³•</title>
    <url>/posts/688d/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>mongo</title>
    <url>/posts/1cbb/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>python thread result</title>
    <url>/posts/5f19/</url>
    <content><![CDATA[]]></content>
      <tags>
        <tag>python</tag>
        <tag>thread</tag>
      </tags>
  </entry>
  <entry>
    <title>sentryåˆè¯•ç‰›åˆ€</title>
    <url>/posts/a9f1/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>è¿ç»´</category>
      </categories>
      <tags>
        <tag>sentry</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonå¤šçº¿ç¨‹</title>
    <url>/posts/76d7/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>rancherandgithub</title>
    <url>/posts/a8ad/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>pythonè¿›é˜¶--é­”æ³•å‡½æ•°</title>
    <url>/posts/4e20/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>traefik</title>
    <url>/posts/7112/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>rancheréƒ¨ç½²</title>
    <url>/posts/ee95/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>pythoné€’å½’åˆ›å»ºç›®å½•(mkdir -p)</title>
    <url>/posts/7376/</url>
    <content><![CDATA[<p>åœ¨ä¸ºæ—¥å¿—æ–‡ä»¶è®¾ç½®å­˜æ”¾ä½ç½®æ—¶ï¼Œéœ€è¦åœ¨ç¨‹åºé‡Œåˆ¤æ–­æ–‡ä»¶å¤¹ï¼ˆä½ç½®ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œé€šå¸¸ä½¿ç”¨<code>os.mkdir</code>æ¥åˆ›å»ºç›®å½•ï¼Œä½†æ˜¯å¦‚æœç›®å½•ä¸ºå¤šå±‚æ¬¡ç›®å½•ï¼Œè€Œä¸”æŸä¸€å±‚ç›®å½•å­˜åœ¨ï¼Œåœ¨ä½¿ç”¨<code>os.mkdir</code>æ—¶ä¼šæŠ¥é”™ï¼šFileNotFoundError*</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.mkdir(<span class="string">'/tmp/logpath/path'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">FileNotFoundError: [Errno <span class="number">2</span>] No such file <span class="keyword">or</span> directory: <span class="string">'/tmp/logpath/path'</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸ºos.mkdirä¸æ”¯æŒå¤šå±‚ç›®å½•é€’å½’åˆ›å»ºã€‚</p>
<p>åœ¨linux mkdirå‘½ä»¤ä¸­ï¼Œå®ƒæ”¯æŒå¦‚ä¸‹æ“ä½œï¼Œä½¿ç”¨-p å¯ä»¥å®ç°é€’å½’åˆ›å»ºç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tldr mkdir</span><br><span class="line">Cache is out of date. You should run <span class="string">"tldr --update"</span></span><br><span class="line"></span><br><span class="line">  mkdir</span><br><span class="line"></span><br><span class="line">  Creates a directory.</span><br><span class="line">  More information: https://www.gnu.org/software/coreutils/mkdir.</span><br><span class="line"></span><br><span class="line">  - Create a directory <span class="keyword">in</span> current directory or given path:</span><br><span class="line">    mkdir directory</span><br><span class="line"></span><br><span class="line">  - Create directories recursively (useful <span class="keyword">for</span> creating nested <span class="built_in">dirs</span>):</span><br><span class="line">    mkdir -p path/to/directory</span><br></pre></td></tr></table></figure>
<p>è€Œåœ¨pythonä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pathlib.Path.mkdiræ¥å®ç°ï¼Œéœ€è¦è®©<code>exist_ok=True</code> ä»¥åŠ<code>parents=True</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">Path.mkdir(mode=<span class="number">0o777</span>, parents=<span class="literal">False</span>, exist_ok=<span class="literal">False</span>)</span><br><span class="line">If exist_ok <span class="keyword">is</span> true, FileExistsError exceptions will be ignored (same behavior <span class="keyword">as</span> the POSIX mkdir -p command), but only <span class="keyword">if</span> the last path component <span class="keyword">is</span> <span class="keyword">not</span> an existing non-directory file.</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>Path(<span class="string">'/tmp/logtmp/XMKDRL'</span>).mkdir(exist_ok=<span class="literal">True</span>, parents=<span class="literal">True</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.path.exists(<span class="string">'/tmp/logtmp/XMKDRL'</span>)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] [mkdir-p-functionality-in-python](<a href="https://stackoverflow.com/questions/600268/mkdir-p-functionality-in-python" target="_blank" rel="noopener">mkdir -p functionality in Python - Stack Overflow</a>)</p>
<p>[2] [Path.mkdir](<a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path.mkdir" target="_blank" rel="noopener">pathlib â€” Object-oriented filesystem paths â€” Python 3.9.5 documentation</a>)</p>
]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>python</tag>
        <tag>pythonå°æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨crontabå®šæœŸåŒæ­¥NTPæ—¶é—´</title>
    <url>/posts/c57a/</url>
    <content><![CDATA[<p>è´­ä¹°çš„é˜¿é‡Œäº‘é¦™æ¸¯è™šæœºï¼Œä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œè¿‡ä¸€æ®µæ—¶é—´ï¼Œå®ƒçš„æ—¶é—´å°±è·Ÿå®é™…æ—¶é—´åç¦»è¶Šæ¥è¶Šè¿œï¼Œå¯¼è‡´HTTPSæ— æ³•æ­£å¸¸å·¥ä½œï¼Œ</p>
<p>æœ€å¼€å§‹æ˜¯æ‰‹åŠ¨çš„ç™»å½•çš„æœåŠ¡å™¨ï¼Œä½¿ç”¨<code>rdate -s time.nist.gov</code>è¿›è¡Œæ‰‹åŠ¨æ›´æ–°æ—¶é—´ï¼Œä½†åæ¥å‘ç°è‡ªå·±è¶Šæ¥è¶Šæ‡’ï¼Œè€Œä¸”æœ€è¿‘è¿™ä¸ªå‘½ä»¤ä¸€ç›´å‡ºé”™: <code>rdate: Could not read data: Cannot assign requested address</code>, å¯èƒ½æ˜¯åé¢çš„æ—¶é—´åŒæ­¥æœåŠ¡å™¨æŒ‚äº†ã€‚</p>
<p>å› æ­¤æ”¹ä¸ºä½¿ç”¨<code>ntpdate</code>æ¥åŒæ­¥æ—¶é—´ï¼Œ<a href="http://xn--ntpntp-9g8in7dm0mk7jex1c6m9akydt74je7n.cloud.aliyuncs.com" target="_blank" rel="noopener">ä½¿ç”¨é˜¿é‡Œäº‘çš„ntpæœåŠ¡å™¨ntp.cloud.aliyuncs.com</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ntpdate ntp.cloud.aliyuncs.com</span><br><span class="line">23 May 14:43:07 ntpdate[9801]: step time server 100.100.61.88 offset 3.848040 sec</span><br></pre></td></tr></table></figure>
<p>ç„¶åå°†æ”¹åäº†åŠ å…¥crontabä»»åŠ¡ä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crontab -e</span><br><span class="line"><span class="comment"># å°†ä¸‹é¢å‘½ä»¤æ·»åŠ åˆ°æœ€å</span></span><br><span class="line">* * * * * ntpdate ntp.cloud.aliyuncs.com</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜é€€å‡ºï¼Œä½†æ˜¯å®é™…è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œå‘ç°æœåŠ¡çš„å®é™…è¿˜æ˜¯è·ç¦»çœŸå®æ—¶é—´è¶Šæ¥è¶Šè¿œï¼Œæ„Ÿè§‰æ˜¯ntpdateå‘½ä»¤æ²¡æœ‰å·¥ä½œï¼Œäºæ˜¯å°†å®šæ—¶ä»»åŠ¡æ”¹ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">* * * * * ntpdate ntp.cloud.aliyuncs.com &gt;&gt; /var/<span class="built_in">log</span>/myntp.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜è¿è¡Œé€€å‡ºåï¼ŒæŸ¥çœ‹ntpdateè¿è¡Œæ—¥å¿—ï¼Œæœç„¶å­˜åœ¨é—®é¢˜<code>/bin/sh: 1: ntpdate: not found</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tail -f myntp.log</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: ntpdate: not found</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: ntpdate: not found</span><br><span class="line">&#x2F;bin&#x2F;sh: 1: ntpdate: not found</span><br></pre></td></tr></table></figure>
<p>cronåœ¨è¿è¡Œæ—¶ï¼Œæ‰¾ä¸åˆ°ntpdateå‘½ä»¤ï¼Œç»§ç»­æ’æŸ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># which ntpdate</span></span><br><span class="line">/usr/sbin/ntpdate</span><br></pre></td></tr></table></figure>
<p>åœ¨crontabä»»åŠ¡ä¸­å¢åŠ ä¸€è¡Œ<code>* * * * * env &gt;&gt; /var/log/env.log 2&gt;&amp;1</code></p>
<p>å¹¶æŸ¥çœ‹æ—¥å¿—</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tail -f env.log</span></span><br><span class="line">PATH=/usr/bin:/bin</span><br><span class="line">LANG=en_US.UTF-8</span><br><span class="line">SHELL=/bin/sh</span><br><span class="line">PWD=/root</span><br></pre></td></tr></table></figure>
<p>ç»ˆäºå‘ç°é—®é¢˜äº†ï¼Œcrontabè¿è¡Œæ—¶æŸ¥æ‰¾å‘½ä»¤çš„è·¯å¾„ä¸º<code>/usr/bin</code> å’Œ<code>/bin</code>ç›®å½•ï¼Œè€Œä¸åŒ…å«<code>/usr/sbin/</code></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨crontabä¸­å¢åŠ <code>PATH=$PATH:/usr/sbin/</code>,ä¹Ÿå¯ä»¥ä½¿ç”¨ntpdateçš„ç»å¯¹è·¯å¾„ï¼Œå°†ä¹‹å‰ntpdateä»»åŠ¡æ”¹ä¸ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* * * * * &#x2F;usr&#x2F;sbin&#x2F;ntpdate ntp.cloud.aliyuncs.com</span><br></pre></td></tr></table></figure>
<p>ä¿å­˜é€€å‡ºåï¼Œè§‚å¯ŸæœåŠ¡å™¨æ—¶é—´ï¼Œå‘ç°å·²ç»å˜ä¸ºæ­£å¸¸æ—¶é—´äº†ã€‚</p>
<h2 id="crontabè®¾ç½®">crontabè®¾ç½®</h2>
<p>æœ€å‰é¢5æ®µç”¨äºè®¾ç½®å‘¨æœŸæ—¶é—´</p>
<p><img src="https://oss.smart-lifestyle.cn/file/rdivm.png" alt="image-20210521150550791"></p>
<p>è¿™é‡Œä¸¾ä¸€äº›å¸¸ç”¨çš„ä¾‹å­ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ª<a href="https://crontab.guru/" target="_blank" rel="noopener">ç½‘ç«™</a>è¿›è¡Œæµ‹è¯•</p>
<ul>
<li>
<p>æ¯ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</p>
<p><code>* * * * *</code></p>
<p><img src="https://oss.smart-lifestyle.cn/file/sgflk.png" alt="image-20210521145726370"></p>
</li>
<li>
<p>æ¯éš”ååˆ†é’Ÿè¿è¡Œä¸€æ¬¡(ğŸ“¢è¿™é‡Œçš„æ¯ä¸ª10åˆ†é’Ÿï¼Œä¸æ˜¯ä»ç°åœ¨æˆ–è€…ä»»åŠ¡å¼€å§‹ç®—èµ·ï¼Œè€Œæ˜¯æ¯å°æ—¶çš„ç¬¬ååˆ†é’Ÿï¼Œ10ï¼Œ20ï¼Œ 30â€¦)</p>
<p><code>*/10 * * * *</code></p>
<p><img src="https://oss.smart-lifestyle.cn/file/qpet2.png" alt="image-20210521145941538"></p>
</li>
<li>
<p>æ¯å¤©æ™šä¸Š23ï¼š55æ‰§è¡Œä¸€æ¬¡</p>
<p><code>55 23 * * *</code></p>
<p><img src="https://oss.smart-lifestyle.cn/file/udg1l.png" alt="image-20210521150051826"></p>
</li>
<li>
<p>æ¯éš”ä¸¤ä¸ªæœˆçš„ç¬¬ä¸€å¤©æ™šä¸Š23ï¼š55æ‰§è¡Œä¸€æ¬¡ï¼ˆæ¯”å¦‚ç”¨äºsslè¯ä¹¦çš„æ›´æ–°ï¼‰</p>
<p><code>55 23 1 */2 *</code></p>
<p><img src="https://oss.smart-lifestyle.cn/file/w278h.png" alt="image-20210521150255631"></p>
</li>
<li>
<p>æ¯å‘¨äº”æ™šä¸Š23ï¼š55å‘é€æŠ¥è¡¨</p>
<p><code>55 23 * * 5</code></p>
<p><img src="https://oss.smart-lifestyle.cn/file/xlh36.png" alt="image-20210521150430138"></p>
</li>
</ul>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] <a href="https://crontab.guru/#*_*_*_*_*" target="_blank" rel="noopener">crontab tool</a></p>
<p>[2] <a href="https://stackoverflow.com/questions/4811738/how-to-log-cron-jobs" target="_blank" rel="noopener">log cron jobs</a></p>
<p>[3] <a href="https://www.cnblogs.com/centos2017/p/12963610.html" target="_blank" rel="noopener">ntpdate: command not found</a></p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>crontab</tag>
      </tags>
  </entry>
  <entry>
    <title>dockerè¿è¡Œlinuxç»ˆç«¯æ˜¾ç¤ºbash-4.2#</title>
    <url>/posts/f29/</url>
    <content><![CDATA[<p>ä¸€æ¬¡åœ¨dockerä¸­è¿è¡Œcentosï¼Œä¸ºäº†çœäº‹ï¼Œå°†æ•°æ®å·æŒ‚è½½äº†æ•´ä¸ªç”¨æˆ·å·¥ä½œç›®å½•ä¸‹ï¼Œæ‰§è¡Œ<code>docker run -it -v /Users/simple/workspace/tmp/data:/root python36:centos7 bash</code></p>
<p><img src="https://oss.smart-lifestyle.cn/file/k5nrn.png" alt="image-20210523154159576"></p>
<p>ç†è®ºä¸Šåº”è¯¥æŒ‰å¦‚ä¸‹æ˜¾ç¤ºï¼š</p>
<p><img src="https://oss.smart-lifestyle.cn/file/0vks3.png" alt="image-20210523155114587"></p>
<p>å‘ç°æ­¤æ—¶ç»ˆç«¯æ˜¾ç¤ºçš„bash-4.2ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºç”¨æˆ·å@ä¸»æœºï¼Œå¦å¤–ç»ˆç«¯æ–‡ä»¶å¤¹æ–‡ä»¶çš„é¢œè‰²ä¹Ÿæ²¡æœ‰æ˜¾ç¤ºï¼Œæœ€å¼€å§‹ä»¥ä¸ºæ²¡æœ‰è®¾ç½®termé¢œè‰²ï¼Œä½†ç»è¿‡å°è¯•ä¸æ˜¯è¿™ä¸ªé—®é¢˜ï¼ˆ<code>TERM=xterm-256color</code>ï¼‰ã€‚</p>
<p>çœ‹åˆ°è‡ªå·±è¿è¡Œçš„dockerå‘½ä»¤ï¼Œ-vå°†dataç›®å½•æŒ‚è½½äº†ç”¨æˆ·ç›®å½•ä¸‹ï¼Œè¿™æ—¶å€™æƒ³èµ·é‡Œå•Šï¼Œdocker volumeç¬¬ä¸€æ¬¡æŒ‚è½½æ˜¯å•é¡¹çš„ï¼Œå³åŠæ—¶å®¹å™¨å†…ç›®å½•æœ‰å†…å®¹ï¼Œç¬¬ä¸€æ¬¡æŒ‚è½½æ—¶ï¼Œä¹Ÿä¼šè¢«ä¸»æœºç›®å½•è¦†ç›–æ‰ï¼Œä¹Ÿå°±æ˜¯ç°åœ¨ä¸»æœºdataç›®å½•æ˜¯ç©ºçš„ï¼Œä¼šæŠŠdockerå†…ç”¨æˆ·ç›®å½•å†…æ–‡ä»¶å…¨éƒ¨æ¸…ç©º</p>
<p>â€‹	è¿›è¡ŒæŒ‚è½½åï¼š</p>
<p><img src="https://oss.smart-lifestyle.cn/file/io22a.png" alt="image-20210523154824106"></p>
<p>â€‹	æŒ‚è½½å‰ï¼š</p>
<p><img src="https://oss.smart-lifestyle.cn/file/gq6l8.png" alt="image-20210523155224464"></p>
<p>åœ¨ç”¨æˆ·ç›®å½•ä¸‹ï¼Œå­˜æ”¾ç€bashä»¥åŠç”¨æˆ·çš„å„ç§é…ç½®æ–‡ä»¶ï¼Œè€Œè¿›è¡ŒæŒ‚è½½åï¼Œå°†æ‰€æœ‰é…ç½®æ–‡ä»¶å…¨éƒ¨æ¸…é™¤äº†ã€‚</p>
<p>æ­£ç¡®åšæ³•ï¼Œä¸è¦ç›´æ¥æŒ‚è½½åˆ°ç”¨æˆ·ç›®å½•ä¸‹ï¼Œè€Œåº”è¯¥æŒ‚è½½ç”¨æˆ·ç›®å½•ä¸‹çš„äºŒçº§ç›®å½•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">volume="/Users/simple/workspace/function_graph/data"</span><br><span class="line">docker run -it --rm --init  --name centos -v $volume:/root/data -w /root python36:centos7 bash</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p>[1] (<a href="https://blog.csdn.net/liulihui1988/article/details/52796395" target="_blank" rel="noopener">linux å‘½ä»¤ç»ˆç«¯æç¤ºç¬¦æ˜¾ç¤º-bash-4.2#è§£å†³æ–¹æ³•__kairuiçš„åšå®¢-CSDNåšå®¢_-bash-4.2#</a>)</p>
]]></content>
      <tags>
        <tag>docker</tag>
        <tag>linux</tag>
      </tags>
  </entry>
</search>
